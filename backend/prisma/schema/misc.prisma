model ExcludedModel {
  id          String    @id @default(cuid())
  modelName   String
  keyId       String?
  companyId   String?
  reason      String
  excludedAt  DateTime  @default(now())
  retryAt     DateTime
  retryCount  Int       @default(0)
  lastRetryAt DateTime?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  @@index([companyId])
  @@index([modelName, keyId])
  @@index([retryAt])
  @@map("excluded_models")
}

model Inventory {
  id              String    @id @default(cuid())
  productId       String
  warehouseId     String
  quantity        Int       @default(0)
  reserved        Int       @default(0)
  available       Int       @default(0)
  minStock        Int       @default(0)
  maxStock        Int?
  reorderPoint    Int       @default(0)
  reorderQuantity Int       @default(0)
  cost            Decimal?  @db.Decimal(10, 2)
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
  batchNumber     String?
  expiryDate      DateTime?
  product        Product   @relation(fields: [productId], references: [id], onDelete: Cascade)
  warehouse       Warehouse @relation(fields: [warehouseId], references: [id], onDelete: Cascade)

  @@unique([productId, warehouseId, batchNumber])
  @@index([productId])
  @@index([warehouseId])
  @@map("inventory")
}

/// UNUSED - Legacy feature
model KnowledgeBase {
  id        String   @id @default(cuid())
  title     String
  content   String
  category  String
  tags      String?
  isActive  Boolean  @default(true)
  priority  Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([category])
  @@index([isActive])
  @@map("knowledge_base")
}

model Notification {
  id        String    @id @default(cuid())
  title     String
  message   String
  type      String
  data      Json?
  isRead    Boolean   @default(false)
  readAt    DateTime?
  createdAt DateTime  @default(now())

  userId    String?
  companyId String

  user    User?   @relation(fields: [userId], references: [id])
  company Company @relation(fields: [companyId], references: [id])

  @@index([companyId])
  @@index([userId])
  @@map("notifications")
}

/// UNUSED - Legacy feature
model PostTracking {
  id           String   @id @default(cuid())
  postId       String
  companyId    String
  visitCount   Int      @default(1)
  firstVisitAt DateTime @default(now())
  lastVisitAt  DateTime @default(now())
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  company    Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([postId, companyId])
  @@index([companyId])
  @@index([lastVisitAt])
  @@index([postId])
  @@map("post_tracking")
}

/// UNUSED - Legacy feature
model RecentlyViewed {
  id        String   @id @default(cuid())
  sessionId String
  productId String
  companyId String
  viewedAt  DateTime @default(now())
  company Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)
  product  Product  @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@unique([sessionId, productId, companyId])
  @@index([companyId])
  @@index([productId])
  @@index([sessionId, companyId])
  @@index([viewedAt])
  @@map("recently_viewed")
}

model ResponseEffectiveness {
  id                 String   @id @default(cuid())
  companyId          String
  messageId          String?
  conversationId     String
  responseText       String   @db.Text
  responseType       String
  customerReaction   String?
  effectivenessScore Float
  leadToPurchase     Boolean  @default(false)
  responseTime       Int?
  wordCount          Int?
  sentimentScore     Float?
  keywords           String?  @db.Text
  metadata           String?  @db.Text
  createdAt          DateTime @default(now())
  company          Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([conversationId])
  @@index([createdAt])
  @@index([effectivenessScore])
  @@index([leadToPurchase])
  @@index([responseType])
  @@map("response_effectiveness")
}

/// UNUSED - Legacy feature
model SkippedFacebookPage {
  id                   String    @id @default(cuid())
  pageId               String
  pageName             String
  reason               String
  attemptedCompanyId   String
  connectedToCompanyId String?
  isResolved           Boolean   @default(false)
  resolvedAt           DateTime?
  createdAt            DateTime  @default(now())
  updatedAt            DateTime @updatedAt

  @@index([attemptedCompanyId])
  @@index([createdAt])
  @@index([isResolved])
  @@map("skipped_facebook_pages")
}

/// UNUSED - Legacy feature
model WalletNumber {
  id              String           @id @default(cuid())
  name            String
  number          String
  isActive        Boolean          @default(true)
  icon            String
  color           String
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt
  paymentReceipts PaymentReceipt[]

  @@map("wallet_numbers")
}

model Faq {
  id                   String    @id @default(cuid())
  companyId            String
  question             String    @db.Text
  answer               String    @db.Text
  category             String    @default("general")
  tags                 String?   @db.Text
  order                Int       @default(0)
  helpful              Int       @default(0)
  notHelpful           Int       @default(0)
  isActive             Boolean   @default(true)
  version              Int       @default(1)
  createdAt            DateTime  @default(now())
  updatedAt            DateTime @updatedAt
  embedding            String?   @db.Text
  embeddingGeneratedAt DateTime?
  company            Company   @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([category])
  @@index([companyId])
  @@index([companyId, isActive])
  @@index([isActive])
  @@map("faqs")
}

model RagPerformance {
  id            String   @id @default(cuid())
  companyId     String
  operation     String
  responseTime  Int
  tokensUsed    Int?
  cacheHit      Boolean  @default(false)
  errorOccurred Boolean  @default(false)
  errorMessage  String?  @db.Text
  metadata      String?  @db.Text
  createdAt     DateTime @default(now())

  @@index([companyId, createdAt])
  @@index([companyId])
  @@index([errorOccurred])
  @@index([operation])
  @@map("rag_performance")
}

model RagRateLimit {
  id           String   @id @default(cuid())
  companyId    String
  ipAddress    String?
  requestType  String   @default("search")
  requestCount Int      @default(1)
  windowStart  DateTime @default(now())
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@unique([companyId, ipAddress, windowStart])
  @@index([companyId])
  @@index([ipAddress])
  @@index([windowStart])
  @@map("rag_rate_limits")
}

model WalletTransaction {
  id            String                @id @default(cuid())
  walletId      String
  type          WalletTransactionType
  amount        Float
  balanceBefore Float
  balanceAfter  Float
  orderId       String?
  description   String
  metadata      String?               @db.Text
  createdAt     DateTime              @default(now())

  wallet CustomerWallet @relation(fields: [walletId], references: [id], onDelete: Cascade)
  order  Order?         @relation(fields: [orderId], references: [id], onDelete: SetNull)

  @@index([walletId])
  @@index([type])
  @@index([createdAt])
  @@map("wallet_transactions")
}

/// UNUSED - Planned feature for appointment scheduling
model Appointment {
  id              String   @id @default(cuid())
  companyId       String
  customerId      String?
  customerName    String
  customerEmail   String?
  customerPhone   String?
  staffId         String
  staffName       String
  title           String
  description     String?  @db.Text
  appointmentDate DateTime @db.Date
  startTime       String // Format: "HH:mm"
  endTime         String? // Format: "HH:mm"
  duration        Int      @default(30) // in minutes
  status          String   @default("pending") // pending, confirmed, completed, cancelled, no_show
  type            String   @default("consultation") // consultation, training, meeting, demo
  location        String?
  meetingLink     String?  @db.Text
  notes           String?  @db.Text
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  company  Company   @relation(fields: [companyId], references: [id], onDelete: Cascade)
  customer Customer? @relation(fields: [customerId], references: [id], onDelete: SetNull)

  @@index([companyId])
  @@index([customerId])
  @@index([staffId])
  @@index([appointmentDate])
  @@index([status])
  @@map("appointments")
}

/// UNUSED - Planned feature for employee notifications
model EmployeeNotificationPreference {
  id                 String   @id @default(cuid())
  companyId          String
  employeeId         String
  phone              String
  attendanceReminder Boolean  @default(true)
  leaveUpdates       Boolean  @default(true)
  payrollNotice      Boolean  @default(true)
  birthdayWish       Boolean  @default(true)
  announcements      Boolean  @default(true)
  isOptedIn          Boolean  @default(true)
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt
  company          Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, employeeId])
  @@unique([companyId, phone])
  @@map("employee_notification_preferences")
}

model StoreVisit {
  id          String   @id @default(cuid())
  companyId   String
  sessionId   String
  ipAddress   String?
  userAgent   String?  @db.Text
  referrer    String?  @db.Text
  landingPage String?  @db.Text
  visitedAt   DateTime @default(now())
  duration    Int?
  pagesViewed Int      @default(1)
  company     Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId, visitedAt])
  @@index([sessionId, companyId])
  @@map("store_visits")
}

/// UNUSED - Planned feature for dev team badges
model DevMemberBadge {
  id        String        @id @default(cuid())
  memberId  String
  badgeCode String
  earnedAt  DateTime      @default(now())
  member    DevTeamMember @relation(fields: [memberId], references: [id], onDelete: Cascade)

  @@index([memberId])
  @@map("dev_member_badges")
}
