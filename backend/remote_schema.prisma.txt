generator client {
  provider      = "prisma-client-js"
  output        = "./generated/mysql"
  binaryTargets = ["native", "debian-openssl-1.1.x", "debian-openssl-3.0.x", "linux-musl", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model AIChatMessage {
  id            String        @id
  sessionId     String
  role          String
  content       String        @db.LongText
  isError       Boolean       @default(false)
  createdAt     DateTime      @default(now())
  AIChatSession AIChatSession @relation(fields: [sessionId], references: [id], onDelete: Cascade)

  @@index([sessionId])
}

model AIChatSession {
  id               String           @id
  userId           String
  title            String?
  isActive         Boolean          @default(true)
  createdAt        DateTime         @default(now())
  updatedAt        DateTime
  AIChatMessage    AIChatMessage[]
  dev_team_members dev_team_members @relation(fields: [userId], references: [id])

  @@index([userId])
}

model Merchant {
  id                String              @id
  companyId         String
  name              String
  email             String              @unique
  phone             String?
  address           String?             @db.Text
  isActive          Boolean             @default(true)
  commissionRate    Float               @default(10)
  autoFulfill       Boolean             @default(false)
  apiKey            String?             @unique
  webhookUrl        String?
  settings          String?             @db.Text
  createdAt         DateTime            @default(now())
  updatedAt         DateTime
  companies         companies           @relation(fields: [companyId], references: [id], onDelete: Cascade)
  commissions       commissions[]
  merchant_orders   merchant_orders[]
  merchant_products merchant_products[]

  @@index([companyId])
  @@index([isActive])
}

model OrderStatusHistory {
  id           String        @id
  orderId      String?
  status       String
  oldStatus    String?
  changedBy    String?
  userName     String?
  reason       String?
  createdAt    DateTime      @default(now())
  guestOrderId String?
  guest_orders guest_orders? @relation(fields: [guestOrderId], references: [id], onDelete: Cascade)
  orders       orders?       @relation(fields: [orderId], references: [id], onDelete: Cascade)

  @@index([guestOrderId])
  @@index([orderId])
}

model Project {
  id          String           @id
  name        String
  description String           @db.Text
  status      Project_status   @default(PLANNING)
  priority    Project_priority @default(MEDIUM)
  startDate   DateTime?
  endDate     DateTime?
  budget      Decimal?         @db.Decimal(10, 2)
  spentBudget Decimal?         @default(0.00) @db.Decimal(10, 2)
  progress    Int              @default(0)
  managerId   String
  teamMembers String?          @db.LongText
  tags        String?          @db.LongText
  companyId   String
  createdAt   DateTime         @default(now())
  updatedAt   DateTime
  companies   companies        @relation(fields: [companyId], references: [id], onDelete: Cascade)
  users       users            @relation(fields: [managerId], references: [id])
  Task        Task[]

  @@index([companyId])
  @@index([managerId])
  @@index([priority])
  @@index([status])
}

model PromptTemplate {
  id          String   @id
  companyId   String
  key         String
  content     String
  description String?
  category    String   @default("general")
  variables   String?
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime

  @@unique([companyId, key])
  @@index([companyId])
}

model SupportAttachment {
  id             String          @id
  filename       String
  originalName   String
  mimeType       String
  size           Int
  url            String
  ticketId       String?
  messageId      String?
  createdAt      DateTime        @default(now())
  SupportMessage SupportMessage? @relation(fields: [messageId], references: [id], onDelete: Cascade)
  SupportTicket  SupportTicket?  @relation(fields: [ticketId], references: [id], onDelete: Cascade)

  @@index([messageId])
  @@index([ticketId])
}

model SupportMessage {
  id                String              @id
  content           String              @db.Text
  isFromAdmin       Boolean             @default(false)
  ticketId          String
  senderId          String
  createdAt         DateTime            @default(now())
  isInternal        Boolean             @default(false)
  SupportAttachment SupportAttachment[]
  users             users               @relation(fields: [senderId], references: [id], onDelete: Cascade)
  SupportTicket     SupportTicket       @relation(fields: [ticketId], references: [id], onDelete: Cascade)

  @@index([senderId])
  @@index([ticketId])
}

model SupportTicket {
  id                                        String                 @id
  ticketId                                  String                 @unique
  subject                                   String
  description                               String                 @db.Text
  category                                  SupportTicket_category @default(INQUIRY)
  status                                    SupportTicket_status   @default(OPEN)
  rating                                    Int?
  feedback                                  String?                @db.Text
  userId                                    String
  companyId                                 String?
  createdAt                                 DateTime               @default(now())
  updatedAt                                 DateTime
  closedAt                                  DateTime?
  assignedUserId                            String?
  priority                                  SupportTicket_priority @default(MEDIUM)
  SupportAttachment                         SupportAttachment[]
  SupportMessage                            SupportMessage[]
  users_SupportTicket_assignedUserIdTousers users?                 @relation("SupportTicket_assignedUserIdTousers", fields: [assignedUserId], references: [id])
  companies                                 companies?             @relation(fields: [companyId], references: [id])
  users_SupportTicket_userIdTousers         users                  @relation("SupportTicket_userIdTousers", fields: [userId], references: [id], onDelete: Cascade)

  @@index([assignedUserId])
  @@index([category])
  @@index([companyId])
  @@index([priority])
  @@index([status])
  @@index([userId])
}

model Task {
  id                                                    String              @id
  projectId                                             String?
  title                                                 String
  description                                           String              @db.Text
  status                                                Task_status         @default(PENDING)
  priority                                              Task_priority       @default(MEDIUM)
  type                                                  String              @default("general")
  assignedTo                                            String
  createdBy                                             String
  dueDate                                               DateTime?
  estimatedHours                                        Int                 @default(0)
  actualHours                                           Int                 @default(0)
  progress                                              Int                 @default(0)
  tags                                                  String?             @db.LongText
  dependencies                                          String?             @db.LongText
  companyId                                             String
  createdAt                                             DateTime            @default(now())
  updatedAt                                             DateTime
  categoryId                                            String?
  color                                                 String?
  completedDate                                         DateTime?
  isRecurring                                           Boolean             @default(false)
  order                                                 Int                 @default(0)
  parentTaskId                                          String?
  recurringRule                                         String?             @db.LongText
  startDate                                             DateTime?
  users_Task_assignedToTousers                          users               @relation("Task_assignedToTousers", fields: [assignedTo], references: [id])
  task_categories                                       task_categories?    @relation(fields: [categoryId], references: [id])
  companies                                             companies           @relation(fields: [companyId], references: [id], onDelete: Cascade)
  users_Task_createdByTousers                           users               @relation("Task_createdByTousers", fields: [createdBy], references: [id])
  Task                                                  Task?               @relation("TaskToTask", fields: [parentTaskId], references: [id])
  other_Task                                            Task[]              @relation("TaskToTask")
  Project                                               Project?            @relation(fields: [projectId], references: [id])
  TimeEntry                                             TimeEntry[]
  task_activities                                       task_activities[]
  task_attachments                                      task_attachments[]
  task_checklists                                       task_checklists[]
  task_comments                                         task_comments[]
  task_dependencies_task_dependencies_dependsOnIdToTask task_dependencies[] @relation("task_dependencies_dependsOnIdToTask")
  task_dependencies_task_dependencies_taskIdToTask      task_dependencies[] @relation("task_dependencies_taskIdToTask")
  task_watchers                                         task_watchers[]

  @@index([assignedTo])
  @@index([categoryId])
  @@index([companyId])
  @@index([createdBy])
  @@index([dueDate])
  @@index([order])
  @@index([parentTaskId])
  @@index([priority])
  @@index([projectId])
  @@index([status])
}

model TimeEntry {
  id          String    @id
  taskId      String
  userId      String
  startTime   DateTime
  endTime     DateTime?
  duration    Int       @default(0)
  description String?   @db.Text
  isBillable  Boolean   @default(false)
  hourlyRate  Decimal?  @db.Decimal(10, 2)
  isRunning   Boolean   @default(false)
  companyId   String
  createdAt   DateTime  @default(now())
  updatedAt   DateTime
  companies   companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  Task        Task      @relation(fields: [taskId], references: [id], onDelete: Cascade)
  users       users     @relation(fields: [userId], references: [id])

  @@index([companyId])
  @@index([startTime])
  @@index([taskId])
  @@index([userId])
}

model activities {
  id          String     @id
  userId      String?
  customerId  String?
  action      String
  description String
  metadata    String?    @db.Text
  ipAddress   String?
  userAgent   String?
  createdAt   DateTime   @default(now())
  customers   customers? @relation(fields: [customerId], references: [id])
  users       users?     @relation(fields: [userId], references: [id])

  @@index([customerId])
  @@index([userId])
}

model activity_logs {
  id           String    @id
  userId       String
  companyId    String
  category     String
  action       String
  description  String    @db.Text
  targetType   String?
  targetId     String?
  targetName   String?
  metadata     String?   @db.Text
  severity     String    @default("LOW")
  isSuccess    Boolean   @default(true)
  errorMessage String?   @db.Text
  tags         String?   @db.Text
  isLocked     Boolean   @default(true)
  createdAt    DateTime  @default(now())
  updatedAt    DateTime
  companies    companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  users        users     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([action])
  @@index([category])
  @@index([companyId, createdAt(sort: Desc)])
  @@index([companyId])
  @@index([createdAt(sort: Desc)])
  @@index([isSuccess])
  @@index([severity])
  @@index([userId, createdAt(sort: Desc)])
  @@index([userId])
}

model affiliate_payouts {
  id                  String                          @id
  affiliateId         String
  amount              Decimal                         @db.Decimal(10, 2)
  currency            String                          @default("EGP")
  status              affiliate_payouts_status        @default(PENDING)
  paymentMethod       affiliate_payouts_paymentMethod
  paymentDetails      String?                         @db.Text
  transactionId       String?
  externalReference   String?
  processedAt         DateTime?
  processedBy         String?
  isExternalPayment   Boolean                         @default(true)
  externalPaymentDate DateTime?
  notes               String?                         @db.Text
  createdAt           DateTime                        @default(now())
  updatedAt           DateTime
  affiliates          affiliates                      @relation(fields: [affiliateId], references: [id], onDelete: Cascade)
  commissions         commissions[]

  @@index([affiliateId])
  @@index([paymentMethod])
  @@index([status])
}

model affiliate_products {
  id          String     @id
  affiliateId String
  productId   String
  basePrice   Decimal    @db.Decimal(10, 2)
  markup      Decimal    @db.Decimal(10, 2)
  finalPrice  Decimal    @db.Decimal(10, 2)
  isActive    Boolean    @default(true)
  createdAt   DateTime   @default(now())
  updatedAt   DateTime
  affiliates  affiliates @relation(fields: [affiliateId], references: [id], onDelete: Cascade)
  products    products   @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@unique([affiliateId, productId])
  @@index([affiliateId])
  @@index([productId])
}

model affiliate_referrals {
  id           String     @id
  affiliateId  String
  customerId   String?
  orderId      String?    @unique
  referralCode String
  referralUrl  String?    @db.Text
  ipAddress    String?
  userAgent    String?
  source       String?
  converted    Boolean    @default(false)
  convertedAt  DateTime?
  createdAt    DateTime   @default(now())
  affiliates   affiliates @relation(fields: [affiliateId], references: [id], onDelete: Cascade)
  customers    customers? @relation(fields: [customerId], references: [id])
  orders       orders?    @relation(fields: [orderId], references: [id])

  @@index([affiliateId])
  @@index([converted])
  @@index([customerId])
  @@index([orderId])
  @@index([referralCode])
}

model affiliate_settings {
  id                  String    @id
  companyId           String    @unique
  commissionType      String    @default("PERCENTAGE")
  commissionRate      Float     @default(5)
  cookieDuration      Int       @default(30)
  termsAndConditions  String?   @db.Text
  isActive            Boolean   @default(true)
  createdAt           DateTime  @default(now())
  updatedAt           DateTime
  platformMarginType  String    @default("FIXED")
  platformMarginValue Float     @default(0)
  companies           companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
}

model affiliates {
  id                       String                    @id
  userId                   String                    @unique
  companyId                String?
  affiliateCode            String                    @unique
  commissionType           affiliates_commissionType @default(PERCENTAGE)
  commissionRate           Float                     @default(5)
  status                   affiliates_status         @default(PENDING)
  totalEarnings            Decimal                   @default(0.00) @db.Decimal(12, 2)
  paidEarnings             Decimal                   @default(0.00) @db.Decimal(12, 2)
  pendingEarnings          Decimal                   @default(0.00) @db.Decimal(12, 2)
  totalSales               Int                       @default(0)
  totalClicks              Int                       @default(0)
  conversionRate           Float                     @default(0)
  paymentMethod            affiliates_paymentMethod?
  paymentDetails           String?                   @db.Text
  minPayout                Decimal                   @default(100.00) @db.Decimal(10, 2)
  canCreateOrdersForOthers Boolean                   @default(true)
  canViewCustomerData      Boolean                   @default(true)
  createdAt                DateTime                  @default(now())
  updatedAt                DateTime
  affiliate_payouts        affiliate_payouts[]
  affiliate_products       affiliate_products[]
  affiliate_referrals      affiliate_referrals[]
  companies                companies?                @relation(fields: [companyId], references: [id], onDelete: Cascade)
  users                    users                     @relation(fields: [userId], references: [id], onDelete: Cascade)
  commissions              commissions[]
  guest_orders             guest_orders[]
  orders                   orders[]

  @@index([affiliateCode])
  @@index([companyId])
  @@index([status])
}

model ai_analytics {
  id                    String   @id
  date                  DateTime @db.Date
  totalMessages         Int      @default(0)
  aiResponses           Int      @default(0)
  humanHandoffs         Int      @default(0)
  avgResponseTime       Float?
  avgConfidence         Float?
  topIntents            String?
  sentimentDistribution String?
  createdAt             DateTime @default(now())

  @@index([date])
}

model ai_failure_logs {
  id             String   @id
  companyId      String
  conversationId String?
  customerId     String?
  errorType      String   @db.VarChar(100)
  errorMessage   String?  @db.Text
  context        String?  @db.LongText
  createdAt      DateTime @default(now())

  @@index([companyId, createdAt])
  @@index([errorType])
}

model ai_interactions {
  id                        String     @id
  companyId                 String
  customerId                String?
  userMessage               String     @db.Text
  aiResponse                String     @db.Text
  intent                    String?
  sentiment                 String?
  confidence                Float?
  requiresHumanIntervention Boolean    @default(false)
  metadata                  String?    @db.Text
  createdAt                 DateTime   @default(now())
  modelUsed                 String?
  responseTime              Int?
  tokensUsed                Int?
  keyId                     String?
  keyName                   String?
  companies                 companies  @relation(fields: [companyId], references: [id], onDelete: Cascade)
  customers                 customers? @relation(fields: [customerId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([customerId])
  @@index([keyName])
  @@index([modelUsed])
}

model ai_keys {
  id                String             @id
  name              String
  provider          ai_keys_provider   @default(GOOGLE)
  apiKey            String             @unique
  baseUrl           String?
  isActive          Boolean            @default(true)
  companyId         String?
  keyType           ai_keys_keyType    @default(CENTRAL)
  usage             String             @db.Text
  currentUsage      Int                @default(0)
  maxRequestsPerDay Int                @default(1500)
  priority          Int                @default(1)
  createdAt         DateTime           @default(now())
  updatedAt         DateTime
  companies         companies?         @relation(fields: [companyId], references: [id], onDelete: Cascade)
  ai_model_configs  ai_model_configs[]

  @@index([companyId])
  @@index([provider, isActive])
}

model ai_model_configs {
  id        String   @id
  keyId     String
  modelName String
  isEnabled Boolean  @default(true)
  priority  Int      @default(1)
  usage     String?  @db.Text
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
  ai_keys   ai_keys  @relation(fields: [keyId], references: [id], onDelete: Cascade)

  @@unique([keyId, modelName])
  @@index([keyId])
}

model ai_model_limits {
  id           String   @id
  modelName    String   @unique
  rpm          Int      @default(15)
  rph          Int      @default(1000)
  rpd          Int      @default(1500)
  tpm          Int      @default(1000000)
  maxTokens    Int      @default(8192)
  isDeprecated Boolean  @default(false)
  createdAt    DateTime @default(now())
  updatedAt    DateTime

  @@index([isDeprecated])
  @@index([modelName])
}

model ai_notifications {
  id        String    @id
  companyId String
  type      String
  severity  String    @default("medium")
  title     String
  message   String    @db.Text
  metadata  String?   @db.Text
  isRead    Boolean   @default(false)
  readAt    DateTime?
  createdAt DateTime  @default(now())
  updatedAt DateTime

  @@index([companyId])
  @@index([createdAt])
  @@index([isRead])
}

model ai_settings {
  id                         String    @id
  companyId                  String    @unique
  promptTemplate             String?   @db.Text
  autoReplyEnabled           Boolean   @default(false)
  confidenceThreshold        Float     @default(0.7)
  escalationRules            String?   @db.Text
  createdAt                  DateTime  @default(now())
  updatedAt                  DateTime
  autoCreateOrders           Boolean   @default(false)
  autoSuggestProducts        Boolean   @default(true)
  defaultProductId           String?
  includeImages              Boolean   @default(true)
  maxSuggestions             Int       @default(3)
  modelSettings              String?   @db.Text
  responsePrompt             String?   @db.Text
  memorySettings             String?   @db.Text
  useAdvancedTools           Boolean   @default(false)
  workingHours               String?   @db.Text
  workingHoursEnabled        Boolean   @default(true)
  maxRepliesPerCustomer      Int       @default(5)
  multimodalEnabled          Boolean   @default(true)
  ragEnabled                 Boolean   @default(true)
  qualityEvaluationEnabled   Boolean   @default(true)
  queueSettings              String?   @db.Text
  aiMaxTokens                Int?      @default(2048)
  aiResponseStyle            String?   @default("balanced")
  aiTemperature              Float?    @default(0.7)
  aiTopK                     Int?      @default(40)
  aiTopP                     Float?    @default(0.9)
  enableDiversityCheck       Boolean   @default(true)
  enableEmotionalResponse    Boolean   @default(true)
  enableLongTermMemory       Boolean   @default(false)
  enableLowQualityAlerts     Boolean   @default(true)
  enableSmartSuggestions     Boolean   @default(false)
  enableToneAdaptation       Boolean   @default(true)
  maxMessagesPerConversation Int?      @default(50)
  memoryRetentionDays        Int?      @default(30)
  minQualityScore            Float?    @default(70)
  replyMode                  String    @default("all")
  autoCleanup                Boolean   @default(true)
  compressionEnabled         Boolean   @default(false)
  maxConversationsPerUser    Int?      @default(100)
  responseRules              String?   @db.Text
  disableDefaultTemplates    Boolean   @default(false)
  enableFailover             Boolean   @default(true)
  useModernAgent             Boolean   @default(false)
  companies                  companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
}

model ai_trace_steps {
  id        String    @id
  traceId   String
  stepType  String
  latencyMs Int
  input     String    @db.Text
  output    String    @db.Text
  metadata  String?   @db.Text
  order     Int
  createdAt DateTime  @default(now())
  ai_traces ai_traces @relation(fields: [traceId], references: [id], onDelete: Cascade)

  @@index([createdAt])
  @@index([traceId])
}

model ai_traces {
  id             String           @id
  companyId      String
  query          String           @db.Text
  timestamp      DateTime         @default(now())
  latencyMs      Int?
  metadata       String?          @db.Text
  createdAt      DateTime         @default(now())
  ai_trace_steps ai_trace_steps[]
  companies      companies        @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([createdAt])
}

model app_bundles {
  id           String   @id
  slug         String   @unique
  name         String
  nameEn       String?
  description  String   @db.Text
  appIds       String   @db.LongText
  monthlyPrice Decimal  @db.Decimal(10, 2)
  yearlyPrice  Decimal? @db.Decimal(10, 2)
  discount     Decimal  @db.Decimal(5, 2)
  isActive     Boolean  @default(true)
  isFeatured   Boolean  @default(false)
  createdAt    DateTime @default(now())
  updatedAt    DateTime

  @@index([isActive])
  @@index([slug])
}

model app_pricing_rules {
  id               String           @id
  appId            String
  name             String
  condition        String           @db.LongText
  action           String           @db.LongText
  priority         Int              @default(0)
  isActive         Boolean          @default(true)
  createdAt        DateTime         @default(now())
  updatedAt        DateTime
  marketplace_apps marketplace_apps @relation(fields: [appId], references: [id], onDelete: Cascade)

  @@index([appId])
}

model app_reviews {
  id               String           @id
  appId            String
  companyId        String
  userId           String
  rating           Int
  title            String?
  comment          String?          @db.Text
  isVerified       Boolean          @default(false)
  isPublished      Boolean          @default(true)
  createdAt        DateTime         @default(now())
  updatedAt        DateTime
  marketplace_apps marketplace_apps @relation(fields: [appId], references: [id], onDelete: Cascade)
  companies        companies        @relation(fields: [companyId], references: [id], onDelete: Cascade)
  users            users            @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([appId, companyId])
  @@index([appId])
  @@index([companyId])
  @@index([userId])
}

model app_usage_logs {
  id           String       @id
  companyAppId String
  feature      String?
  quantity     Int          @default(1)
  totalCost    Decimal      @default(0.00) @db.Decimal(10, 2)
  metadata     String?      @db.LongText
  createdAt    DateTime     @default(now())
  updatedAt    DateTime
  company_apps company_apps @relation(fields: [companyAppId], references: [id], onDelete: Cascade)

  @@index([companyAppId])
  @@index([createdAt])
  @@index([feature])
}

model appointments {
  id              String     @id
  companyId       String
  customerId      String?
  customerName    String
  customerEmail   String?
  customerPhone   String?
  staffId         String
  staffName       String
  title           String
  description     String?    @db.Text
  appointmentDate DateTime   @db.Date
  startTime       String
  endTime         String?
  duration        Int        @default(30)
  status          String     @default("pending")
  type            String     @default("consultation")
  location        String?
  meetingLink     String?    @db.Text
  notes           String?    @db.Text
  createdAt       DateTime   @default(now())
  updatedAt       DateTime
  companies       companies  @relation(fields: [companyId], references: [id], onDelete: Cascade)
  customers       customers? @relation(fields: [customerId], references: [id])

  @@index([appointmentDate])
  @@index([companyId])
  @@index([customerId])
  @@index([staffId])
  @@index([status])
}

model asset_assignments {
  id              String                             @id
  assetId         String
  userId          String
  assignedBy      String?
  assignedAt      DateTime                           @default(now())
  returnedAt      DateTime?
  returnCondition asset_assignments_returnCondition?
  notes           String?                            @db.Text
  assets          assets                             @relation(fields: [assetId], references: [id], onDelete: Cascade)

  @@index([assetId])
  @@index([assignedBy])
  @@index([userId])
}

model asset_attachments {
  id          String   @id
  assetId     String
  type        String
  fileName    String
  fileUrl     String
  fileSize    Int?
  mimeType    String?
  description String?  @db.Text
  uploadedBy  String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime
  assets      assets   @relation(fields: [assetId], references: [id], onDelete: Cascade)

  @@index([assetId])
  @@index([type])
}

model asset_audits {
  id             String                       @id
  companyId      String
  assetId        String?
  auditName      String
  auditDate      DateTime
  status         String                       @default("IN_PROGRESS")
  conductedBy    String
  assetFound     Boolean?
  assetCondition asset_audits_assetCondition?
  discrepancy    String?                      @db.Text
  notes          String?                      @db.Text
  completedAt    DateTime?
  createdAt      DateTime                     @default(now())
  updatedAt      DateTime
  assets         assets?                      @relation(fields: [assetId], references: [id])

  @@index([assetId])
  @@index([companyId])
  @@index([status])
}

model asset_categories {
  id          String    @id
  companyId   String
  name        String
  description String?   @db.Text
  createdAt   DateTime  @default(now())
  updatedAt   DateTime
  companies   companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  assets      assets[]

  @@unique([companyId, name])
  @@index([companyId])
}

model asset_custody_history {
  id              String                                 @id
  assetId         String
  userId          String
  assignedBy      String?
  action          String
  assignedAt      DateTime                               @default(now())
  returnedAt      DateTime?
  returnCondition asset_custody_history_returnCondition?
  notes           String?                                @db.Text
  documentUrl     String?
  signatureUrl    String?
  createdAt       DateTime                               @default(now())
  updatedAt       DateTime
  assets          assets                                 @relation(fields: [assetId], references: [id], onDelete: Cascade)

  @@index([assetId])
  @@index([assignedBy])
  @@index([userId])
}

model asset_maintenance {
  id             String    @id
  assetId        String
  type           String
  description    String    @db.Text
  cost           Decimal?  @db.Decimal(12, 2)
  status         String
  startDate      DateTime
  completionDate DateTime?
  performedBy    String?
  notes          String?   @db.Text
  createdAt      DateTime  @default(now())
  updatedAt      DateTime
  assets         assets    @relation(fields: [assetId], references: [id], onDelete: Cascade)

  @@index([assetId])
}

model asset_requests {
  id              String                @id
  companyId       String
  assetId         String?
  requestedBy     String
  assetType       String
  category        String?
  reason          String                @db.Text
  priority        String                @default("NORMAL")
  status          asset_requests_status @default(PENDING)
  approvedBy      String?
  approvedAt      DateTime?
  rejectedBy      String?
  rejectedAt      DateTime?
  rejectionReason String?               @db.Text
  fulfilledBy     String?
  fulfilledAt     DateTime?
  notes           String?               @db.Text
  createdAt       DateTime              @default(now())
  updatedAt       DateTime
  assets          assets?               @relation(fields: [assetId], references: [id])

  @@index([assetId])
  @@index([companyId])
  @@index([requestedBy])
  @@index([status])
}

model assets {
  id                    String                  @id
  companyId             String
  categoryId            String?
  name                  String
  description           String?                 @db.Text
  code                  String?
  serialNumber          String?
  model                 String?
  brand                 String?
  status                assets_status           @default(AVAILABLE)
  condition             assets_condition        @default(NEW)
  purchaseDate          DateTime?
  purchaseValue         Decimal?                @db.Decimal(12, 2)
  currency              String                  @default("EGP")
  location              String?
  branchId              String?
  image                 String?
  notes                 String?                 @db.Text
  metadata              String?                 @db.Text
  warrantyStartDate     DateTime?
  warrantyEndDate       DateTime?
  warrantyMonths        Int?
  warrantyProvider      String?
  depreciationMethod    String?                 @default("STRAIGHT_LINE")
  usefulLifeYears       Int?                    @default(5)
  salvageValue          Decimal?                @db.Decimal(12, 2)
  currentBookValue      Decimal?                @db.Decimal(12, 2)
  assignedToId          String?
  createdAt             DateTime                @default(now())
  updatedAt             DateTime
  asset_assignments     asset_assignments[]
  asset_attachments     asset_attachments[]
  asset_audits          asset_audits[]
  asset_custody_history asset_custody_history[]
  asset_maintenance     asset_maintenance[]
  asset_requests        asset_requests[]
  asset_categories      asset_categories?       @relation(fields: [categoryId], references: [id])
  companies             companies               @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, code])
  @@index([assignedToId])
  @@index([branchId])
  @@index([categoryId])
  @@index([companyId])
  @@index([status])
}

model back_in_stock_notifications {
  id            String    @id
  productId     String
  companyId     String
  customerName  String
  customerEmail String?
  customerPhone String?
  notifyEmail   Boolean   @default(true)
  notifySMS     Boolean   @default(false)
  isNotified    Boolean   @default(false)
  notifiedAt    DateTime?
  createdAt     DateTime  @default(now())
  companies     companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  products      products  @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([isNotified])
  @@index([productId])
}

model blocked_customers_on_page {
  id             String         @id
  facebookPageId String
  pageId         String
  customerId     String
  facebookId     String
  blockedBy      String?
  reason         String?        @db.Text
  blockedAt      DateTime       @default(now())
  createdAt      DateTime       @default(now())
  updatedAt      DateTime
  metadata       String?        @db.Text
  customers      customers      @relation(fields: [customerId], references: [id], onDelete: Cascade)
  facebook_pages facebook_pages @relation(fields: [facebookPageId], references: [id], onDelete: Cascade)

  @@unique([facebookPageId, customerId])
  @@unique([pageId, facebookId])
  @@index([customerId])
  @@index([facebookId])
  @@index([facebookPageId])
  @@index([pageId])
}

model branches {
  id           String    @id
  name         String
  address      String?
  city         String?
  phone        String
  email        String?
  workingHours String?
  isActive     Boolean   @default(true)
  companyId    String
  createdAt    DateTime  @default(now())
  updatedAt    DateTime
  companies    companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([isActive])
}

model broadcast_campaigns {
  id                   String                 @id
  name                 String
  message              String                 @db.Text
  targetAudience       String
  scheduledAt          DateTime?
  sentAt               DateTime?
  tags                 String?                @db.LongText
  priority             String                 @default("medium")
  includeImages        Boolean                @default(false)
  trackClicks          Boolean                @default(true)
  autoResend           Boolean                @default(false)
  images               String?                @db.LongText
  status               String                 @default("draft")
  recipientCount       Int                    @default(0)
  sentCount            Int                    @default(0)
  deliveredCount       Int                    @default(0)
  openedCount          Int                    @default(0)
  clickedCount         Int                    @default(0)
  failedCount          Int                    @default(0)
  companyId            String
  creatorId            String?
  createdAt            DateTime               @default(now())
  updatedAt            DateTime
  companies            companies              @relation(fields: [companyId], references: [id], onDelete: Cascade)
  broadcast_recipients broadcast_recipients[]

  @@index([companyId])
  @@index([scheduledAt])
  @@index([status])
}

model broadcast_recipients {
  id                  String              @id
  campaignId          String
  conversationId      String
  customerPhone       String
  customerName        String?
  messengerUserId     String?
  status              String              @default("pending")
  sentAt              DateTime?
  deliveredAt         DateTime?
  openedAt            DateTime?
  clickedAt           DateTime?
  repliedAt           DateTime?
  failureReason       String?             @db.Text
  messageId           String?
  createdAt           DateTime            @default(now())
  updatedAt           DateTime
  broadcast_campaigns broadcast_campaigns @relation(fields: [campaignId], references: [id], onDelete: Cascade)
  conversations       conversations       @relation(fields: [conversationId], references: [id], onDelete: Cascade)

  @@index([campaignId])
  @@index([conversationId])
  @@index([status])
}

model broadcast_settings {
  id                           String    @id
  companyId                    String    @unique
  defaultSendTime              String    @default("10:00")
  timezone                     String    @default("Asia/Riyadh")
  maxRecipientsPerCampaign     Int       @default(5000)
  maxCampaignsPerDay           Int       @default(10)
  enableDeliveryReports        Boolean   @default(true)
  enableOpenTracking           Boolean   @default(true)
  enableClickTracking          Boolean   @default(true)
  enableUnsubscribeTracking    Boolean   @default(true)
  notifyOnCampaignSent         Boolean   @default(true)
  notifyOnHighUnsubscribeRate  Boolean   @default(true)
  notifyOnLowDeliveryRate      Boolean   @default(true)
  adminEmail                   String?
  requireApprovalForHighVolume Boolean   @default(false)
  highVolumeThreshold          Int       @default(1000)
  enableContentFiltering       Boolean   @default(false)
  blockedWords                 String?   @db.LongText
  messagesPerMinute            Int       @default(60)
  messagesPerHour              Int       @default(1000)
  messagesPerDay               Int       @default(10000)
  defaultFooter                String?   @db.Text
  unsubscribeText              String    @default("للإلغاء اكتب STOP")
  companyName                  String?
  companyAddress               String?
  createdAt                    DateTime  @default(now())
  updatedAt                    DateTime
  companies                    companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
}

model call_attempt_logs {
  id        String   @id
  orderId   String
  userId    String
  result    String?
  notes     String?
  createdAt DateTime @default(now())
  orders    orders   @relation(fields: [orderId], references: [id], onDelete: Cascade)
  users     users    @relation(fields: [userId], references: [id])

  @@index([orderId])
  @@index([userId])
}

model categories {
  id               String       @id
  name             String
  description      String?      @db.Text
  image            String?
  parentId         String?
  isActive         Boolean      @default(true)
  sortOrder        Int          @default(0)
  companyId        String
  createdAt        DateTime     @default(now())
  updatedAt        DateTime
  displayType      String       @default("default")
  metaDescription  String?      @db.Text
  metaTitle        String?
  slug             String?
  companies        companies    @relation(fields: [companyId], references: [id], onDelete: Cascade)
  categories       categories?  @relation("categoriesTocategories", fields: [parentId], references: [id])
  other_categories categories[] @relation("categoriesTocategories")
  products         products[]

  @@unique([companyId, slug])
  @@index([companyId])
  @@index([parentId])
  @@index([slug])
}

model checkout_form_settings {
  id                     String    @id
  companyId              String    @unique
  showGuestName          Boolean   @default(true)
  requireGuestName       Boolean   @default(true)
  showGuestPhone         Boolean   @default(true)
  requireGuestPhone      Boolean   @default(true)
  showGuestEmail         Boolean   @default(true)
  requireGuestEmail      Boolean   @default(false)
  showCity               Boolean   @default(true)
  requireCity            Boolean   @default(true)
  showShippingAddress    Boolean   @default(true)
  requireShippingAddress Boolean   @default(true)
  showPaymentMethod      Boolean   @default(true)
  showNotes              Boolean   @default(true)
  createdAt              DateTime  @default(now())
  updatedAt              DateTime
  companies              companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
}

model commissions {
  id                String                       @id
  orderId           String
  affiliateId       String?
  merchantId        String?
  type              commissions_type
  calculationType   commissions_calculationType?
  amount            Decimal                      @db.Decimal(10, 2)
  rate              Float?
  markup            Decimal?                     @db.Decimal(10, 2)
  baseAmount        Decimal?                     @db.Decimal(10, 2)
  status            commissions_status           @default(CONFIRMED)
  orderTotal        Decimal                      @db.Decimal(10, 2)
  companyId         String
  paidAt            DateTime?
  payoutId          String?
  notes             String?                      @db.Text
  createdAt         DateTime                     @default(now())
  updatedAt         DateTime
  affiliates        affiliates?                  @relation(fields: [affiliateId], references: [id])
  companies         companies                    @relation(fields: [companyId], references: [id], onDelete: Cascade)
  Merchant          Merchant?                    @relation(fields: [merchantId], references: [id])
  orders            orders                       @relation(fields: [orderId], references: [id], onDelete: Cascade)
  affiliate_payouts affiliate_payouts?           @relation(fields: [payoutId], references: [id])

  @@index([affiliateId])
  @@index([companyId])
  @@index([merchantId])
  @@index([orderId])
  @@index([payoutId])
  @@index([status])
}

model companies {
  id                                String                              @id
  name                              String
  email                             String                              @unique
  phone                             String?
  website                           String?
  logo                              String?
  address                           String?
  currency                          String                              @default("EGP")
  plan                              companies_plan                      @default(BASIC)
  planConfigurationId               String?
  isActive                          Boolean                             @default(true)
  settings                          String?                             @db.Text
  createdAt                         DateTime                            @default(now())
  updatedAt                         DateTime
  slug                              String?                             @unique
  facebookUserAccessToken           String?                             @db.Text
  facebookPixelAccessToken          String?                             @db.Text
  useCentralKeys                    Boolean                             @default(false)
  facebookAdsAccessToken            String?                             @db.Text
  turboApiKey                       String?                             @db.Text
  turboAutoCreate                   Boolean                             @default(false)
  turboEnabled                      Boolean                             @default(false)
  turboWebhookUrl                   String?
  turboMainClientCode               Int?
  turboWebhookToken                 String?                             @db.Text
  turboSenderNumber                 String?
  sidebarLayout                     String                              @default("three-tier")
  customDomain                      String?                             @unique
  timezone                          String                              @default("Asia/Riyadh")
  geofenceEnabled                   Boolean                             @default(false)
  geofenceRadius                    Int?                                @default(200)
  officeLatitude                    Decimal?                            @db.Decimal(10, 8)
  officeLongitude                   Decimal?                            @db.Decimal(11, 8)
  platformCommissionRate            Float?                              @default(5)
  Merchant                          Merchant[]
  Project                           Project[]
  SupportTicket                     SupportTicket[]
  Task                              Task[]
  TimeEntry                         TimeEntry[]
  activity_logs                     activity_logs[]
  affiliate_settings                affiliate_settings?
  affiliates                        affiliates[]
  ai_interactions                   ai_interactions[]
  ai_keys                           ai_keys[]
  ai_settings                       ai_settings?
  ai_traces                         ai_traces[]
  app_reviews                       app_reviews[]
  appointments                      appointments[]
  asset_categories                  asset_categories[]
  assets                            assets[]
  back_in_stock_notifications       back_in_stock_notifications[]
  branches                          branches[]
  broadcast_campaigns               broadcast_campaigns[]
  broadcast_settings                broadcast_settings?
  categories                        categories[]
  checkout_form_settings            checkout_form_settings?
  commissions                       commissions[]
  plan_configurations               plan_configurations?                @relation(fields: [planConfigurationId], references: [id])
  company_apps                      company_apps[]
  company_wallets                   company_wallets?
  conversation_memory               conversation_memory[]
  conversation_outcomes             conversation_outcomes[]
  conversations                     conversations[]
  conversion_events                 conversion_events[]
  coupons                           coupons[]
  customer_lists                    customer_lists[]
  customer_loyalty_programs         customer_loyalty_programs[]
  customer_loyalty_records          customer_loyalty_records[]
  customer_loyalty_tiers            customer_loyalty_tiers[]
  customer_notification_preferences customer_notification_preferences[]
  customer_wallets                  customer_wallets[]
  customers                         customers[]
  daily_analytics                   daily_analytics[]
  delivery_options                  delivery_options[]
  dev_projects                      dev_projects[]
  dev_tasks                         dev_tasks[]
  dev_team_members                  dev_team_members[]
  employee_notification_preferences employee_notification_preferences[]
  facebook_ad_accounts              facebook_ad_accounts[]
  facebook_ad_tests                 facebook_ad_tests[]
  facebook_campaigns                facebook_campaigns[]
  facebook_comments                 facebook_comments[]
  facebook_custom_audiences         facebook_custom_audiences[]
  facebook_dynamic_ads              facebook_dynamic_ads[]
  facebook_lookalike_audiences      facebook_lookalike_audiences[]
  facebook_pages                    facebook_pages[]
  facebook_product_catalogs         facebook_product_catalogs[]
  faqs                              faqs[]
  footer_settings                   footer_settings?
  guest_carts                       guest_carts[]
  guest_orders                      guest_orders[]
  homepage_templates                homepage_templates[]
  hr_advance_requests               hr_advance_requests[]
  hr_attendances                    hr_attendances[]
  hr_audit_logs                     hr_audit_logs[]
  hr_benefit_enrollments            hr_benefit_enrollments[]
  hr_benefits                       hr_benefits[]
  hr_departments                    hr_departments[]
  hr_employee_documents             hr_employee_documents[]
  hr_employee_training              hr_employee_training[]
  hr_employee_warnings              hr_employee_warnings[]
  hr_employees                      hr_employees[]
  hr_feedbacks                      hr_feedbacks[]
  hr_goals                          hr_goals[]
  hr_kudos                          hr_kudos[]
  hr_late_warnings                  hr_late_warnings[]
  hr_lateness_balances              hr_lateness_balances[]
  hr_leave_requests                 hr_leave_requests[]
  hr_manual_deductions              hr_manual_deductions[]
  hr_payrolls                       hr_payrolls[]
  hr_performance_reviews            hr_performance_reviews[]
  hr_positions                      hr_positions[]
  hr_promotions                     hr_promotions[]
  hr_resignations                   hr_resignations[]
  hr_reward_eligibility_logs        hr_reward_eligibility_logs[]
  hr_reward_records                 hr_reward_records[]
  hr_reward_settings                hr_reward_settings?
  hr_reward_types                   hr_reward_types[]
  hr_salary_history                 hr_salary_history[]
  hr_settings                       hr_settings?
  hr_shift_assignments              hr_shift_assignments[]
  hr_shifts                         hr_shifts[]
  image_gallery                     image_gallery[]
  image_studio_history              image_studio_history[]
  image_studio_usage                image_studio_usage[]
  integrations                      integrations[]
  invoices                          invoices[]
  lateness_allowances               lateness_allowances[]
  lateness_deductions               lateness_deductions[]
  lateness_monthly_summaries        lateness_monthly_summaries[]
  lateness_records                  lateness_records[]
  lateness_rules                    lateness_rules?
  learning_data                     learning_data[]
  learning_settings                 learning_settings?
  notifications                     notifications[]
  order_invoice_settings            order_invoice_settings?
  order_status_configs              order_status_configs[]
  orders                            orders[]
  page_response_settings            page_response_settings[]
  payments                          payments[]
  policies                          policies[]
  post_response_settings            post_response_settings[]
  post_tracking                     post_tracking[]
  product_analytics                 product_analytics[]
  product_reviews                   product_reviews[]
  product_visits                    product_visits[]
  products                          products[]
  purchase_invoices                 purchase_invoices[]
  purchase_orders                   purchase_orders[]
  recently_viewed                   recently_viewed[]
  response_effectiveness            response_effectiveness[]
  return_reason_categories          return_reason_categories[]
  return_reasons                    return_reasons[]
  return_requests                   return_requests[]
  return_settings                   return_settings?
  sent_message_stats                sent_message_stats[]
  shipping_zones                    shipping_zones[]
  store_pages                       store_pages[]
  store_promotion_settings          store_promotion_settings?
  store_visits                      store_visits[]
  storefront_settings               storefront_settings?
  subscriptions                     subscriptions[]
  supplier_payments                 supplier_payments[]
  suppliers                         suppliers[]
  system_prompts                    system_prompts[]
  task_activities                   task_activities[]
  task_attachments                  task_attachments[]
  task_categories                   task_categories[]
  task_checklists                   task_checklists[]
  task_comments                     task_comments[]
  task_dependencies                 task_dependencies[]
  task_notifications                task_notifications[]
  task_templates                    task_templates[]
  task_watchers                     task_watchers[]
  telegram_configs                  telegram_configs[]
  text_gallery                      text_gallery[]
  user_companies                    user_companies[]
  user_invitations                  user_invitations[]
  users                             users[]
  warehouses                        warehouses[]
  whatsapp_notification_logs        whatsapp_notification_logs[]
  whatsapp_notification_queue       whatsapp_notification_queue[]
  whatsapp_notification_settings    whatsapp_notification_settings?
  whatsapp_notification_templates   whatsapp_notification_templates[]
  whatsapp_quick_replies            whatsapp_quick_replies[]
  whatsapp_sessions                 whatsapp_sessions[]
  whatsapp_settings                 whatsapp_settings?
  wishlists                         wishlists[]
  woocommerce_settings              woocommerce_settings?
  woocommerce_sync_logs             woocommerce_sync_logs[]

  @@index([planConfigurationId])
}

model company_apps {
  id               String           @id
  companyId        String
  appId            String
  status           String           @default("ACTIVE")
  trialEndsAt      DateTime?
  validUntil       DateTime?
  settings         String?          @db.LongText
  createdAt        DateTime         @default(now())
  updatedAt        DateTime
  nextBillingAt    DateTime?
  app_usage_logs   app_usage_logs[]
  marketplace_apps marketplace_apps @relation(fields: [appId], references: [id], onDelete: Cascade)
  companies        companies        @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, appId])
  @@index([appId], map: "company_apps_appId_fkey")
}

model company_wallets {
  id           String         @id
  companyId    String         @unique
  balance      Decimal        @default(0.00) @db.Decimal(10, 2)
  currency     String         @default("EGP")
  updatedAt    DateTime
  companies    companies      @relation(fields: [companyId], references: [id], onDelete: Cascade)
  transactions transactions[]
}

model conversation_memory {
  id             String    @id
  conversationId String
  senderId       String
  userMessage    String
  aiResponse     String
  intent         String?
  sentiment      String?
  timestamp      DateTime  @default(now())
  metadata       String?
  createdAt      DateTime  @default(now())
  updatedAt      DateTime
  companyId      String
  companies      companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId, conversationId])
  @@index([companyId])
  @@index([companyId, senderId])
  @@index([conversationId])
  @@index([senderId])
  @@index([timestamp])
}

model conversation_outcomes {
  id                   String    @id
  conversationId       String
  customerId           String
  companyId            String
  outcome              String
  outcomeValue         Float?
  responseQuality      Float?
  customerSatisfaction Float?
  conversionTime       Int?
  messageCount         Int?
  aiResponseCount      Int?
  humanHandoff         Boolean   @default(false)
  metadata             String?   @db.Text
  createdAt            DateTime  @default(now())
  updatedAt            DateTime
  companies            companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  customers            customers @relation(fields: [customerId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([conversationId])
  @@index([createdAt])
  @@index([customerId])
  @@index([outcome])
}

model conversations {
  id                        String                 @id
  customerId                String
  assignedUserId            String?
  channel                   conversations_channel
  status                    conversations_status   @default(ACTIVE)
  subject                   String?
  priority                  Int                    @default(1)
  tags                      String?
  lastMessageAt             DateTime?
  lastMessagePreview        String?
  isRead                    Boolean                @default(false)
  metadata                  String?                @db.Text
  companyId                 String
  createdAt                 DateTime               @default(now())
  updatedAt                 DateTime
  aiEnabled                 Boolean                @default(true)
  lastMessageIsFromCustomer Boolean                @default(false)
  unreadCount               Int                    @default(0)
  broadcast_recipients      broadcast_recipients[]
  users                     users?                 @relation(fields: [assignedUserId], references: [id])
  companies                 companies              @relation(fields: [companyId], references: [id], onDelete: Cascade)
  customers                 customers              @relation(fields: [customerId], references: [id], onDelete: Cascade)
  messages                  messages[]
  orders                    orders[]

  @@index([assignedUserId])
  @@index([companyId])
  @@index([companyId, lastMessageAt])
  @@index([companyId, lastMessageIsFromCustomer, status])
  @@index([companyId, status, lastMessageAt])
  @@index([customerId])
  @@index([lastMessageAt])
  @@index([status])
}

model conversion_events {
  id        String    @id
  companyId String
  sessionId String
  eventType String
  productId String?
  orderId   String?
  value     Decimal?  @db.Decimal(10, 2)
  createdAt DateTime  @default(now())
  metadata  String?   @db.Text
  companies companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  orders    orders?   @relation(fields: [orderId], references: [id], onDelete: Cascade)
  products  products? @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@index([companyId, eventType, createdAt])
  @@index([companyId, productId, eventType, createdAt])
  @@index([orderId], map: "conversion_events_orderId_fkey")
  @@index([productId, companyId])
  @@index([sessionId, companyId])
}

model coupon_usages {
  id             String   @id
  couponId       String
  companyId      String
  customerId     String?
  orderId        String?
  discountAmount Decimal  @db.Decimal(10, 2)
  orderAmount    Decimal  @db.Decimal(10, 2)
  usedAt         DateTime @default(now())
  coupons        coupons  @relation(fields: [couponId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([couponId])
  @@index([customerId])
  @@index([orderId])
  @@index([usedAt])
}

model coupons {
  id                String          @id
  companyId         String
  code              String
  name              String
  description       String?         @db.Text
  type              coupons_type    @default(PERCENTAGE)
  value             Decimal         @db.Decimal(10, 2)
  minOrderAmount    Decimal?        @db.Decimal(10, 2)
  maxDiscountAmount Decimal?        @db.Decimal(10, 2)
  usageLimit        Int?
  usageCount        Int             @default(0)
  userUsageLimit    Int?
  validFrom         DateTime
  validTo           DateTime
  isActive          Boolean         @default(true)
  customerSegments  String?         @db.Text
  metadata          String?         @db.Text
  createdBy         String?
  createdAt         DateTime        @default(now())
  updatedAt         DateTime
  coupon_usages     coupon_usages[]
  companies         companies       @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, code])
  @@index([code])
  @@index([companyId])
  @@index([isActive])
  @@index([validFrom, validTo])
}

model customer_lists {
  id          String    @id
  name        String
  description String?   @db.Text
  criteria    String    @db.LongText
  count       Int       @default(0)
  isDefault   Boolean   @default(false)
  companyId   String
  createdAt   DateTime  @default(now())
  updatedAt   DateTime
  companies   companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
}

model customer_loyalty_programs {
  id                       String                           @id
  companyId                String
  name                     String
  nameAr                   String?
  description              String?                          @db.Text
  type                     customer_loyalty_programs_type   @default(POINTS)
  status                   customer_loyalty_programs_status @default(DRAFT)
  pointsPerPurchase        Decimal                          @default(1.00) @db.Decimal(10, 2)
  pointsPerReferral        Decimal                          @default(10.00) @db.Decimal(10, 2)
  pointsPerAmount          Decimal?                         @db.Decimal(10, 2)
  redemptionRate           Decimal                          @default(100.00) @db.Decimal(10, 2)
  minimumPoints            Decimal                          @default(100.00) @db.Decimal(10, 2)
  maxPointsPerTransaction  Decimal?                         @db.Decimal(10, 2)
  expiryMonths             Int                              @default(12)
  rules                    String?                          @db.Text
  createdBy                String
  createdAt                DateTime                         @default(now())
  updatedAt                DateTime
  companies                companies                        @relation(fields: [companyId], references: [id], onDelete: Cascade)
  customer_loyalty_records customer_loyalty_records[]
  customer_loyalty_tiers   customer_loyalty_tiers[]

  @@index([companyId])
  @@index([status])
  @@index([type])
}

model customer_loyalty_records {
  id                        String                          @id
  companyId                 String
  customerId                String
  programId                 String
  tierId                    String?
  currentPoints             Decimal                         @default(0.00) @db.Decimal(10, 2)
  totalEarned               Decimal                         @default(0.00) @db.Decimal(10, 2)
  totalRedeemed             Decimal                         @default(0.00) @db.Decimal(10, 2)
  status                    customer_loyalty_records_status @default(ACTIVE)
  joinDate                  DateTime                        @default(now())
  lastActivity              DateTime                        @default(now())
  lastPointsEarned          DateTime?
  lastPointsRedeemed        DateTime?
  metadata                  String?                         @db.Text
  createdAt                 DateTime                        @default(now())
  updatedAt                 DateTime
  companies                 companies                       @relation(fields: [companyId], references: [id], onDelete: Cascade)
  customers                 customers                       @relation(fields: [customerId], references: [id], onDelete: Cascade)
  customer_loyalty_programs customer_loyalty_programs       @relation(fields: [programId], references: [id], onDelete: Cascade)
  customer_loyalty_tiers    customer_loyalty_tiers?         @relation(fields: [tierId], references: [id])

  @@unique([customerId, programId])
  @@index([companyId])
  @@index([customerId])
  @@index([lastActivity])
  @@index([programId])
  @@index([status])
  @@index([tierId])
}

model customer_loyalty_tiers {
  id                        String                     @id
  companyId                 String
  programId                 String
  name                      String
  nameAr                    String?
  minPoints                 Decimal                    @db.Decimal(10, 2)
  maxPoints                 Decimal?                   @db.Decimal(10, 2)
  benefits                  String?                    @db.Text
  color                     String                     @default("#6366f1")
  icon                      String                     @default("crown")
  priority                  Int                        @default(1)
  createdAt                 DateTime                   @default(now())
  updatedAt                 DateTime
  customer_loyalty_records  customer_loyalty_records[]
  companies                 companies                  @relation(fields: [companyId], references: [id], onDelete: Cascade)
  customer_loyalty_programs customer_loyalty_programs  @relation(fields: [programId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([minPoints])
  @@index([programId])
}

model customer_notes {
  id         String    @id
  customerId String
  authorId   String
  content    String    @db.Text
  createdAt  DateTime  @default(now())
  updatedAt  DateTime
  users      users     @relation(fields: [authorId], references: [id], onDelete: Cascade)
  customers  customers @relation(fields: [customerId], references: [id], onDelete: Cascade)

  @@index([authorId])
  @@index([customerId])
}

model customer_notification_preferences {
  id            String    @id
  companyId     String
  customerId    String    @unique
  phone         String
  orderUpdates  Boolean   @default(true)
  promotions    Boolean   @default(false)
  backInStock   Boolean   @default(true)
  priceDrops    Boolean   @default(true)
  abandonedCart Boolean   @default(true)
  isOptedIn     Boolean   @default(true)
  optedInAt     DateTime  @default(now())
  optedOutAt    DateTime?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime
  companies     companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  customers     customers @relation(fields: [customerId], references: [id], onDelete: Cascade)

  @@unique([companyId, customerId])
  @@unique([companyId, phone])
}

model customer_wallets {
  id                  String                @id
  customerId          String                @unique
  companyId           String
  balance             Float                 @default(0)
  totalEarned         Float                 @default(0)
  totalSpent          Float                 @default(0)
  currency            String                @default("EGP")
  isActive            Boolean               @default(true)
  createdAt           DateTime              @default(now())
  updatedAt           DateTime
  companies           companies             @relation(fields: [companyId], references: [id], onDelete: Cascade)
  customers           customers             @relation(fields: [customerId], references: [id])
  wallet_transactions wallet_transactions[]

  @@index([companyId])
}

model customers {
  id                                String                             @id
  firstName                         String
  lastName                          String
  email                             String?
  phone                             String?
  avatar                            String?
  facebookId                        String?
  whatsappId                        String?
  telegramId                        String?
  status                            customers_status                   @default(LEAD)
  tags                              String?
  notes                             String?
  metadata                          String?                            @db.Text
  companyId                         String
  createdAt                         DateTime                           @default(now())
  updatedAt                         DateTime
  customerRating                    customers_customerRating           @default(UNKNOWN)
  successScore                      Float                              @default(0)
  deliveryRate                      Float                              @default(0)
  totalDelivered                    Int                                @default(0)
  totalOrdersCount                  Int                                @default(0)
  activities                        activities[]
  affiliate_referrals               affiliate_referrals[]
  ai_interactions                   ai_interactions[]
  appointments                      appointments[]
  blocked_customers_on_page         blocked_customers_on_page[]
  conversation_outcomes             conversation_outcomes[]
  conversations                     conversations[]
  customer_loyalty_records          customer_loyalty_records[]
  customer_notes                    customer_notes[]
  customer_notification_preferences customer_notification_preferences?
  customer_wallets                  customer_wallets?
  companies                         companies                          @relation(fields: [companyId], references: [id], onDelete: Cascade)
  orders                            orders[]
  return_requests                   return_requests[]
  whatsapp_contacts                 whatsapp_contacts[]
  whatsapp_notification_logs        whatsapp_notification_logs[]

  @@unique([facebookId, companyId])
  @@unique([telegramId, companyId])
  @@unique([whatsappId, companyId])
  @@index([companyId])
  @@index([companyId, status])
  @@index([facebookId])
  @@index([status])
}

model daily_analytics {
  id                 String    @id
  companyId          String
  date               DateTime  @db.Date
  totalVisits        Int       @default(0)
  uniqueVisitors     Int       @default(0)
  totalProductViews  Int       @default(0)
  totalAddToCarts    Int       @default(0)
  totalCheckouts     Int       @default(0)
  totalPurchases     Int       @default(0)
  totalRevenue       Decimal   @default(0.00) @db.Decimal(12, 2)
  conversionRate     Decimal   @default(0.00) @db.Decimal(5, 2)
  avgOrderValue      Decimal   @default(0.00) @db.Decimal(10, 2)
  bounceRate         Decimal   @default(0.00) @db.Decimal(5, 2)
  avgSessionDuration Int       @default(0)
  companies          companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, date])
  @@index([companyId, date])
}

model delivery_options {
  id           String    @id
  name         String
  description  String?   @db.Text
  deliveryTime String
  price        Decimal   @db.Decimal(10, 2)
  isDefault    Boolean   @default(false)
  isActive     Boolean   @default(true)
  icon         String?
  sortOrder    Int       @default(0)
  companyId    String
  createdAt    DateTime  @default(now())
  updatedAt    DateTime
  companies    companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([isActive])
}

model dev_member_badges {
  id               String           @id
  memberId         String
  badgeCode        String
  earnedAt         DateTime         @default(now())
  dev_team_members dev_team_members @relation(fields: [memberId], references: [id], onDelete: Cascade)

  @@index([memberId])
}

model dev_notifications {
  id               String           @id
  memberId         String
  taskId           String?
  projectId        String?
  type             String
  title            String
  message          String           @db.Text
  isRead           Boolean          @default(false)
  readAt           DateTime?
  link             String?
  createdAt        DateTime         @default(now())
  dev_team_members dev_team_members @relation(fields: [memberId], references: [id], onDelete: Cascade)

  @@index([createdAt])
  @@index([isRead])
  @@index([memberId])
}

model dev_projects {
  id               String                @id
  name             String
  description      String                @db.Text
  status           dev_projects_status   @default(PLANNING)
  priority         dev_projects_priority @default(MEDIUM)
  color            String                @default("#6366f1")
  icon             String?
  startDate        DateTime?
  endDate          DateTime?
  progress         Int                   @default(0)
  managerId        String?
  teamMembers      String?               @db.LongText
  tags             String?               @db.LongText
  repository       String?
  createdAt        DateTime              @default(now())
  updatedAt        DateTime
  companyRelId     String?
  companies        companies?            @relation(fields: [companyRelId], references: [id])
  dev_team_members dev_team_members?     @relation(fields: [managerId], references: [id])
  dev_releases     dev_releases[]
  dev_tasks        dev_tasks[]

  @@index([companyRelId], map: "dev_projects_companyRelId_fkey")
  @@index([managerId])
  @@index([priority])
  @@index([status])
}

model dev_releases {
  id           String              @id
  version      String
  name         String
  description  String?             @db.Text
  status       dev_releases_status @default(PLANNING)
  releaseDate  DateTime?
  changelog    String?             @db.LongText
  projectId    String?
  createdAt    DateTime            @default(now())
  updatedAt    DateTime
  dev_projects dev_projects?       @relation(fields: [projectId], references: [id])
  dev_tasks    dev_tasks[]

  @@index([projectId])
  @@index([releaseDate])
  @@index([status])
}

model dev_system_settings {
  id        String   @id
  key       String   @unique @default("default")
  value     String   @db.LongText
  group     String   @default("general")
  createdAt DateTime @default(now())
  updatedAt DateTime
}

model dev_task_activities {
  id               String            @id
  taskId           String
  memberId         String?
  action           String
  field            String?
  oldValue         String?           @db.Text
  newValue         String?           @db.Text
  description      String?           @db.Text
  createdAt        DateTime          @default(now())
  dev_team_members dev_team_members? @relation(fields: [memberId], references: [id])
  dev_tasks        dev_tasks         @relation(fields: [taskId], references: [id], onDelete: Cascade)

  @@index([action])
  @@index([createdAt])
  @@index([memberId])
  @@index([taskId])
}

model dev_task_attachments {
  id           String    @id
  taskId       String
  fileName     String
  originalName String
  fileSize     Int
  fileType     String
  filePath     String
  uploadedBy   String
  createdAt    DateTime  @default(now())
  dev_tasks    dev_tasks @relation(fields: [taskId], references: [id], onDelete: Cascade)

  @@index([taskId])
}

model dev_task_checklist_items {
  id                  String              @id
  checklistId         String
  content             String
  isCompleted         Boolean             @default(false)
  completedAt         DateTime?
  completedBy         String?
  position            Int                 @default(0)
  createdAt           DateTime            @default(now())
  updatedAt           DateTime
  dev_task_checklists dev_task_checklists @relation(fields: [checklistId], references: [id], onDelete: Cascade)

  @@index([checklistId])
}

model dev_task_checklists {
  id                       String                     @id
  taskId                   String
  title                    String
  position                 Int                        @default(0)
  createdAt                DateTime                   @default(now())
  updatedAt                DateTime
  dev_task_checklist_items dev_task_checklist_items[]
  dev_tasks                dev_tasks                  @relation(fields: [taskId], references: [id], onDelete: Cascade)

  @@index([taskId])
}

model dev_task_comments {
  id                      String              @id
  taskId                  String
  authorId                String
  content                 String              @db.Text
  parentCommentId         String?
  mentions                String?             @db.LongText
  isEdited                Boolean             @default(false)
  editedAt                DateTime?
  createdAt               DateTime            @default(now())
  updatedAt               DateTime
  dev_team_members        dev_team_members    @relation(fields: [authorId], references: [id])
  dev_task_comments       dev_task_comments?  @relation("dev_task_commentsTodev_task_comments", fields: [parentCommentId], references: [id])
  other_dev_task_comments dev_task_comments[] @relation("dev_task_commentsTodev_task_comments")
  dev_tasks               dev_tasks           @relation(fields: [taskId], references: [id], onDelete: Cascade)

  @@index([authorId])
  @@index([parentCommentId])
  @@index([taskId])
}

model dev_task_watchers {
  id               String           @id
  taskId           String
  memberId         String
  createdAt        DateTime         @default(now())
  dev_team_members dev_team_members @relation(fields: [memberId], references: [id], onDelete: Cascade)
  dev_tasks        dev_tasks        @relation(fields: [taskId], references: [id], onDelete: Cascade)

  @@unique([taskId, memberId])
  @@index([memberId])
  @@index([taskId])
}

model dev_tasks {
  id                                                      String                 @id
  title                                                   String
  description                                             String                 @db.Text
  type                                                    dev_tasks_type         @default(FEATURE)
  status                                                  dev_tasks_status       @default(BACKLOG)
  priority                                                dev_tasks_priority     @default(MEDIUM)
  component                                               String?
  assigneeId                                              String?
  reporterId                                              String
  projectId                                               String?
  releaseId                                               String?
  parentTaskId                                            String?
  order                                                   Int                    @default(0)
  dueDate                                                 DateTime?
  startDate                                               DateTime?
  completedDate                                           DateTime?
  estimatedHours                                          Float                  @default(0)
  actualHours                                             Float                  @default(0)
  progress                                                Int                    @default(0)
  tags                                                    String?                @db.LongText
  labels                                                  String?                @db.LongText
  gitBranch                                               String?
  gitPR                                                   String?
  companyId                                               String?
  ticketId                                                String?
  createdAt                                               DateTime               @default(now())
  updatedAt                                               DateTime
  acceptanceCriteria                                      String?                @db.Text
  businessValue                                           String?                @db.Text
  xpEarned                                                Int?
  relatedLinks                                            String?                @db.LongText
  companyRelId                                            String?
  dev_task_activities                                     dev_task_activities[]
  dev_task_attachments                                    dev_task_attachments[]
  dev_task_checklists                                     dev_task_checklists[]
  dev_task_comments                                       dev_task_comments[]
  dev_task_watchers                                       dev_task_watchers[]
  dev_team_members_dev_tasks_assigneeIdTodev_team_members dev_team_members?      @relation("dev_tasks_assigneeIdTodev_team_members", fields: [assigneeId], references: [id])
  companies                                               companies?             @relation(fields: [companyRelId], references: [id])
  dev_tasks                                               dev_tasks?             @relation("dev_tasksTodev_tasks", fields: [parentTaskId], references: [id])
  other_dev_tasks                                         dev_tasks[]            @relation("dev_tasksTodev_tasks")
  dev_projects                                            dev_projects?          @relation(fields: [projectId], references: [id])
  dev_releases                                            dev_releases?          @relation(fields: [releaseId], references: [id])
  dev_team_members_dev_tasks_reporterIdTodev_team_members dev_team_members       @relation("dev_tasks_reporterIdTodev_team_members", fields: [reporterId], references: [id])
  dev_time_logs                                           dev_time_logs[]

  @@index([assigneeId])
  @@index([companyRelId], map: "dev_tasks_companyRelId_fkey")
  @@index([component])
  @@index([dueDate])
  @@index([order])
  @@index([parentTaskId])
  @@index([priority])
  @@index([projectId])
  @@index([releaseId])
  @@index([reporterId])
  @@index([status])
  @@index([type])
}

model dev_team_members {
  id                                               String                @id
  userId                                           String                @unique
  role                                             String                @default("developer")
  department                                       String?
  skills                                           String?               @db.LongText
  availability                                     String                @default("available")
  isActive                                         Boolean               @default(true)
  createdAt                                        DateTime              @default(now())
  updatedAt                                        DateTime
  level                                            Int                   @default(1)
  xp                                               Int                   @default(0)
  dailyTarget                                      Int?
  hourlyRate                                       Decimal?              @db.Decimal(10, 2)
  weeklyTarget                                     Int?
  companyRelId                                     String?
  AIChatSession                                    AIChatSession[]
  dev_member_badges                                dev_member_badges[]
  dev_notifications                                dev_notifications[]
  dev_projects                                     dev_projects[]
  dev_task_activities                              dev_task_activities[]
  dev_task_comments                                dev_task_comments[]
  dev_task_watchers                                dev_task_watchers[]
  dev_tasks_dev_tasks_assigneeIdTodev_team_members dev_tasks[]           @relation("dev_tasks_assigneeIdTodev_team_members")
  dev_tasks_dev_tasks_reporterIdTodev_team_members dev_tasks[]           @relation("dev_tasks_reporterIdTodev_team_members")
  companies                                        companies?            @relation(fields: [companyRelId], references: [id])
  users                                            users                 @relation(fields: [userId], references: [id], onDelete: Cascade)
  dev_time_logs                                    dev_time_logs[]

  @@index([companyRelId], map: "dev_team_members_companyRelId_fkey")
  @@index([isActive])
  @@index([role])
  @@index([userId])
}

model dev_time_logs {
  id               String           @id
  taskId           String
  memberId         String
  startTime        DateTime
  endTime          DateTime?
  duration         Int              @default(0)
  description      String?          @db.Text
  isBillable       Boolean          @default(false)
  isRunning        Boolean          @default(false)
  createdAt        DateTime         @default(now())
  updatedAt        DateTime
  activityType     String?
  isPaused         Boolean          @default(false)
  pauseDuration    Int              @default(0)
  pauseHistory     String?          @db.LongText
  pausedAt         DateTime?
  dev_team_members dev_team_members @relation(fields: [memberId], references: [id])
  dev_tasks        dev_tasks        @relation(fields: [taskId], references: [id], onDelete: Cascade)

  @@index([isPaused])
  @@index([isRunning])
  @@index([memberId])
  @@index([taskId])
}

model employee_notification_preferences {
  id                 String    @id
  companyId          String
  employeeId         String
  phone              String
  attendanceReminder Boolean   @default(true)
  leaveUpdates       Boolean   @default(true)
  payrollNotice      Boolean   @default(true)
  birthdayWish       Boolean   @default(true)
  announcements      Boolean   @default(true)
  isOptedIn          Boolean   @default(true)
  createdAt          DateTime  @default(now())
  updatedAt          DateTime
  companies          companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, employeeId])
  @@unique([companyId, phone])
}

model excluded_models {
  id          String    @id
  modelName   String
  keyId       String?
  companyId   String?
  reason      String
  excludedAt  DateTime  @default(now())
  retryAt     DateTime
  retryCount  Int       @default(0)
  lastRetryAt DateTime?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime

  @@index([companyId])
  @@index([modelName, keyId])
  @@index([retryAt])
}

model facebook_ad_accounts {
  id                           String                         @id
  companyId                    String
  accountId                    String
  name                         String
  currency                     String                         @default("USD")
  timezone                     String?
  accessToken                  String                         @db.Text
  isActive                     Boolean                        @default(true)
  settings                     String?                        @db.Text
  createdAt                    DateTime                       @default(now())
  updatedAt                    DateTime
  companies                    companies                      @relation(fields: [companyId], references: [id], onDelete: Cascade)
  facebook_campaigns           facebook_campaigns[]
  facebook_custom_audiences    facebook_custom_audiences[]
  facebook_lookalike_audiences facebook_lookalike_audiences[]
  facebook_product_catalogs    facebook_product_catalogs[]

  @@unique([companyId, accountId])
  @@index([accountId])
  @@index([companyId])
}

model facebook_ad_insights {
  id               String       @id
  adId             String
  date             DateTime
  impressions      Int          @default(0)
  clicks           Int          @default(0)
  ctr              Float        @default(0)
  cpc              Float        @default(0)
  spend            Float        @default(0)
  conversions      Int          @default(0)
  cpa              Float        @default(0)
  reach            Int          @default(0)
  frequency        Float        @default(0)
  linkClicks       Int          @default(0)
  costPerLinkClick Float        @default(0)
  landingPageViews Int          @default(0)
  purchases        Int          @default(0)
  purchaseValue    Float        @default(0)
  roas             Float        @default(0)
  breakdown        String?      @db.Text
  createdAt        DateTime     @default(now())
  facebook_ads     facebook_ads @relation(fields: [adId], references: [id], onDelete: Cascade)

  @@unique([adId, date])
  @@index([adId])
  @@index([date])
}

model facebook_ad_test_variants {
  id                String            @id
  testId            String
  name              String
  variantType       String
  variantData       String            @db.Text
  adSetId           String?
  adId              String?
  impressions       Int               @default(0)
  clicks            Int               @default(0)
  conversions       Int               @default(0)
  spend             Float             @default(0)
  ctr               Float             @default(0)
  cpc               Float             @default(0)
  cpa               Float             @default(0)
  roas              Float             @default(0)
  isWinner          Boolean           @default(false)
  pValue            Float?
  confidenceLevel   Float?
  createdAt         DateTime          @default(now())
  updatedAt         DateTime
  facebook_ads      facebook_ads?     @relation(fields: [adId], references: [id])
  facebook_adsets   facebook_adsets?  @relation(fields: [adSetId], references: [id])
  facebook_ad_tests facebook_ad_tests @relation(fields: [testId], references: [id], onDelete: Cascade)

  @@index([adId])
  @@index([adSetId])
  @@index([testId])
  @@index([variantType])
}

model facebook_ad_tests {
  id                        String                      @id
  companyId                 String
  name                      String
  description               String?                     @db.Text
  testType                  String
  status                    String                      @default("DRAFT")
  campaignId                String?
  variants                  String                      @db.Text
  winnerVariantId           String?
  confidenceLevel           Float?
  testDuration              Int?
  startDate                 DateTime?
  endDate                   DateTime?
  trafficSplit              Int                         @default(50)
  minimumResults            Int                         @default(100)
  autoPromote               Boolean                     @default(false)
  totalSpend                Float                       @default(0)
  totalImpressions          Int                         @default(0)
  totalClicks               Int                         @default(0)
  totalConversions          Int                         @default(0)
  settings                  String?                     @db.Text
  createdAt                 DateTime                    @default(now())
  updatedAt                 DateTime
  facebook_ad_test_variants facebook_ad_test_variants[]
  facebook_campaigns        facebook_campaigns?         @relation(fields: [campaignId], references: [id])
  companies                 companies                   @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([campaignId])
  @@index([companyId])
  @@index([status])
  @@index([testType])
}

model facebook_ads {
  id                        String                      @id
  adSetId                   String
  companyId                 String
  name                      String
  status                    String                      @default("PAUSED")
  facebookAdId              String?
  creativeType              String
  primaryText               String                      @db.Text
  headline                  String?
  description               String?                     @db.Text
  callToAction              String?
  imageUrl                  String?
  videoUrl                  String?
  imageHash                 String?
  videoId                   String?
  carouselImages            String?                     @db.Text
  carouselCount             Int?                        @default(1)
  linkUrl                   String?
  productId                 String?
  creative                  String?                     @db.Text
  createdAt                 DateTime                    @default(now())
  updatedAt                 DateTime
  lastSyncAt                DateTime?
  facebook_ad_insights      facebook_ad_insights[]
  facebook_ad_test_variants facebook_ad_test_variants[]
  facebook_adsets           facebook_adsets             @relation(fields: [adSetId], references: [id], onDelete: Cascade)

  @@index([adSetId])
  @@index([companyId])
  @@index([facebookAdId])
  @@index([status])
}

model facebook_adsets {
  id                           String                         @id
  campaignId                   String
  name                         String
  status                       String                         @default("PAUSED")
  facebookAdSetId              String?
  targeting                    String?                        @db.Text
  ageMin                       Int?
  ageMax                       Int?
  genders                      String?                        @db.Text
  locations                    String?                        @db.Text
  interests                    String?                        @db.Text
  behaviors                    String?                        @db.Text
  customAudiencesJson          String?                        @db.Text
  lookalikeAudiencesJson       String?                        @db.Text
  budgetType                   String
  budgetAmount                 Float
  optimizationGoal             String?
  billingEvent                 String?
  settings                     String?                        @db.Text
  createdAt                    DateTime                       @default(now())
  updatedAt                    DateTime
  lastSyncAt                   DateTime?
  facebook_ad_test_variants    facebook_ad_test_variants[]
  facebook_ads                 facebook_ads[]
  facebook_campaigns           facebook_campaigns             @relation(fields: [campaignId], references: [id], onDelete: Cascade)
  facebook_dynamic_ads         facebook_dynamic_ads[]
  facebook_custom_audiences    facebook_custom_audiences[]    @relation("AdSetCustomAudiences")
  facebook_lookalike_audiences facebook_lookalike_audiences[] @relation("AdSetLookalikeAudiences")

  @@index([campaignId])
  @@index([facebookAdSetId])
  @@index([status])
}

model facebook_campaigns {
  id                   String                @id
  companyId            String
  adAccountId          String?
  name                 String
  objective            String
  status               String                @default("PAUSED")
  facebookCampaignId   String?
  budgetType           String
  budgetAmount         Float
  startDate            DateTime?
  endDate              DateTime?
  pixelId              String?
  settings             String?               @db.Text
  createdAt            DateTime              @default(now())
  updatedAt            DateTime
  lastSyncAt           DateTime?
  facebook_ad_tests    facebook_ad_tests[]
  facebook_adsets      facebook_adsets[]
  facebook_ad_accounts facebook_ad_accounts? @relation(fields: [adAccountId], references: [id])
  companies            companies             @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([adAccountId])
  @@index([companyId])
  @@index([facebookCampaignId])
  @@index([status])
}

model facebook_catalog_products {
  id                        String                    @id
  catalogId                 String
  productId                 String?
  name                      String
  description               String?                   @db.Text
  brand                     String?
  category                  String?
  sku                       String?
  price                     Decimal?                  @db.Decimal(10, 2)
  currency                  String?                   @default("USD")
  availability              String                    @default("in stock")
  inventory                 Int?
  imageUrl                  String?
  imageHash                 String?
  additionalImages          String?                   @db.Text
  linkUrl                   String?
  mobileLinkUrl             String?
  facebookProductId         String?
  facebookRetailerId        String?
  syncStatus                String                    @default("PENDING")
  lastSyncedAt              DateTime?
  syncError                 String?                   @db.Text
  metadata                  String?                   @db.Text
  createdAt                 DateTime                  @default(now())
  updatedAt                 DateTime
  facebook_product_catalogs facebook_product_catalogs @relation(fields: [catalogId], references: [id], onDelete: Cascade)
  products                  products?                 @relation(fields: [productId], references: [id])

  @@unique([catalogId, productId])
  @@unique([catalogId, sku])
  @@index([catalogId])
  @@index([facebookProductId])
  @@index([productId])
  @@index([syncStatus])
}

model facebook_comments {
  id          String     @id
  commentId   String     @unique
  postId      String
  senderId    String
  senderName  String
  message     String     @db.Text
  response    String?    @db.Text
  createdTime DateTime
  respondedAt DateTime?
  pageId      String?
  companyId   String?
  createdAt   DateTime   @default(now())
  updatedAt   DateTime
  companies   companies? @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([commentId])
  @@index([companyId])
  @@index([createdTime])
  @@index([postId])
  @@index([senderId])
}

model facebook_custom_audiences {
  id                           String                         @id
  companyId                    String
  adAccountId                  String?
  name                         String
  description                  String?                        @db.Text
  audienceType                 String
  facebookAudienceId           String?
  customerListId               String?
  matchRate                    Float?
  pixelId                      String?
  eventType                    String?
  retentionDays                Int?                           @default(30)
  engagementType               String?
  videoId                      String?
  videoViewDuration            Int?
  status                       String                         @default("ACTIVE")
  audienceSize                 Int?
  settings                     String?                        @db.Text
  createdAt                    DateTime                       @default(now())
  updatedAt                    DateTime
  lastSyncAt                   DateTime?
  facebook_ad_accounts         facebook_ad_accounts?          @relation(fields: [adAccountId], references: [id])
  companies                    companies                      @relation(fields: [companyId], references: [id], onDelete: Cascade)
  facebook_lookalike_audiences facebook_lookalike_audiences[]
  facebook_adsets              facebook_adsets[]              @relation("AdSetCustomAudiences")

  @@index([adAccountId])
  @@index([companyId])
  @@index([facebookAudienceId])
  @@index([status])
}

model facebook_dynamic_ads {
  id                        String                    @id
  companyId                 String
  catalogId                 String
  adSetId                   String?
  name                      String
  status                    String                    @default("PAUSED")
  facebookAdId              String?
  productSetId              String?
  templateUrl               String?
  templateId                String?
  collectionId              String?
  categoryId                String?
  headline                  String?
  description               String?                   @db.Text
  callToAction              String?
  createdAt                 DateTime                  @default(now())
  updatedAt                 DateTime
  lastSyncAt                DateTime?
  facebook_adsets           facebook_adsets?          @relation(fields: [adSetId], references: [id])
  facebook_product_catalogs facebook_product_catalogs @relation(fields: [catalogId], references: [id], onDelete: Cascade)
  companies                 companies                 @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, facebookAdId])
  @@index([adSetId])
  @@index([catalogId])
  @@index([companyId])
  @@index([facebookAdId])
  @@index([status])
}

model facebook_lookalike_audiences {
  id                        String                    @id
  companyId                 String
  adAccountId               String?
  sourceAudienceId          String
  name                      String
  description               String?                   @db.Text
  facebookAudienceId        String?
  lookalikeSpec             String
  country                   String
  ratio                     Int                       @default(1)
  status                    String                    @default("ACTIVE")
  audienceSize              Int?
  settings                  String?                   @db.Text
  createdAt                 DateTime                  @default(now())
  updatedAt                 DateTime
  lastSyncAt                DateTime?
  facebook_ad_accounts      facebook_ad_accounts?     @relation(fields: [adAccountId], references: [id])
  companies                 companies                 @relation(fields: [companyId], references: [id], onDelete: Cascade)
  facebook_custom_audiences facebook_custom_audiences @relation(fields: [sourceAudienceId], references: [id], onDelete: Cascade)
  facebook_adsets           facebook_adsets[]         @relation("AdSetLookalikeAudiences")

  @@index([adAccountId])
  @@index([companyId])
  @@index([facebookAudienceId])
  @@index([sourceAudienceId])
  @@index([status])
}

model facebook_pages {
  id                        String                      @id
  pageId                    String                      @unique
  pageAccessToken           String                      @db.Text
  pageName                  String
  companyId                 String?
  status                    String                      @default("connected")
  connectedAt               DateTime                    @default(now())
  createdAt                 DateTime                    @default(now())
  updatedAt                 DateTime
  disconnectedAt            DateTime?
  blocked_customers_on_page blocked_customers_on_page[]
  companies                 companies?                  @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
}

model facebook_pixel_configs {
  id                        String              @id
  storefrontSettingsId      String
  pixelId                   String
  pixelName                 String
  accessToken               String?             @db.Text
  isActive                  Boolean             @default(true)
  isPrimary                 Boolean             @default(false)
  trackPageView             Boolean             @default(true)
  trackViewContent          Boolean             @default(true)
  trackAddToCart            Boolean             @default(true)
  trackInitiateCheckout     Boolean             @default(true)
  trackPurchase             Boolean             @default(true)
  trackSearch               Boolean             @default(true)
  trackAddToWishlist        Boolean             @default(false)
  trackLead                 Boolean             @default(false)
  trackCompleteRegistration Boolean             @default(false)
  lastTestAt                DateTime?
  lastTestResult            String?             @default("not_tested")
  lastEventSentAt           DateTime?
  totalEventsSent           Int                 @default(0)
  errorCount                Int                 @default(0)
  lastError                 String?             @db.Text
  tokenStatus               String?             @default("unknown")
  tokenExpiresAt            DateTime?
  eventMatchQuality         Float?
  createdAt                 DateTime            @default(now())
  updatedAt                 DateTime
  storefront_settings       storefront_settings @relation(fields: [storefrontSettingsId], references: [id], onDelete: Cascade)

  @@unique([storefrontSettingsId, pixelId])
  @@index([isActive])
  @@index([storefrontSettingsId])
}

model facebook_product_catalogs {
  id                        String                      @id
  companyId                 String
  adAccountId               String?
  name                      String
  description               String?                     @db.Text
  facebookCatalogId         String?
  catalogType               String                      @default("PRODUCTS")
  isActive                  Boolean                     @default(true)
  status                    String                      @default("ACTIVE")
  lastSyncAt                DateTime?
  lastSyncStatus            String?
  totalProducts             Int                         @default(0)
  syncedProducts            Int                         @default(0)
  settings                  String?                     @db.Text
  createdAt                 DateTime                    @default(now())
  updatedAt                 DateTime
  facebook_catalog_products facebook_catalog_products[]
  facebook_dynamic_ads      facebook_dynamic_ads[]
  facebook_ad_accounts      facebook_ad_accounts?       @relation(fields: [adAccountId], references: [id])
  companies                 companies                   @relation(fields: [companyId], references: [id], onDelete: Cascade)
  facebook_product_feeds    facebook_product_feeds[]

  @@unique([companyId, facebookCatalogId])
  @@index([adAccountId])
  @@index([companyId])
  @@index([facebookCatalogId])
  @@index([status])
}

model facebook_product_feeds {
  id                        String                    @id
  catalogId                 String
  name                      String
  feedType                  String                    @default("PRODUCT")
  format                    String                    @default("CSV")
  fileUrl                   String?
  fileName                  String?
  fileSize                  Int?
  facebookFeedId            String?
  feedUrl                   String?
  schedule                  String?
  lastUploadedAt            DateTime?
  nextUploadAt              DateTime?
  status                    String                    @default("ACTIVE")
  uploadStatus              String?
  settings                  String?                   @db.Text
  createdAt                 DateTime                  @default(now())
  updatedAt                 DateTime
  facebook_product_catalogs facebook_product_catalogs @relation(fields: [catalogId], references: [id], onDelete: Cascade)

  @@index([catalogId])
  @@index([facebookFeedId])
  @@index([status])
}

model faqs {
  id                   String    @id
  companyId            String
  question             String    @db.Text
  answer               String    @db.Text
  category             String    @default("general")
  tags                 String?   @db.Text
  order                Int       @default(0)
  helpful              Int       @default(0)
  notHelpful           Int       @default(0)
  isActive             Boolean   @default(true)
  version              Int       @default(1)
  createdAt            DateTime  @default(now())
  updatedAt            DateTime
  embedding            String?   @db.Text
  embeddingGeneratedAt DateTime?
  companies            companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([category])
  @@index([companyId])
  @@index([companyId, isActive])
  @@index([isActive])
}

model few_shot_examples {
  id              String    @id
  companyId       String
  customerMessage String    @db.Text
  aiResponse      String    @db.Text
  category        String?
  tags            String?   @db.Text
  priority        Int       @default(0)
  isActive        Boolean   @default(true)
  usageCount      Int       @default(0)
  lastUsedAt      DateTime?
  notes           String?   @db.Text
  createdAt       DateTime  @default(now())
  updatedAt       DateTime

  @@index([category])
  @@index([companyId])
  @@index([isActive])
  @@index([priority])
}

model few_shot_settings {
  id                   String   @id
  companyId            String   @unique
  enabled              Boolean  @default(false)
  maxExamplesPerPrompt Int      @default(3)
  selectionStrategy    String   @default("priority")
  autoLearnFromGood    Boolean  @default(false)
  minQualityScore      Float    @default(80)
  createdAt            DateTime @default(now())
  updatedAt            DateTime
}

model footer_settings {
  id             String    @id
  companyId      String    @unique
  aboutStore     String?   @db.Text
  showAboutStore Boolean   @default(true)
  email          String?
  showEmail      Boolean   @default(true)
  phone          String?
  showPhone      Boolean   @default(true)
  address        String?   @db.Text
  showAddress    Boolean   @default(true)
  showQuickLinks Boolean   @default(true)
  copyrightText  String?   @db.Text
  showCopyright  Boolean   @default(true)
  createdAt      DateTime  @default(now())
  updatedAt      DateTime
  companies      companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
}

model global_ai_configs {
  id              String                            @id
  defaultProvider global_ai_configs_defaultProvider @default(GOOGLE)
  isActive        Boolean                           @default(true)
  settings        String?                           @db.Text
  createdAt       DateTime                          @default(now())
  updatedAt       DateTime
  enableFailover  Boolean                           @default(true)
}

model guest_carts {
  id        String    @id
  cartId    String    @unique
  items     String    @db.LongText
  total     Decimal   @default(0.00) @db.Decimal(10, 2)
  companyId String
  createdAt DateTime  @default(now())
  updatedAt DateTime  @default(now())
  expiresAt DateTime
  companies companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([cartId])
  @@index([companyId])
  @@index([expiresAt])
}

model guest_orders {
  id                  String               @id
  orderNumber         String
  guestEmail          String
  guestPhone          String
  guestName           String
  items               String               @db.LongText
  total               Decimal              @db.Decimal(10, 2)
  shippingCost        Decimal              @default(0.00) @db.Decimal(10, 2)
  discountAmount      Decimal              @default(0.00) @db.Decimal(10, 2)
  finalTotal          Decimal              @db.Decimal(10, 2)
  shippingAddress     String               @db.LongText
  paymentMethod       String
  status              String               @default("pending")
  notes               String?              @db.Text
  companyId           String
  createdAt           DateTime             @default(now())
  updatedAt           DateTime             @default(now())
  isViewed            Boolean              @default(false)
  metadata            String?              @db.Text
  affiliateId         String?
  turboLabelUrl       String?              @db.Text
  turboMetadata       String?              @db.Text
  turboShipmentId     String?
  turboShipmentStatus String?
  turboTrackingNumber String?
  createdBy           String?
  createdByName       String?
  OrderStatusHistory  OrderStatusHistory[]
  affiliates          affiliates?          @relation(fields: [affiliateId], references: [id])
  companies           companies            @relation(fields: [companyId], references: [id], onDelete: Cascade)
  users               users?               @relation(fields: [createdBy], references: [id])
  order_notes         order_notes[]

  @@unique([companyId, orderNumber])
  @@index([affiliateId])
  @@index([companyId])
  @@index([createdAt])
  @@index([createdBy])
  @@index([guestEmail])
  @@index([orderNumber])
  @@index([status])
  @@index([turboShipmentId])
  @@index([turboTrackingNumber])
}

model homepage_templates {
  id          String    @id
  companyId   String
  name        String
  description String?   @db.Text
  content     String    @db.LongText
  thumbnail   String?   @db.Text
  isActive    Boolean   @default(false)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime
  companies   companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([isActive])
}

model hr_advance_requests {
  id                String        @id
  companyId         String
  userId            String?
  amount            Decimal       @db.Decimal(10, 2)
  reason            String        @db.Text
  repaymentType     String
  installmentsCount Int           @default(1)
  monthlyAmount     Decimal       @db.Decimal(10, 2)
  employeeSalary    Decimal?      @db.Decimal(10, 2)
  maxAllowedAmount  Decimal?      @db.Decimal(10, 2)
  installmentAmount Decimal?      @db.Decimal(10, 2)
  remainingBalance  Decimal       @default(0.00) @db.Decimal(10, 2)
  isPaidOff         Boolean       @default(false)
  status            String        @default("PENDING")
  approvedBy        String?
  approvedAt        DateTime?
  rejectedReason    String?       @db.Text
  createdAt         DateTime      @default(now())
  updatedAt         DateTime
  employeeRelId     String?
  companies         companies     @relation(fields: [companyId], references: [id], onDelete: Cascade)
  hr_employees      hr_employees? @relation(fields: [employeeRelId], references: [id])

  @@index([companyId])
  @@index([employeeRelId], map: "hr_advance_requests_employeeRelId_fkey")
  @@index([status])
  @@index([userId])
}

model hr_attendances {
  id                String                @id
  companyId         String
  userId            String
  date              DateTime              @db.Date
  checkIn           DateTime?
  checkOut          DateTime?
  checkInLocation   String?
  checkOutLocation  String?
  checkInMethod     String?
  checkOutMethod    String?
  workHours         Decimal?              @db.Decimal(5, 2)
  overtimeHours     Decimal?              @db.Decimal(5, 2)
  lateMinutes       Int?                  @default(0)
  earlyLeaveMinutes Int?                  @default(0)
  status            hr_attendances_status @default(PRESENT)
  isApproved        Boolean               @default(false)
  approvedBy        String?
  notes             String?               @db.Text
  createdAt         DateTime              @default(now())
  updatedAt         DateTime
  employeeRelId     String?
  companies         companies             @relation(fields: [companyId], references: [id], onDelete: Cascade)
  hr_employees      hr_employees?         @relation(fields: [employeeRelId], references: [id])
  users             users                 @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, date])
  @@index([companyId])
  @@index([date])
  @@index([employeeRelId], map: "hr_attendances_employeeRelId_fkey")
  @@index([status])
  @@index([userId])
}

model hr_audit_logs {
  id         String    @id
  companyId  String
  action     String
  entityType String
  entityId   String?
  actorId    String
  actorName  String
  details    String?   @db.Text
  ipAddress  String?
  createdAt  DateTime  @default(now())
  users      users     @relation(fields: [actorId], references: [id])
  companies  companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([actorId], map: "hr_audit_logs_actorId_fkey")
  @@index([companyId])
  @@index([createdAt])
  @@index([entityType])
}

model hr_benefit_enrollments {
  id            String        @id
  companyId     String
  benefitId     String
  startDate     DateTime      @db.Date
  endDate       DateTime?     @db.Date
  status        String        @default("ACTIVE")
  notes         String?       @db.Text
  createdAt     DateTime      @default(now())
  updatedAt     DateTime
  userId        String
  employeeRelId String?
  hr_benefits   hr_benefits   @relation(fields: [benefitId], references: [id], onDelete: Cascade)
  companies     companies     @relation(fields: [companyId], references: [id], onDelete: Cascade)
  hr_employees  hr_employees? @relation(fields: [employeeRelId], references: [id])

  @@index([benefitId])
  @@index([companyId])
  @@index([employeeRelId], map: "hr_benefit_enrollments_employeeRelId_fkey")
  @@index([userId])
}

model hr_benefits {
  id                     String                   @id
  companyId              String
  name                   String
  description            String?                  @db.Text
  type                   String
  cost                   Decimal?                 @db.Decimal(12, 2)
  currency               String                   @default("EGP")
  isActive               Boolean                  @default(true)
  createdAt              DateTime                 @default(now())
  updatedAt              DateTime
  hr_benefit_enrollments hr_benefit_enrollments[]
  companies              companies                @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
}

model hr_clearance_checklists {
  id              String          @id
  resignationId   String
  itemName        String
  description     String?
  isCompleted     Boolean         @default(false)
  completedBy     String?
  completedAt     DateTime?
  notes           String?         @db.Text
  createdAt       DateTime        @default(now())
  updatedAt       DateTime
  users           users?          @relation(fields: [completedBy], references: [id])
  hr_resignations hr_resignations @relation(fields: [resignationId], references: [id], onDelete: Cascade)

  @@index([completedBy], map: "hr_clearance_checklists_completedBy_fkey")
  @@index([resignationId])
}

model hr_departments {
  id                                                     String           @id
  companyId                                              String
  name                                                   String
  nameEn                                                 String?
  code                                                   String?
  description                                            String?          @db.Text
  managerId                                              String?
  parentId                                               String?
  color                                                  String?          @default("#3B82F6")
  icon                                                   String?
  isActive                                               Boolean          @default(true)
  sortOrder                                              Int              @default(0)
  createdAt                                              DateTime         @default(now())
  updatedAt                                              DateTime
  companies                                              companies        @relation(fields: [companyId], references: [id], onDelete: Cascade)
  hr_departments                                         hr_departments?  @relation("hr_departmentsTohr_departments", fields: [parentId], references: [id])
  other_hr_departments                                   hr_departments[] @relation("hr_departmentsTohr_departments")
  hr_employees_hr_employees_departmentIdTohr_departments hr_employees[]   @relation("hr_employees_departmentIdTohr_departments")
  hr_goals                                               hr_goals[]
  hr_positions                                           hr_positions[]
  users                                                  users[]
  hr_employees_DepartmentManager                         hr_employees[]   @relation("DepartmentManager")

  @@unique([companyId, code])
  @@index([companyId])
  @@index([managerId])
  @@index([parentId])
}

model hr_employee_documents {
  id            String        @id
  companyId     String
  name          String
  type          String
  fileUrl       String
  fileSize      Int?
  mimeType      String?
  expiryDate    DateTime?
  isVerified    Boolean       @default(false)
  verifiedBy    String?
  verifiedAt    DateTime?
  notes         String?       @db.Text
  createdAt     DateTime      @default(now())
  updatedAt     DateTime
  userId        String
  employeeRelId String?
  companies     companies     @relation(fields: [companyId], references: [id], onDelete: Cascade)
  hr_employees  hr_employees? @relation(fields: [employeeRelId], references: [id])

  @@index([companyId])
  @@index([employeeRelId], map: "hr_employee_documents_employeeRelId_fkey")
  @@index([type])
  @@index([userId])
}

model hr_employee_training {
  id             String                      @id
  companyId      String
  trainingName   String
  provider       String?
  type           String
  description    String?                     @db.Text
  startDate      DateTime                    @db.Date
  endDate        DateTime?                   @db.Date
  duration       Int?
  cost           Decimal?                    @db.Decimal(12, 2)
  currency       String                      @default("EGP")
  status         hr_employee_training_status @default(PLANNED)
  completionDate DateTime?
  certificateUrl String?
  score          Decimal?                    @db.Decimal(5, 2)
  feedback       String?                     @db.Text
  createdAt      DateTime                    @default(now())
  updatedAt      DateTime
  userId         String?
  employeeRelId  String?
  companies      companies                   @relation(fields: [companyId], references: [id], onDelete: Cascade)
  hr_employees   hr_employees?               @relation(fields: [employeeRelId], references: [id])

  @@index([companyId])
  @@index([employeeRelId], map: "hr_employee_training_employeeRelId_fkey")
  @@index([status])
  @@index([userId])
}

model hr_employee_warnings {
  id               String                    @id
  companyId        String
  type             hr_employee_warnings_type
  severity         String                    @default("minor")
  title            String
  description      String                    @db.Text
  incidentDate     DateTime                  @db.Date
  actionTaken      String?                   @db.Text
  issuedBy         String
  acknowledgedAt   DateTime?
  employeeResponse String?                   @db.Text
  attachments      String?                   @db.Text
  createdAt        DateTime                  @default(now())
  updatedAt        DateTime
  userId           String?
  employeeRelId    String?
  companies        companies                 @relation(fields: [companyId], references: [id], onDelete: Cascade)
  hr_employees     hr_employees?             @relation(fields: [employeeRelId], references: [id])

  @@index([companyId])
  @@index([employeeRelId], map: "hr_employee_warnings_employeeRelId_fkey")
  @@index([userId])
}

model hr_employees {
  id                                                                                    String                      @id
  companyId                                                                             String
  userId                                                                                String?                     @unique
  employeeNumber                                                                        String
  firstName                                                                             String
  lastName                                                                              String
  firstNameEn                                                                           String?
  lastNameEn                                                                            String?
  email                                                                                 String?
  phone                                                                                 String?
  mobile                                                                                String?
  avatar                                                                                String?
  dateOfBirth                                                                           DateTime?
  gender                                                                                hr_employees_gender?
  nationality                                                                           String?
  nationalId                                                                            String?
  passportNumber                                                                        String?
  maritalStatus                                                                         hr_employees_maritalStatus?
  address                                                                               String?                     @db.Text
  city                                                                                  String?
  country                                                                               String?
  postalCode                                                                            String?
  departmentId                                                                          String?
  positionId                                                                            String?
  managerId                                                                             String?
  hireDate                                                                              DateTime
  probationEndDate                                                                      DateTime?
  contractType                                                                          hr_employees_contractType   @default(FULL_TIME)
  contractEndDate                                                                       DateTime?
  workLocation                                                                          String?
  baseSalary                                                                            Decimal?                    @db.Decimal(12, 2)
  currency                                                                              String                      @default("EGP")
  bankName                                                                              String?
  bankAccountNumber                                                                     String?
  bankIban                                                                              String?
  annualLeaveBalance                                                                    Int                         @default(21)
  sickLeaveBalance                                                                      Int                         @default(15)
  status                                                                                hr_employees_status         @default(ACTIVE)
  terminationDate                                                                       DateTime?
  terminationReason                                                                     String?                     @db.Text
  emergencyContact                                                                      String?                     @db.Text
  documents                                                                             String?                     @db.Text
  notes                                                                                 String?                     @db.Text
  metadata                                                                              String?                     @db.Text
  createdAt                                                                             DateTime                    @default(now())
  updatedAt                                                                             DateTime
  hr_advance_requests                                                                   hr_advance_requests[]
  hr_attendances                                                                        hr_attendances[]
  hr_benefit_enrollments                                                                hr_benefit_enrollments[]
  hr_employee_documents                                                                 hr_employee_documents[]
  hr_employee_training                                                                  hr_employee_training[]
  hr_employee_warnings                                                                  hr_employee_warnings[]
  companies                                                                             companies                   @relation(fields: [companyId], references: [id], onDelete: Cascade)
  hr_departments_hr_employees_departmentIdTohr_departments                              hr_departments?             @relation("hr_employees_departmentIdTohr_departments", fields: [departmentId], references: [id])
  hr_employees                                                                          hr_employees?               @relation("hr_employeesTohr_employees", fields: [managerId], references: [id])
  other_hr_employees                                                                    hr_employees[]              @relation("hr_employeesTohr_employees")
  hr_positions                                                                          hr_positions?               @relation(fields: [positionId], references: [id])
  users                                                                                 users?                      @relation(fields: [userId], references: [id])
  hr_feedbacks_hr_feedbacks_employeeFeedbackFromIdTohr_employees                        hr_feedbacks[]              @relation("hr_feedbacks_employeeFeedbackFromIdTohr_employees")
  hr_feedbacks_hr_feedbacks_employeeFeedbackToIdTohr_employees                          hr_feedbacks[]              @relation("hr_feedbacks_employeeFeedbackToIdTohr_employees")
  hr_goals                                                                              hr_goals[]
  hr_late_warnings                                                                      hr_late_warnings[]
  hr_leave_requests_hr_leave_requests_employeeEmployeeLeavesIdTohr_employees            hr_leave_requests[]         @relation("hr_leave_requests_employeeEmployeeLeavesIdTohr_employees")
  hr_leave_requests_hr_leave_requests_employeeLeaveApproverIdTohr_employees             hr_leave_requests[]         @relation("hr_leave_requests_employeeLeaveApproverIdTohr_employees")
  hr_payrolls                                                                           hr_payrolls[]
  hr_performance_reviews_hr_performance_reviews_employeeEmployeeReviewsIdTohr_employees hr_performance_reviews[]    @relation("hr_performance_reviews_employeeEmployeeReviewsIdTohr_employees")
  hr_performance_reviews_hr_performance_reviews_employeeReviewerReviewsIdTohr_employees hr_performance_reviews[]    @relation("hr_performance_reviews_employeeReviewerReviewsIdTohr_employees")
  hr_resignations                                                                       hr_resignations[]
  hr_salary_history                                                                     hr_salary_history[]
  hr_shift_assignments                                                                  hr_shift_assignments[]
  hr_departments_DepartmentManager                                                      hr_departments[]            @relation("DepartmentManager")

  @@unique([companyId, employeeNumber])
  @@index([companyId])
  @@index([departmentId])
  @@index([managerId])
  @@index([positionId])
  @@index([status])
}

model hr_feedbacks {
  id                                                             String        @id
  companyId                                                      String
  type                                                           String        @default("PEER")
  category                                                       String?
  content                                                        String        @db.Text
  rating                                                         Int?
  isAnonymous                                                    Boolean       @default(false)
  status                                                         String        @default("ACTIVE")
  createdAt                                                      DateTime      @default(now())
  updatedAt                                                      DateTime
  fromUserId                                                     String?
  toUserId                                                       String?
  employeeFeedbackToId                                           String?
  employeeFeedbackFromId                                         String?
  companies                                                      companies     @relation(fields: [companyId], references: [id], onDelete: Cascade)
  hr_employees_hr_feedbacks_employeeFeedbackFromIdTohr_employees hr_employees? @relation("hr_feedbacks_employeeFeedbackFromIdTohr_employees", fields: [employeeFeedbackFromId], references: [id])
  hr_employees_hr_feedbacks_employeeFeedbackToIdTohr_employees   hr_employees? @relation("hr_feedbacks_employeeFeedbackToIdTohr_employees", fields: [employeeFeedbackToId], references: [id])

  @@index([companyId])
  @@index([employeeFeedbackFromId], map: "hr_feedbacks_employeeFeedbackFromId_fkey")
  @@index([employeeFeedbackToId], map: "hr_feedbacks_employeeFeedbackToId_fkey")
  @@index([fromUserId])
  @@index([toUserId])
  @@index([type])
}

model hr_goals {
  id             String          @id
  companyId      String
  departmentId   String?
  title          String
  description    String?         @db.Text
  targetValue    Decimal         @db.Decimal(12, 2)
  currentValue   Decimal         @default(0.00) @db.Decimal(12, 2)
  unit           String?
  startDate      DateTime        @db.Date
  endDate        DateTime        @db.Date
  status         String          @default("PENDING")
  progress       Int             @default(0)
  createdAt      DateTime        @default(now())
  updatedAt      DateTime
  userId         String?
  employeeRelId  String?
  companies      companies       @relation(fields: [companyId], references: [id], onDelete: Cascade)
  hr_departments hr_departments? @relation(fields: [departmentId], references: [id], onDelete: Cascade)
  hr_employees   hr_employees?   @relation(fields: [employeeRelId], references: [id])

  @@index([companyId])
  @@index([departmentId])
  @@index([employeeRelId], map: "hr_goals_employeeRelId_fkey")
  @@index([status])
  @@index([userId])
}

model hr_kudos {
  id                               String    @id
  companyId                        String
  fromUserId                       String
  toUserId                         String
  reason                           String    @db.Text
  points                           Int       @default(1)
  createdAt                        DateTime  @default(now())
  updatedAt                        DateTime
  companies                        companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  users_hr_kudos_fromUserIdTousers users     @relation("hr_kudos_fromUserIdTousers", fields: [fromUserId], references: [id], onDelete: Cascade)
  users_hr_kudos_toUserIdTousers   users     @relation("hr_kudos_toUserIdTousers", fields: [toUserId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([fromUserId])
  @@index([toUserId])
}

model hr_late_warnings {
  id             String        @id
  companyId      String
  userId         String
  month          Int
  year           Int
  lateCount      Int
  totalMinutes   Int
  warningLevel   Int
  issuedAt       DateTime      @default(now())
  acknowledgedAt DateTime?
  employeeRelId  String?
  companies      companies     @relation(fields: [companyId], references: [id], onDelete: Cascade)
  hr_employees   hr_employees? @relation(fields: [employeeRelId], references: [id])

  @@index([companyId])
  @@index([employeeRelId], map: "hr_late_warnings_employeeRelId_fkey")
  @@index([month, year])
  @@index([userId])
}

model hr_lateness_balances {
  id                   String    @id
  companyId            String
  employeeId           String
  month                Int
  year                 Int
  totalLateMinutes     Int       @default(0)
  graceMinutesUsed     Int       @default(0)
  deductedMinutes      Int       @default(0)
  totalDeductionAmount Decimal   @default(0.00) @db.Decimal(10, 2)
  lateCount            Int       @default(0)
  createdAt            DateTime  @default(now())
  updatedAt            DateTime
  companies            companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([employeeId, month, year])
  @@index([companyId])
  @@index([employeeId])
  @@index([month, year])
}

model hr_leave_requests {
  id                                                                    String                   @id
  companyId                                                             String
  userId                                                                String
  type                                                                  hr_leave_requests_type
  startDate                                                             DateTime                 @db.Date
  endDate                                                               DateTime                 @db.Date
  totalDays                                                             Int
  isHalfDay                                                             Boolean                  @default(false)
  halfDayPeriod                                                         String?
  reason                                                                String?                  @db.Text
  attachments                                                           String?                  @db.Text
  status                                                                hr_leave_requests_status @default(PENDING)
  approvedBy                                                            String?
  approvedAt                                                            DateTime?
  rejectionReason                                                       String?                  @db.Text
  substituteId                                                          String?
  createdAt                                                             DateTime                 @default(now())
  updatedAt                                                             DateTime
  employeeEmployeeLeavesId                                              String?
  employeeLeaveApproverId                                               String?
  companies                                                             companies                @relation(fields: [companyId], references: [id], onDelete: Cascade)
  hr_employees_hr_leave_requests_employeeEmployeeLeavesIdTohr_employees hr_employees?            @relation("hr_leave_requests_employeeEmployeeLeavesIdTohr_employees", fields: [employeeEmployeeLeavesId], references: [id])
  hr_employees_hr_leave_requests_employeeLeaveApproverIdTohr_employees  hr_employees?            @relation("hr_leave_requests_employeeLeaveApproverIdTohr_employees", fields: [employeeLeaveApproverId], references: [id])

  @@index([approvedBy])
  @@index([companyId])
  @@index([employeeEmployeeLeavesId], map: "hr_leave_requests_employeeEmployeeLeavesId_fkey")
  @@index([employeeLeaveApproverId], map: "hr_leave_requests_employeeLeaveApproverId_fkey")
  @@index([startDate])
  @@index([status])
  @@index([userId])
}

model hr_manual_deductions {
  id               String                      @id
  companyId        String
  employeeId       String
  type             hr_manual_deductions_type   @default(OTHER)
  category         String?
  amount           Decimal                     @db.Decimal(10, 2)
  reason           String                      @db.Text
  description      String?                     @db.Text
  date             DateTime                    @db.Date
  effectiveMonth   Int
  effectiveYear    Int
  status           hr_manual_deductions_status @default(PENDING)
  approvedBy       String?
  approvedAt       DateTime?
  rejectedBy       String?
  rejectedAt       DateTime?
  rejectionReason  String?                     @db.Text
  appliedToPayroll Boolean                     @default(false)
  payrollId        String?
  attachments      String?                     @db.Text
  notes            String?                     @db.Text
  createdBy        String
  createdAt        DateTime                    @default(now())
  updatedAt        DateTime
  companies        companies                   @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([createdBy])
  @@index([effectiveMonth, effectiveYear])
  @@index([employeeId])
  @@index([status])
}

model hr_payrolls {
  id                  String             @id
  companyId           String
  userId              String
  month               Int
  year                Int
  periodStart         DateTime           @db.Date
  periodEnd           DateTime           @db.Date
  baseSalary          Decimal            @db.Decimal(12, 2)
  workingDays         Int                @default(30)
  actualWorkDays      Int                @default(30)
  allowances          String?            @db.Text
  totalAllowances     Decimal            @default(0.00) @db.Decimal(12, 2)
  deductions          String?            @db.Text
  totalDeductions     Decimal            @default(0.00) @db.Decimal(12, 2)
  overtimeHours       Decimal            @default(0.00) @db.Decimal(5, 2)
  overtimeRate        Decimal            @default(1.50) @db.Decimal(3, 2)
  overtimeAmount      Decimal            @default(0.00) @db.Decimal(12, 2)
  bonuses             Decimal            @default(0.00) @db.Decimal(12, 2)
  bonusNotes          String?            @db.Text
  socialInsurance     Decimal            @default(0.00) @db.Decimal(12, 2)
  taxAmount           Decimal            @default(0.00) @db.Decimal(12, 2)
  grossSalary         Decimal            @db.Decimal(12, 2)
  netSalary           Decimal            @db.Decimal(12, 2)
  status              hr_payrolls_status @default(DRAFT)
  paidAt              DateTime?
  paymentMethod       String?
  paymentReference    String?
  notes               String?            @db.Text
  createdAt           DateTime           @default(now())
  updatedAt           DateTime
  absentDays          Int                @default(0)
  attendanceDeduction Decimal            @default(0.00) @db.Decimal(10, 2)
  latePenalty         Decimal            @default(0.00) @db.Decimal(12, 2)
  rewardDetails       String?            @db.Text
  rewards             String?            @db.Text
  totalRewards        Decimal            @default(0.00) @db.Decimal(12, 2)
  employeeRelId       String?
  companies           companies          @relation(fields: [companyId], references: [id], onDelete: Cascade)
  hr_employees        hr_employees?      @relation(fields: [employeeRelId], references: [id])

  @@unique([userId, month, year])
  @@index([companyId])
  @@index([employeeRelId], map: "hr_payrolls_employeeRelId_fkey")
  @@index([month, year])
  @@index([status])
  @@index([userId])
}

model hr_performance_reviews {
  id                                                                          String                        @id
  companyId                                                                   String
  reviewerId                                                                  String
  reviewPeriod                                                                String
  periodStart                                                                 DateTime                      @db.Date
  periodEnd                                                                   DateTime                      @db.Date
  overallRating                                                               Decimal                       @db.Decimal(3, 2)
  ratings                                                                     String?                       @db.Text
  goals                                                                       String?                       @db.Text
  goalsAchievement                                                            Decimal?                      @db.Decimal(5, 2)
  strengths                                                                   String?                       @db.Text
  improvements                                                                String?                       @db.Text
  reviewerComments                                                            String?                       @db.Text
  employeeComments                                                            String?                       @db.Text
  recommendations                                                             String?                       @db.Text
  status                                                                      hr_performance_reviews_status @default(DRAFT)
  submittedAt                                                                 DateTime?
  acknowledgedAt                                                              DateTime?
  createdAt                                                                   DateTime                      @default(now())
  updatedAt                                                                   DateTime
  userId                                                                      String?
  employeeEmployeeReviewsId                                                   String?
  employeeReviewerReviewsId                                                   String?
  companies                                                                   companies                     @relation(fields: [companyId], references: [id], onDelete: Cascade)
  hr_employees_hr_performance_reviews_employeeEmployeeReviewsIdTohr_employees hr_employees?                 @relation("hr_performance_reviews_employeeEmployeeReviewsIdTohr_employees", fields: [employeeEmployeeReviewsId], references: [id])
  hr_employees_hr_performance_reviews_employeeReviewerReviewsIdTohr_employees hr_employees?                 @relation("hr_performance_reviews_employeeReviewerReviewsIdTohr_employees", fields: [employeeReviewerReviewsId], references: [id])

  @@index([companyId])
  @@index([employeeEmployeeReviewsId], map: "hr_performance_reviews_employeeEmployeeReviewsId_fkey")
  @@index([employeeReviewerReviewsId], map: "hr_performance_reviews_employeeReviewerReviewsId_fkey")
  @@index([reviewerId])
  @@index([status])
  @@index([userId])
}

model hr_positions {
  id                                                       String          @id
  companyId                                                String
  departmentId                                             String?
  title                                                    String
  titleEn                                                  String?
  code                                                     String?
  description                                              String?         @db.Text
  level                                                    Int             @default(1)
  minSalary                                                Decimal?        @db.Decimal(12, 2)
  maxSalary                                                Decimal?        @db.Decimal(12, 2)
  requirements                                             String?         @db.Text
  responsibilities                                         String?         @db.Text
  isActive                                                 Boolean         @default(true)
  createdAt                                                DateTime        @default(now())
  updatedAt                                                DateTime
  hr_employees                                             hr_employees[]
  companies                                                companies       @relation(fields: [companyId], references: [id], onDelete: Cascade)
  hr_departments                                           hr_departments? @relation(fields: [departmentId], references: [id])
  hr_promotions_hr_promotions_fromPositionIdTohr_positions hr_promotions[] @relation("hr_promotions_fromPositionIdTohr_positions")
  hr_promotions_hr_promotions_toPositionIdTohr_positions   hr_promotions[] @relation("hr_promotions_toPositionIdTohr_positions")
  users                                                    users[]

  @@unique([companyId, code])
  @@index([companyId])
  @@index([departmentId])
}

model hr_promotions {
  id                                                      String               @id
  companyId                                               String
  fromPositionId                                          String?
  toPositionId                                            String
  fromPositionName                                        String?
  toPositionName                                          String
  fromSalary                                              Decimal?             @db.Decimal(12, 2)
  toSalary                                                Decimal?             @db.Decimal(12, 2)
  promotionDate                                           DateTime             @db.Date
  effectiveDate                                           DateTime             @db.Date
  reason                                                  String               @db.Text
  status                                                  hr_promotions_status @default(PENDING)
  approvedBy                                              String?
  approvedAt                                              DateTime?
  rejectedAt                                              DateTime?
  rejectionReason                                         String?              @db.Text
  notes                                                   String?              @db.Text
  createdAt                                               DateTime             @default(now())
  updatedAt                                               DateTime
  userId                                                  String?
  companies                                               companies            @relation(fields: [companyId], references: [id], onDelete: Cascade)
  hr_positions_hr_promotions_fromPositionIdTohr_positions hr_positions?        @relation("hr_promotions_fromPositionIdTohr_positions", fields: [fromPositionId], references: [id])
  hr_positions_hr_promotions_toPositionIdTohr_positions   hr_positions         @relation("hr_promotions_toPositionIdTohr_positions", fields: [toPositionId], references: [id])

  @@index([companyId])
  @@index([fromPositionId])
  @@index([promotionDate])
  @@index([toPositionId])
  @@index([userId])
}

model hr_resignations {
  id                      String                    @id
  companyId               String
  resignationDate         DateTime                  @db.Date
  lastWorkingDay          DateTime                  @db.Date
  reason                  String?                   @db.Text
  exitInterview           String?                   @db.Text
  status                  String                    @default("PENDING")
  approvedBy              String?
  approvedAt              DateTime?
  createdAt               DateTime                  @default(now())
  updatedAt               DateTime
  actualLastDay           DateTime?                 @db.Date
  clearanceCompleted      Boolean                   @default(false)
  expectedLastDay         DateTime?                 @db.Date
  finalSettlement         Decimal?                  @db.Decimal(10, 2)
  noticePeriodDays        Int?
  settlementPaid          Boolean                   @default(false)
  userId                  String?
  employeeRelId           String?
  hr_clearance_checklists hr_clearance_checklists[]
  companies               companies                 @relation(fields: [companyId], references: [id], onDelete: Cascade)
  hr_employees            hr_employees?             @relation(fields: [employeeRelId], references: [id])

  @@index([companyId])
  @@index([employeeRelId], map: "hr_resignations_employeeRelId_fkey")
  @@index([status])
  @@index([userId])
}

model hr_reward_eligibility_logs {
  id                 String    @id
  companyId          String
  userId             String
  rewardTypeId       String
  evaluationDate     DateTime  @default(now())
  periodStart        DateTime  @db.Date
  periodEnd          DateTime  @db.Date
  isEligible         Boolean
  eligibilityDetails String?   @db.Text
  conditionsChecked  String?   @db.Text
  createdAt          DateTime  @default(now())
  companies          companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  users              users     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([evaluationDate])
  @@index([rewardTypeId])
  @@index([userId])
}

model hr_reward_records {
  id                  String                           @id
  companyId           String
  userId              String
  rewardTypeId        String?
  rewardName          String
  rewardCategory      hr_reward_records_rewardCategory
  calculatedValue     Decimal                          @db.Decimal(12, 2)
  calculationDetails  String?                          @db.Text
  periodStart         DateTime                         @db.Date
  periodEnd           DateTime                         @db.Date
  appliedMonth        Int
  appliedYear         Int
  reason              String?                          @db.Text
  eligibilityMet      String?                          @db.Text
  status              hr_reward_records_status         @default(PENDING)
  approvedBy          String?
  approvedAt          DateTime?
  appliedAt           DateTime?
  payrollId           String?
  isIncludedInPayroll Boolean                          @default(false)
  isLocked            Boolean                          @default(false)
  voidedBy            String?
  voidedAt            DateTime?
  voidReason          String?                          @db.Text
  createdAt           DateTime                         @default(now())
  updatedAt           DateTime
  companies           companies                        @relation(fields: [companyId], references: [id], onDelete: Cascade)
  hr_reward_types     hr_reward_types?                 @relation(fields: [rewardTypeId], references: [id])
  users               users                            @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([appliedMonth, appliedYear])
  @@index([companyId])
  @@index([rewardTypeId])
  @@index([status])
  @@index([userId])
}

model hr_reward_settings {
  id                         String    @id
  companyId                  String    @unique
  allowRewardDeductionOffset Boolean   @default(false)
  applyRewardsBeforeTax      Boolean   @default(true)
  autoEvaluationEnabled      Boolean   @default(true)
  evaluationDayOfMonth       Int       @default(1)
  requireManagerApproval     Boolean   @default(false)
  requireHRApproval          Boolean   @default(true)
  notifyEmployeeOnReward     Boolean   @default(true)
  notifyManagerOnReward      Boolean   @default(true)
  createdAt                  DateTime  @default(now())
  updatedAt                  DateTime
  companies                  companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
}

model hr_reward_types {
  id                    String                            @id
  companyId             String
  name                  String
  nameAr                String?
  description           String?                           @db.Text
  category              hr_reward_types_category
  calculationMethod     hr_reward_types_calculationMethod
  value                 Decimal                           @db.Decimal(12, 2)
  maxCap                Decimal?                          @db.Decimal(12, 2)
  eligibilityConditions String?                           @db.Text
  triggerType           hr_reward_types_triggerType
  frequency             hr_reward_types_frequency
  isActive              Boolean                           @default(true)
  priority              Int                               @default(1)
  effectiveFrom         DateTime?                         @db.Date
  effectiveTo           DateTime?                         @db.Date
  createdBy             String
  createdAt             DateTime                          @default(now())
  updatedAt             DateTime
  hr_reward_records     hr_reward_records[]
  companies             companies                         @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([category])
  @@index([companyId])
  @@index([isActive])
}

model hr_salary_history {
  id               String        @id
  companyId        String
  previousSalary   Decimal       @db.Decimal(12, 2)
  newSalary        Decimal       @db.Decimal(12, 2)
  changeType       String
  changePercentage Decimal?      @db.Decimal(5, 2)
  effectiveDate    DateTime      @db.Date
  reason           String?       @db.Text
  approvedBy       String?
  createdAt        DateTime      @default(now())
  userId           String
  employeeRelId    String?
  companies        companies     @relation(fields: [companyId], references: [id], onDelete: Cascade)
  hr_employees     hr_employees? @relation(fields: [employeeRelId], references: [id])

  @@index([companyId])
  @@index([employeeRelId], map: "hr_salary_history_employeeRelId_fkey")
  @@index([userId])
}

model hr_settings {
  id                            String    @id
  companyId                     String    @unique
  workDays                      String    @default("[1,2,3,4,5]")
  annualLeaveDefault            Int       @default(21)
  sickLeaveDefault              Int       @default(15)
  carryOverLimit                Int       @default(5)
  maxAdvancePercentage          Float     @default(50)
  maxActiveAdvances             Int       @default(1)
  minMonthsForAdvance           Int       @default(3)
  advanceRepaymentMonths        Int       @default(6)
  noticePeriodDays              Int       @default(30)
  requireClearance              Boolean   @default(true)
  clearanceItems                String?   @db.Text
  monthlyLateLimit              Int       @default(3)
  lateGracePeriod               Int       @default(15)
  earlyLeaveGracePeriod         Int       @default(15)
  lateWarningThreshold          Int       @default(3)
  lateWarningLevels             String?   @db.Text
  autoDeductionEnabled          Boolean   @default(false)
  gracePeriodMinutes            Int       @default(60)
  lateThresholdMinutes          Int       @default(10)
  maxDailyDeductionDays         Decimal   @default(1.0) @db.Decimal(3, 1)
  earlyCheckoutEnabled          Boolean   @default(true)
  earlyCheckoutThresholdMinutes Int       @default(0)
  firstViolationMultiplier      Decimal   @default(1.0) @db.Decimal(3, 1)
  secondViolationMultiplier     Decimal   @default(2.0) @db.Decimal(3, 1)
  thirdViolationMultiplier      Decimal   @default(3.0) @db.Decimal(3, 1)
  notifyAtPercentage            Int       @default(75)
  notifyOnDeduction             Boolean   @default(true)
  notifyOnGraceReset            Boolean   @default(true)
  deductionCalculationMethod    String    @default("minute")
  workingDaysPerMonth           Int       @default(22)
  workingHoursPerDay            Int       @default(8)
  requireDeductionReview        Boolean   @default(true)
  absencePenaltyRate            Decimal   @default(1.0) @db.Decimal(3, 1)
  delayPenaltyTiers             String?   @db.Text
  geofenceEnabled               Boolean   @default(false)
  officeLatitude                Decimal?  @db.Decimal(10, 8)
  officeLongitude               Decimal?  @db.Decimal(11, 8)
  geofenceRadius                Int?      @default(200)
  payrollDay                    Int       @default(25)
  overtimeMinHours              Decimal   @default(1.0) @db.Decimal(3, 1)
  overtimeRate                  Decimal   @default(1.50) @db.Decimal(3, 2)
  socialInsuranceRate           Decimal   @default(14.00) @db.Decimal(5, 2)
  taxRate                       Decimal   @default(0.00) @db.Decimal(5, 2)
  taxBrackets                   String?   @db.Text
  publicHolidays                String?   @db.Text
  createdAt                     DateTime  @default(now())
  updatedAt                     DateTime
  companies                     companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
}

model hr_shift_assignments {
  id            String        @id
  companyId     String
  shiftId       String
  date          DateTime      @db.Date
  notes         String?       @db.Text
  createdAt     DateTime      @default(now())
  updatedAt     DateTime
  userId        String?
  employeeRelId String?
  companies     companies     @relation(fields: [companyId], references: [id], onDelete: Cascade)
  hr_employees  hr_employees? @relation(fields: [employeeRelId], references: [id])
  hr_shifts     hr_shifts     @relation(fields: [shiftId], references: [id], onDelete: Cascade)
  users         users?        @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, shiftId, date])
  @@index([companyId])
  @@index([date])
  @@index([employeeRelId], map: "hr_shift_assignments_employeeRelId_fkey")
  @@index([shiftId])
  @@index([userId])
}

model hr_shifts {
  id                   String                 @id
  companyId            String
  name                 String
  startTime            String
  endTime              String
  breakDuration        Int                    @default(60)
  color                String?                @default("#3B82F6")
  isActive             Boolean                @default(true)
  createdAt            DateTime               @default(now())
  updatedAt            DateTime
  hr_shift_assignments hr_shift_assignments[]
  companies            companies              @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
}

model image_gallery {
  id        String    @id
  userId    String
  companyId String
  filename  String
  fileUrl   String
  fileType  String
  fileSize  Int
  createdAt DateTime  @default(now())
  updatedAt DateTime
  companies companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  users     users     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([createdAt])
  @@index([userId])
}

model image_studio_history {
  id           String    @id
  companyId    String
  userId       String
  prompt       String    @db.Text
  modelType    String
  modelName    String
  imageUrl     String?
  status       String    @default("pending")
  errorMessage String?   @db.Text
  metadata     String?   @db.Text
  createdAt    DateTime  @default(now())
  updatedAt    DateTime
  companies    companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  users        users     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([createdAt])
  @@index([status])
  @@index([userId])
}

model image_studio_settings {
  id                  String   @id
  enabled             Boolean  @default(true)
  basicModelName      String   @default("gemini-2.5-flash-image")
  proModelName        String   @default("gemini-3-pro-image-preview")
  defaultModel        String   @default("basic")
  maxImagesPerRequest Int      @default(1)
  maxRequestsPerDay   Int      @default(50)
  allowedCompanies    String?  @db.Text
  createdAt           DateTime @default(now())
  updatedAt           DateTime
  selectedKeyId       String?
}

model image_studio_usage {
  id               String    @id
  companyId        String
  date             DateTime  @db.Date
  basicImagesCount Int       @default(0)
  proImagesCount   Int       @default(0)
  totalImagesCount Int       @default(0)
  createdAt        DateTime  @default(now())
  updatedAt        DateTime
  companies        companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, date])
  @@index([companyId])
  @@index([date])
}

model integrations {
  id          String    @id
  name        String
  type        String
  platform    String
  externalId  String
  accessToken String?   @db.Text
  config      String    @db.Text
  settings    String?   @db.Text
  status      String    @default("ACTIVE")
  isActive    Boolean   @default(true)
  lastSyncAt  DateTime?
  companyId   String
  createdAt   DateTime  @default(now())
  updatedAt   DateTime
  companies   companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, platform, externalId])
}

model inventory {
  id              String     @id
  productId       String
  warehouseId     String
  quantity        Int        @default(0)
  reserved        Int        @default(0)
  available       Int        @default(0)
  minStock        Int        @default(0)
  maxStock        Int?
  reorderPoint    Int        @default(0)
  reorderQuantity Int        @default(0)
  cost            Decimal?   @db.Decimal(10, 2)
  createdAt       DateTime   @default(now())
  updatedAt       DateTime
  batchNumber     String?
  expiryDate      DateTime?
  products        products   @relation(fields: [productId], references: [id], onDelete: Cascade)
  warehouses      warehouses @relation(fields: [warehouseId], references: [id], onDelete: Cascade)

  @@unique([productId, warehouseId, batchNumber])
  @@index([productId])
  @@index([warehouseId])
}

model invoice_items {
  id          String   @id
  invoiceId   String
  description String
  quantity    Float    @default(1)
  unitPrice   Float
  totalPrice  Float
  metadata    String?  @db.LongText
  createdAt   DateTime @default(now())
  invoices    invoices @relation(fields: [invoiceId], references: [id], onDelete: Cascade)

  @@index([invoiceId])
}

model invoices {
  id               String             @id
  invoiceNumber    String             @unique
  subscriptionId   String?
  companyId        String
  status           invoices_status    @default(DRAFT)
  type             invoices_type      @default(SUBSCRIPTION)
  issueDate        DateTime           @default(now())
  dueDate          DateTime
  paidDate         DateTime?
  subtotal         Float
  taxAmount        Float              @default(0)
  discountAmount   Float              @default(0)
  totalAmount      Float
  currency         String             @default("EGP")
  notes            String?
  paymentTerms     String?            @default("Net 30")
  metadata         String?            @db.LongText
  createdAt        DateTime           @default(now())
  updatedAt        DateTime
  invoice_items    invoice_items[]
  companies        companies          @relation(fields: [companyId], references: [id], onDelete: Cascade)
  subscriptions    subscriptions?     @relation(fields: [subscriptionId], references: [id])
  payment_receipts payment_receipts[]
  payments         payments[]

  @@index([companyId])
  @@index([subscriptionId])
}

model knowledge_base {
  id        String   @id
  title     String
  content   String
  category  String
  tags      String?
  isActive  Boolean  @default(true)
  priority  Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime

  @@index([category])
  @@index([isActive])
}

model lateness_allowances {
  id                    String    @id
  companyId             String
  userId                String
  year                  Int
  month                 Int
  totalAllowanceMinutes Int       @default(60)
  usedMinutes           Int       @default(0)
  remainingMinutes      Int       @default(60)
  resetDate             DateTime
  isActive              Boolean   @default(true)
  createdAt             DateTime  @default(now())
  updatedAt             DateTime
  companies             companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  users                 users     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, year, month])
  @@index([companyId])
  @@index([userId])
}

model lateness_deductions {
  id                   String            @id
  companyId            String
  userId               String
  latenessRecordId     String?
  deductionType        String            @default("FINANCIAL")
  deductionReason      String
  violationDate        DateTime          @db.Date
  violationDescription String?           @db.Text
  latenessMinutes      Int?
  financialAmount      Decimal?          @db.Decimal(10, 2)
  timeDeductionMinutes Int?
  timeDeductionHours   Decimal?          @db.Decimal(5, 2)
  warningLevel         Int?
  warningMessage       String?           @db.Text
  isAppliedToPayroll   Boolean           @default(false)
  payrollId            String?
  requiresApproval     Boolean           @default(false)
  approvedBy           String?
  approvedAt           DateTime?
  createdAt            DateTime          @default(now())
  updatedAt            DateTime
  companies            companies         @relation(fields: [companyId], references: [id], onDelete: Cascade)
  lateness_records     lateness_records? @relation(fields: [latenessRecordId], references: [id])
  users                users             @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([latenessRecordId])
  @@index([userId])
  @@index([violationDate])
}

model lateness_monthly_summaries {
  id                        String    @id
  companyId                 String
  userId                    String
  year                      Int
  month                     Int
  totalAllowanceMinutes     Int       @default(0)
  usedAllowanceMinutes      Int       @default(0)
  remainingAllowanceMinutes Int       @default(0)
  totalLateDays             Int       @default(0)
  totalLatenessMinutes      Int       @default(0)
  gracePeriodDays           Int       @default(0)
  violationDays             Int       @default(0)
  totalFinancialDeductions  Decimal   @default(0.00) @db.Decimal(10, 2)
  totalTimeDeductions       Int       @default(0)
  totalWarnings             Int       @default(0)
  totalWorkDays             Int       @default(0)
  presentDays               Int       @default(0)
  absentDays                Int       @default(0)
  reportGenerated           Boolean   @default(false)
  reportGeneratedAt         DateTime?
  createdAt                 DateTime  @default(now())
  updatedAt                 DateTime
  companies                 companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  users                     users     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, year, month])
  @@index([companyId])
  @@index([userId])
}

model lateness_records {
  id                       String                @id
  companyId                String
  userId                   String
  attendanceId             String?
  date                     DateTime              @db.Date
  checkInTime              DateTime
  expectedStartTime        DateTime
  latestAllowedTime        DateTime
  latenessMinutes          Int                   @default(0)
  latenessCategory         String                @default("ON_TIME")
  allowanceUsedMinutes     Int                   @default(0)
  allowanceRemainingBefore Int                   @default(0)
  allowanceRemainingAfter  Int                   @default(0)
  excessMinutes            Int                   @default(0)
  isViolation              Boolean               @default(false)
  violationReason          String?               @db.Text
  isProcessed              Boolean               @default(false)
  processedAt              DateTime?
  processedBy              String?
  deductionApplied         Boolean               @default(false)
  createdAt                DateTime              @default(now())
  updatedAt                DateTime
  lateness_deductions      lateness_deductions[]
  companies                companies             @relation(fields: [companyId], references: [id], onDelete: Cascade)
  users                    users                 @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([date])
  @@index([userId])
}

model lateness_rules {
  id                               String    @id
  companyId                        String    @unique
  workStartTime                    String    @default("10:00")
  latestAllowedTime                String    @default("10:10")
  monthlyAllowanceMinutes          Int       @default(60)
  allowanceResetDay                Int       @default(5)
  autoApplyDeductions              Boolean   @default(true)
  autoResetAllowances              Boolean   @default(true)
  violationDeductionType           String    @default("FINANCIAL")
  violationFinancialAmount         Decimal?  @db.Decimal(10, 2)
  violationTimeMinutes             Int?
  violationWarningLevel            Int?
  allowanceExceededDeductionType   String    @default("FINANCIAL")
  allowanceExceededFinancialAmount Decimal?  @db.Decimal(10, 2)
  allowanceExceededTimeMinutes     Int?
  allowanceExceededWarningLevel    Int?
  missingAttendanceDeductionType   String    @default("FINANCIAL")
  missingAttendanceFinancialAmount Decimal?  @db.Decimal(10, 2)
  missingAttendanceTimeMinutes     Int?
  createdAt                        DateTime  @default(now())
  updatedAt                        DateTime
  companies                        companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
}

model learning_data {
  id             String    @id
  companyId      String
  customerId     String?
  conversationId String?
  type           String
  data           String?   @db.Text
  userMessage    String?   @db.Text
  aiResponse     String?   @db.Text
  intent         String?
  sentiment      String?
  processingTime Int?
  ragDataUsed    Boolean   @default(false)
  memoryUsed     Boolean   @default(false)
  model          String?
  confidence     Float?
  outcome        String?
  feedback       String?   @db.Text
  insights       String?   @db.Text
  metadata       String?   @db.Text
  createdAt      DateTime  @default(now())
  companies      companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([confidence])
  @@index([createdAt])
  @@index([intent])
  @@index([type])
}

model learning_settings {
  id                    String    @id
  companyId             String    @unique
  enabled               Boolean   @default(true)
  learningSpeed         String    @default("medium")
  autoApplyImprovements Boolean   @default(false)
  dataRetentionDays     Int       @default(90)
  minimumSampleSize     Int       @default(50)
  confidenceThreshold   Float     @default(0.8)
  settings              String?   @db.Text
  createdAt             DateTime  @default(now())
  updatedAt             DateTime
  companies             companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
}

model marketplace_apps {
  id                String              @id
  slug              String              @unique
  name              String
  description       String              @db.Text
  logo              String?
  images            String?             @db.LongText
  monthlyPrice      Decimal             @db.Decimal(10, 2)
  yearlyPrice       Decimal             @db.Decimal(10, 2)
  features          String?             @db.LongText
  isActive          Boolean             @default(true)
  isPublic          Boolean             @default(true)
  isFeatured        Boolean             @default(false)
  createdAt         DateTime            @default(now())
  updatedAt         DateTime
  mainRoute         String?
  adminRoute        String?
  category          String              @default("general")
  icon              String?
  installCount      Int                 @default(0)
  isPopular         Boolean             @default(false)
  rating            Float               @default(0)
  requiredApps      String?             @db.LongText
  reviewCount       Int                 @default(0)
  trialDays         Int                 @default(14)
  app_pricing_rules app_pricing_rules[]
  app_reviews       app_reviews[]
  company_apps      company_apps[]
}

model media_files {
  id             String   @id
  conversationId String
  senderId       String
  fileName       String
  fileType       String
  fileSize       Int?
  fileUrl        String
  analysis       String?
  processed      Boolean  @default(false)
  createdAt      DateTime @default(now())

  @@index([conversationId])
  @@index([fileType])
}

model merchant_orders {
  id              String                 @id
  merchantId      String
  orderId         String                 @unique
  merchantOrderId String?
  status          merchant_orders_status @default(PENDING)
  items           String                 @db.Text
  totalAmount     Decimal                @db.Decimal(10, 2)
  shippingAddress String?                @db.Text
  trackingNumber  String?
  syncedAt        DateTime?
  fulfilledAt     DateTime?
  notes           String?                @db.Text
  createdAt       DateTime               @default(now())
  updatedAt       DateTime
  Merchant        Merchant               @relation(fields: [merchantId], references: [id], onDelete: Cascade)
  orders          orders                 @relation(fields: [orderId], references: [id], onDelete: Cascade)

  @@index([merchantId])
  @@index([orderId])
  @@index([status])
}

model merchant_products {
  id            String    @id
  merchantId    String
  productId     String
  merchantSku   String?
  merchantPrice Decimal   @db.Decimal(10, 2)
  stock         Int       @default(0)
  isActive      Boolean   @default(true)
  syncEnabled   Boolean   @default(true)
  lastSyncedAt  DateTime?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime
  Merchant      Merchant  @relation(fields: [merchantId], references: [id], onDelete: Cascade)
  products      products  @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@unique([merchantId, productId])
  @@index([merchantId])
  @@index([productId])
}

model messages {
  id             String        @id
  conversationId String
  senderId       String?
  type           messages_type @default(TEXT)
  content        String        @db.Text
  attachments    String?       @db.Text
  metadata       String?       @db.Text
  isFromCustomer Boolean       @default(true)
  isRead         Boolean       @default(false)
  readAt         DateTime?
  createdAt      DateTime      @default(now())
  updatedAt      DateTime
  conversations  conversations @relation(fields: [conversationId], references: [id], onDelete: Cascade)
  users          users?        @relation(fields: [senderId], references: [id])

  @@index([conversationId, createdAt])
  @@index([conversationId])
  @@index([conversationId, isFromCustomer, createdAt])
  @@index([createdAt])
  @@index([isFromCustomer])
  @@index([senderId])
}

model notifications {
  id        String    @id
  title     String
  message   String
  type      String
  data      String?   @db.LongText
  isRead    Boolean   @default(false)
  readAt    DateTime?
  createdAt DateTime  @default(now())
  userId    String?
  companyId String
  companies companies @relation(fields: [companyId], references: [id])
  users     users?    @relation(fields: [userId], references: [id])

  @@index([companyId])
  @@index([userId])
}

model order_invoice_settings {
  id                     String    @id
  companyId              String    @unique
  autoGenerate           Boolean   @default(false)
  autoGenerateOnStatus   String?
  invoicePrefix          String    @default("INV")
  invoiceNumberFormat    String    @default("INV-YYYYMMDD-XXXXXX")
  nextInvoiceNumber      Int       @default(1)
  defaultTaxRate         Float     @default(0)
  defaultTerms           String?   @db.Text
  defaultNotes           String?   @db.Text
  defaultDueDays         Int       @default(7)
  showCompanyLogo        Boolean   @default(true)
  showTaxBreakdown       Boolean   @default(true)
  showPaymentMethod      Boolean   @default(true)
  showOrderItems         Boolean   @default(true)
  autoEmailToCustomer    Boolean   @default(false)
  emailSubject           String?
  emailBody              String?   @db.Text
  pdfPageSize            String    @default("A4")
  pdfOrientation         String    @default("portrait")
  primaryColor           String    @default("#4F46E5")
  secondaryColor         String    @default("#6B7280")
  fontFamily             String    @default("Arial")
  createdAt              DateTime  @default(now())
  updatedAt              DateTime
  enableSequentialOrders Boolean   @default(false)
  nextOrderNumber        Int       @default(1)
  orderNumberFormat      String    @default("PREFIX-XXXXXX")
  orderPrefix            String    @default("ORD")
  companies              companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
}

model order_invoices {
  id              String    @id
  invoiceNumber   String    @unique
  orderId         String    @unique
  companyId       String
  issueDate       DateTime  @default(now())
  dueDate         DateTime?
  subtotal        Decimal   @db.Decimal(10, 2)
  tax             Decimal   @default(0.00) @db.Decimal(10, 2)
  taxRate         Float     @default(0)
  shipping        Decimal   @default(0.00) @db.Decimal(10, 2)
  discount        Decimal   @default(0.00) @db.Decimal(10, 2)
  totalAmount     Decimal   @db.Decimal(10, 2)
  currency        String    @default("EGP")
  customerName    String
  customerPhone   String?
  customerEmail   String?
  customerAddress String?   @db.Text
  city            String?
  governorate     String?
  companyName     String
  companyPhone    String?
  companyEmail    String?
  companyAddress  String?   @db.Text
  companyLogo     String?
  paymentMethod   String?
  paymentStatus   String    @default("PENDING")
  paidAt          DateTime?
  notes           String?   @db.Text
  terms           String?   @db.Text
  generatedBy     String?
  printedAt       DateTime?
  printCount      Int       @default(0)
  emailedAt       DateTime?
  emailCount      Int       @default(0)
  createdAt       DateTime  @default(now())
  updatedAt       DateTime
  orders          orders    @relation(fields: [orderId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([invoiceNumber])
  @@index([issueDate])
  @@index([orderId])
  @@index([paymentStatus])
}

model order_items {
  id               String            @id
  orderId          String
  productId        String?
  quantity         Int
  price            Decimal           @db.Decimal(10, 2)
  total            Decimal           @db.Decimal(10, 2)
  productName      String?
  productColor     String?
  productSize      String?
  productSku       String?
  metadata         String?           @db.Text
  variantId        String?
  extractionSource String?           @default("ai")
  confidence       Float?
  productImage     String?
  productDetails   String?
  basePrice        Decimal?          @db.Decimal(10, 2)
  merchantPrice    Decimal?          @db.Decimal(10, 2)
  orders           orders            @relation(fields: [orderId], references: [id], onDelete: Cascade)
  products         products?         @relation(fields: [productId], references: [id], onDelete: Cascade)
  product_variants product_variants? @relation(fields: [variantId], references: [id])

  @@index([orderId])
  @@index([productId])
  @@index([variantId])
}

model order_notes {
  id           String        @id
  content      String        @db.Text
  orderId      String?
  guestOrderId String?
  authorId     String?
  authorName   String
  createdAt    DateTime      @default(now())
  users        users?        @relation(fields: [authorId], references: [id])
  guest_orders guest_orders? @relation(fields: [guestOrderId], references: [id])
  orders       orders?       @relation(fields: [orderId], references: [id])

  @@index([authorId])
  @@index([guestOrderId])
  @@index([orderId])
}

model order_status_configs {
  id                  String    @id
  companyId           String
  code                String
  name                String
  nameEn              String?
  description         String?   @db.Text
  color               String    @default("#6B7280")
  icon                String?
  sortOrder           Int       @default(0)
  statusType          String    @default("order")
  source              String    @default("system")
  isSystemStatus      Boolean   @default(false)
  isActive            Boolean   @default(true)
  mapsToSystem        String?
  wooCommerceStatus   String?
  allowedNextStatuses String?   @db.Text
  autoActions         String?   @db.Text
  notifyCustomer      Boolean   @default(false)
  notifyAdmin         Boolean   @default(false)
  emailTemplate       String?   @db.Text
  smsTemplate         String?   @db.Text
  createdAt           DateTime  @default(now())
  updatedAt           DateTime
  companies           companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, code])
  @@index([companyId])
  @@index([source])
  @@index([statusType])
}

model orders {
  id                            String                       @id
  orderNumber                   String
  customerId                    String
  conversationId                String?
  status                        orders_status                @default(PENDING)
  isViewed                      Boolean                      @default(false)
  paymentStatus                 orders_paymentStatus         @default(PENDING)
  paymentMethod                 orders_paymentMethod         @default(CASH)
  subtotal                      Decimal                      @db.Decimal(10, 2)
  tax                           Decimal                      @default(0.00) @db.Decimal(10, 2)
  shipping                      Decimal                      @default(0.00) @db.Decimal(10, 2)
  discount                      Decimal                      @default(0.00) @db.Decimal(10, 2)
  total                         Decimal                      @db.Decimal(10, 2)
  currency                      String                       @default("EGP")
  notes                         String?
  shippingAddress               String?                      @db.Text
  billingAddress                String?                      @db.Text
  customerName                  String?
  customerPhone                 String?
  customerEmail                 String?
  city                          String?
  governorate                   String?
  customerAddress               String?
  dataQuality                   String?                      @db.Text
  extractionMethod              String?                      @default("ai_enhanced")
  confidence                    Float?
  validationStatus              String?                      @default("pending")
  sourceType                    String?                      @default("ai_conversation")
  extractionTimestamp           DateTime?
  metadata                      String?                      @db.Text
  companyId                     String
  createdAt                     DateTime                     @default(now())
  updatedAt                     DateTime
  lastSyncAt                    DateTime?
  syncedFromWoo                 Boolean                      @default(false)
  syncedToWoo                   Boolean                      @default(false)
  wooCommerceDateCreated        DateTime?
  wooCommerceId                 String?
  wooCommerceOrderKey           String?
  wooCommerceStatus             String?
  wooCommerceUrl                String?
  turboBranchId                 String?
  turboLabelUrl                 String?
  turboMetadata                 String?                      @db.Text
  turboShipmentId               String?
  turboShipmentStatus           String?
  turboTrackingNumber           String?
  callAttempts                  Int                          @default(0)
  lastCallAttemptAt             DateTime?
  scheduledDeliveryDate         DateTime?
  isScheduled                   Boolean                      @default(false)
  scheduledNotes                String?                      @db.Text
  autoTransitionEnabled         Boolean                      @default(true)
  scheduledTransitionedAt       DateTime?
  affiliateReferralId           String?                      @unique
  affiliateId                   String?
  merchantOrderId               String?                      @unique
  isDropshipped                 Boolean                      @default(false)
  orderSource                   orders_orderSource           @default(REGULAR)
  createdBy                     String?
  createdByName                 String?
  userRelId                     String?
  OrderStatusHistory            OrderStatusHistory[]
  affiliate_referrals           affiliate_referrals?
  call_attempt_logs             call_attempt_logs[]
  commissions                   commissions[]
  conversion_events             conversion_events[]
  merchant_orders               merchant_orders?
  order_invoices                order_invoices?
  order_items                   order_items[]
  order_notes                   order_notes[]
  affiliates                    affiliates?                  @relation(fields: [affiliateId], references: [id])
  companies                     companies                    @relation(fields: [companyId], references: [id], onDelete: Cascade)
  conversations                 conversations?               @relation(fields: [conversationId], references: [id])
  users_orders_createdByTousers users?                       @relation("orders_createdByTousers", fields: [createdBy], references: [id])
  customers                     customers                    @relation(fields: [customerId], references: [id], onDelete: Cascade)
  users_orders_userRelIdTousers users?                       @relation("orders_userRelIdTousers", fields: [userRelId], references: [id])
  return_requests               return_requests[]
  wallet_transactions           wallet_transactions[]
  whatsapp_notification_logs    whatsapp_notification_logs[]

  @@unique([companyId, orderNumber])
  @@index([affiliateId])
  @@index([companyId])
  @@index([conversationId])
  @@index([createdBy])
  @@index([customerId])
  @@index([isScheduled])
  @@index([orderSource])
  @@index([scheduledDeliveryDate])
  @@index([turboTrackingNumber])
  @@index([userRelId], map: "orders_userRelId_fkey")
  @@index([wooCommerceId])
}

model page_response_settings {
  id                    String    @id
  pageId                String
  companyId             String
  responseMethod        String
  fixedMessengerMessage String?   @db.Text
  aiPrompt              String?   @db.Text
  createdAt             DateTime  @default(now())
  updatedAt             DateTime
  commentMessages       String?   @db.Text
  companies             companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([pageId, companyId])
  @@index([companyId])
  @@index([pageId])
}

model payment_receipts {
  id             String         @id
  invoiceId      String
  walletNumberId String
  receiptImage   String
  status         String         @default("PENDING")
  submittedAt    DateTime       @default(now())
  reviewedAt     DateTime?
  reviewedBy     String?
  notes          String?
  createdAt      DateTime       @default(now())
  updatedAt      DateTime
  invoices       invoices       @relation(fields: [invoiceId], references: [id], onDelete: Cascade)
  wallet_numbers wallet_numbers @relation(fields: [walletNumberId], references: [id], onDelete: Cascade)

  @@index([invoiceId])
  @@index([walletNumberId])
}

model payments {
  id               String          @id
  paymentNumber    String          @unique
  invoiceId        String?
  subscriptionId   String?
  companyId        String
  amount           Float
  currency         String          @default("EGP")
  status           payments_status @default(PENDING)
  method           payments_method @default(BANK_TRANSFER)
  gateway          String?
  gatewayPaymentId String?
  transactionId    String?
  paidAt           DateTime?
  failedAt         DateTime?
  failureReason    String?
  metadata         String?         @db.LongText
  createdAt        DateTime        @default(now())
  updatedAt        DateTime
  companies        companies       @relation(fields: [companyId], references: [id], onDelete: Cascade)
  invoices         invoices?       @relation(fields: [invoiceId], references: [id])
  subscriptions    subscriptions?  @relation(fields: [subscriptionId], references: [id])

  @@index([companyId])
  @@index([invoiceId])
  @@index([subscriptionId])
}

model plan_configurations {
  id            String      @id
  planType      String      @unique
  price         Float
  currency      String      @default("EGP")
  billingCycle  String      @default("monthly")
  features      String      @db.LongText
  description   String?
  descriptionEn String?
  isActive      Boolean     @default(true)
  createdAt     DateTime    @default(now())
  updatedAt     DateTime
  companies     companies[]
}

model policies {
  id                   String    @id
  companyId            String
  title                String
  content              String    @db.Text
  category             String    @default("general")
  tags                 String?   @db.Text
  order                Int       @default(0)
  isActive             Boolean   @default(true)
  version              Int       @default(1)
  effectiveAt          DateTime  @default(now())
  expiresAt            DateTime?
  createdAt            DateTime  @default(now())
  updatedAt            DateTime
  embedding            String?   @db.Text
  embeddingGeneratedAt DateTime?
  companies            companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([category])
  @@index([companyId])
  @@index([companyId, isActive, effectiveAt])
  @@index([isActive])
}

model post_response_settings {
  id                    String    @id
  postId                String
  companyId             String
  responseMethod        String
  createdAt             DateTime  @default(now())
  updatedAt             DateTime
  aiPrompt              String?   @db.Text
  fixedMessengerMessage String?   @db.Text
  commentMessages       String?   @db.Text
  featuredProductId     String?
  companies             companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  products              products? @relation(fields: [featuredProductId], references: [id])

  @@unique([postId, companyId])
  @@index([companyId])
  @@index([featuredProductId])
  @@index([postId])
}

model post_tracking {
  id           String    @id
  postId       String
  companyId    String
  visitCount   Int       @default(1)
  firstVisitAt DateTime  @default(now())
  lastVisitAt  DateTime  @default(now())
  createdAt    DateTime  @default(now())
  updatedAt    DateTime
  companies    companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([postId, companyId])
  @@index([companyId])
  @@index([lastVisitAt])
  @@index([postId])
}

model product_analytics {
  id              String    @id
  productId       String
  companyId       String
  date            DateTime  @db.Date
  views           Int       @default(0)
  uniqueViews     Int       @default(0)
  addToCarts      Int       @default(0)
  purchases       Int       @default(0)
  revenue         Decimal   @default(0.00) @db.Decimal(10, 2)
  conversionRate  Decimal   @default(0.00) @db.Decimal(5, 2)
  avgViewDuration Int       @default(0)
  companies       companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  products        products  @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@unique([companyId, productId, date])
  @@index([companyId, date])
  @@index([productId, companyId])
}

model product_reviews {
  id            String    @id
  productId     String
  companyId     String
  customerName  String
  customerEmail String?
  customerPhone String?
  rating        Int
  title         String?
  comment       String?   @db.Text
  isVerified    Boolean   @default(false)
  isApproved    Boolean   @default(false)
  helpfulCount  Int       @default(0)
  createdAt     DateTime  @default(now())
  updatedAt     DateTime
  companies     companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  products      products  @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([isApproved])
  @@index([productId])
  @@index([rating])
}

model product_variants {
  id             String        @id
  productId      String
  name           String
  type           String        @default("color")
  sku            String?
  price          Decimal?      @db.Decimal(10, 2)
  comparePrice   Decimal?      @db.Decimal(10, 2)
  cost           Decimal?      @db.Decimal(10, 2)
  images         String?       @db.Text
  stock          Int           @default(0)
  trackInventory Boolean       @default(true)
  isActive       Boolean       @default(true)
  sortOrder      Int           @default(0)
  metadata       String?       @db.Text
  createdAt      DateTime      @default(now())
  updatedAt      DateTime
  order_items    order_items[]
  products       products      @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@unique([productId, sku])
  @@index([productId])
  @@index([sku])
}

model product_visits {
  id          String    @id
  productId   String
  companyId   String
  sessionId   String
  visitedAt   DateTime  @default(now())
  duration    Int?
  source      String?
  addedToCart Boolean   @default(false)
  purchased   Boolean   @default(false)
  companies   companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  products    products  @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@index([companyId, productId, visitedAt])
  @@index([productId], map: "product_visits_productId_fkey")
  @@index([sessionId, companyId])
}

model products {
  id                          String                        @id
  name                        String
  description                 String?                       @db.Text
  sku                         String?
  price                       Decimal                       @db.Decimal(10, 2)
  comparePrice                Decimal?                      @db.Decimal(10, 2)
  cost                        Decimal?                      @db.Decimal(10, 2)
  images                      String?                       @db.Text
  stock                       Int                           @default(0)
  trackInventory              Boolean                       @default(true)
  weight                      Decimal?                      @db.Decimal(8, 2)
  dimensions                  String?                       @db.Text
  categoryId                  String?
  isActive                    Boolean                       @default(true)
  isFeatured                  Boolean                       @default(false)
  tags                        String?
  metadata                    String?                       @db.Text
  companyId                   String
  createdAt                   DateTime                      @default(now())
  updatedAt                   DateTime
  barcode                     String?
  easyOrdersId                String?
  easyOrdersUrl               String?
  source                      String?                       @default("manual")
  wooCommerceId               String?
  wooCommerceUrl              String?
  hasPromotedAd               Boolean                       @default(false)
  enableCheckoutForm          Boolean                       @default(true)
  showAddToCartButton         Boolean                       @default(true)
  saleStartDate               DateTime?
  saleEndDate                 DateTime?
  sizeGuide                   String?                       @db.Text
  isPreOrder                  Boolean                       @default(false)
  preOrderDate                DateTime?
  preOrderMessage             String?                       @db.Text
  embedding                   String?                       @db.Text
  embeddingGeneratedAt        DateTime?
  slug                        String?
  isDropshipped               Boolean                       @default(false)
  merchantProductId           String?
  basePrice                   Decimal?                      @db.Decimal(10, 2)
  allowAffiliateMarkup        Boolean                       @default(false)
  affiliateCommission         Decimal?                      @db.Decimal(10, 2)
  commissionType              String?                       @default("PERCENTAGE")
  affiliate_products          affiliate_products[]
  back_in_stock_notifications back_in_stock_notifications[]
  conversion_events           conversion_events[]
  facebook_catalog_products   facebook_catalog_products[]
  inventory                   inventory[]
  merchant_products           merchant_products[]
  order_items                 order_items[]
  post_response_settings      post_response_settings[]
  product_analytics           product_analytics[]
  product_reviews             product_reviews[]
  product_variants            product_variants[]
  product_visits              product_visits[]
  categories                  categories?                   @relation(fields: [categoryId], references: [id])
  companies                   companies                     @relation(fields: [companyId], references: [id], onDelete: Cascade)
  purchase_invoice_items      purchase_invoice_items[]
  purchase_order_items        purchase_order_items[]
  recently_viewed             recently_viewed[]
  stock_alerts                stock_alerts[]
  stock_movements             stock_movements[]
  whatsapp_notification_logs  whatsapp_notification_logs[]
  wishlists                   wishlists[]

  @@unique([companyId, sku])
  @@unique([companyId, slug])
  @@index([categoryId])
  @@index([companyId])
  @@index([sku])
  @@index([wooCommerceId])
}

model prompt_library {
  id             String   @id
  name           String
  nameAr         String?
  description    String   @db.Text
  descriptionAr  String?  @db.Text
  category       String
  businessType   String?
  promptContent  String   @db.Text
  responsePrompt String?  @db.Text
  variables      String?  @db.Text
  tags           String?  @db.Text
  icon           String?
  previewImage   String?
  isActive       Boolean  @default(true)
  isFeatured     Boolean  @default(false)
  usageCount     Int      @default(0)
  rating         Float    @default(0)
  sortOrder      Int      @default(0)
  createdBy      String?
  createdAt      DateTime @default(now())
  updatedAt      DateTime

  @@index([businessType])
  @@index([category])
  @@index([isActive])
  @@index([isFeatured])
}

model purchase_invoice_items {
  id                String            @id
  purchaseInvoiceId String
  productId         String?
  productName       String
  description       String?           @db.Text
  quantity          Decimal           @db.Decimal(10, 2)
  unitPrice         Decimal           @db.Decimal(12, 2)
  taxRate           Decimal           @default(0.00) @db.Decimal(5, 2)
  discountRate      Decimal           @default(0.00) @db.Decimal(5, 2)
  totalPrice        Decimal           @db.Decimal(12, 2)
  notes             String?           @db.Text
  createdAt         DateTime          @default(now())
  updatedAt         DateTime
  products          products?         @relation(fields: [productId], references: [id])
  purchase_invoices purchase_invoices @relation(fields: [purchaseInvoiceId], references: [id], onDelete: Cascade)

  @@index([productId])
  @@index([purchaseInvoiceId])
}

model purchase_invoices {
  id                     String                   @id
  companyId              String
  supplierId             String
  purchaseOrderId        String?
  invoiceNumber          String                   @unique
  invoiceDate            DateTime                 @default(now())
  dueDate                DateTime?
  status                 purchase_invoices_status @default(PENDING)
  subtotal               Decimal                  @db.Decimal(12, 2)
  taxAmount              Decimal                  @default(0.00) @db.Decimal(12, 2)
  discountAmount         Decimal                  @default(0.00) @db.Decimal(12, 2)
  shippingCost           Decimal                  @default(0.00) @db.Decimal(12, 2)
  totalAmount            Decimal                  @db.Decimal(12, 2)
  paidAmount             Decimal                  @default(0.00) @db.Decimal(12, 2)
  remainingAmount        Decimal                  @db.Decimal(12, 2)
  currency               String                   @default("EGP")
  notes                  String?                  @db.Text
  attachments            String?                  @db.Text
  createdBy              String
  createdAt              DateTime                 @default(now())
  updatedAt              DateTime
  purchase_invoice_items purchase_invoice_items[]
  companies              companies                @relation(fields: [companyId], references: [id], onDelete: Cascade)
  purchase_orders        purchase_orders?         @relation(fields: [purchaseOrderId], references: [id])
  suppliers              suppliers                @relation(fields: [supplierId], references: [id])
  supplier_payments      supplier_payments[]

  @@index([companyId])
  @@index([invoiceDate])
  @@index([purchaseOrderId])
  @@index([status])
  @@index([supplierId])
}

model purchase_order_items {
  id               String          @id
  purchaseOrderId  String
  productId        String?
  productName      String
  description      String?         @db.Text
  quantity         Decimal         @db.Decimal(10, 2)
  unitPrice        Decimal         @db.Decimal(12, 2)
  taxRate          Decimal         @default(0.00) @db.Decimal(5, 2)
  discountRate     Decimal         @default(0.00) @db.Decimal(5, 2)
  totalPrice       Decimal         @db.Decimal(12, 2)
  receivedQuantity Decimal         @default(0.00) @db.Decimal(10, 2)
  notes            String?         @db.Text
  createdAt        DateTime        @default(now())
  updatedAt        DateTime
  products         products?       @relation(fields: [productId], references: [id])
  purchase_orders  purchase_orders @relation(fields: [purchaseOrderId], references: [id], onDelete: Cascade)

  @@index([productId])
  @@index([purchaseOrderId])
}

model purchase_orders {
  id                   String                 @id
  companyId            String
  supplierId           String
  orderNumber          String                 @unique
  orderDate            DateTime               @default(now())
  expectedDelivery     DateTime?
  status               purchase_orders_status @default(DRAFT)
  subtotal             Decimal                @db.Decimal(12, 2)
  taxAmount            Decimal                @default(0.00) @db.Decimal(12, 2)
  discountAmount       Decimal                @default(0.00) @db.Decimal(12, 2)
  shippingCost         Decimal                @default(0.00) @db.Decimal(12, 2)
  totalAmount          Decimal                @db.Decimal(12, 2)
  currency             String                 @default("EGP")
  paymentTerms         String?                @db.Text
  notes                String?                @db.Text
  attachments          String?                @db.Text
  receivedDate         DateTime?
  approvedBy           String?
  approvedAt           DateTime?
  createdBy            String
  createdAt            DateTime               @default(now())
  updatedAt            DateTime
  purchase_invoices    purchase_invoices[]
  purchase_order_items purchase_order_items[]
  companies            companies              @relation(fields: [companyId], references: [id], onDelete: Cascade)
  suppliers            suppliers              @relation(fields: [supplierId], references: [id])

  @@index([companyId])
  @@index([orderDate])
  @@index([status])
  @@index([supplierId])
}

model rag_performance {
  id            String   @id
  companyId     String
  operation     String
  responseTime  Int
  tokensUsed    Int?
  cacheHit      Boolean  @default(false)
  errorOccurred Boolean  @default(false)
  errorMessage  String?  @db.Text
  metadata      String?  @db.Text
  createdAt     DateTime @default(now())

  @@index([companyId, createdAt])
  @@index([companyId])
  @@index([errorOccurred])
  @@index([operation])
}

model rag_rate_limits {
  id           String   @id
  companyId    String
  ipAddress    String?
  requestType  String   @default("search")
  requestCount Int      @default(1)
  windowStart  DateTime @default(now())
  createdAt    DateTime @default(now())
  updatedAt    DateTime

  @@unique([companyId, ipAddress, windowStart])
  @@index([companyId])
  @@index([ipAddress])
  @@index([windowStart])
}

model recently_viewed {
  id        String    @id
  sessionId String
  productId String
  companyId String
  viewedAt  DateTime  @default(now())
  companies companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  products  products  @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@unique([sessionId, productId, companyId])
  @@index([companyId])
  @@index([productId])
  @@index([sessionId, companyId])
  @@index([viewedAt])
}

model response_effectiveness {
  id                 String    @id
  companyId          String
  messageId          String?
  conversationId     String
  responseText       String    @db.Text
  responseType       String
  customerReaction   String?
  effectivenessScore Float
  leadToPurchase     Boolean   @default(false)
  responseTime       Int?
  wordCount          Int?
  sentimentScore     Float?
  keywords           String?   @db.Text
  metadata           String?   @db.Text
  createdAt          DateTime  @default(now())
  companies          companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([conversationId])
  @@index([createdAt])
  @@index([effectivenessScore])
  @@index([leadToPurchase])
  @@index([responseType])
}

model return_activity_logs {
  id              String          @id
  returnRequestId String
  userId          String?
  action          String
  details         String?         @db.Text
  createdAt       DateTime        @default(now())
  return_requests return_requests @relation(fields: [returnRequestId], references: [id], onDelete: Cascade)
  users           users?          @relation(fields: [userId], references: [id])

  @@index([returnRequestId])
  @@index([userId])
}

model return_contact_attempts {
  id              String          @id
  returnRequestId String
  userId          String
  method          String
  result          String
  notes           String?         @db.Text
  createdAt       DateTime        @default(now())
  return_requests return_requests @relation(fields: [returnRequestId], references: [id], onDelete: Cascade)
  users           users           @relation(fields: [userId], references: [id])

  @@index([returnRequestId])
  @@index([userId])
}

model return_reason_categories {
  id             String                               @id
  name           String
  defaultRole    return_reason_categories_defaultRole @default(OTHER)
  isActive       Boolean                              @default(true)
  createdAt      DateTime                             @default(now())
  updatedAt      DateTime
  companyId      String
  companies      companies                            @relation(fields: [companyId], references: [id], onDelete: Cascade)
  return_reasons return_reasons[]

  @@index([companyId])
}

model return_reasons {
  id                       String                    @id
  reason                   String
  description              String?
  companyId                String
  isActive                 Boolean                   @default(true)
  createdAt                DateTime                  @default(now())
  updatedAt                DateTime
  categoryId               String?
  return_reason_categories return_reason_categories? @relation(fields: [categoryId], references: [id])
  companies                companies                 @relation(fields: [companyId], references: [id], onDelete: Cascade)
  return_requests          return_requests[]

  @@index([categoryId])
  @@index([companyId])
}

model return_requests {
  id                      String                           @id
  orderId                 String
  customerId              String
  companyId               String
  reasonId                String
  status                  return_requests_status           @default(PENDING)
  adminNotes              String?                          @db.Text
  customerNotes           String?                          @db.Text
  refundAmount            Decimal?                         @db.Decimal(10, 2)
  assignedTo              String?
  createdAt               DateTime                         @default(now())
  updatedAt               DateTime
  isReviewed              Boolean                          @default(false)
  orderItemId             String?
  rejectionReason         String?                          @db.Text
  responsibleParty        return_requests_responsibleParty @default(OTHER)
  reviewedAt              DateTime?
  reviewedBy              String?
  return_activity_logs    return_activity_logs[]
  return_contact_attempts return_contact_attempts[]
  users                   users?                           @relation(fields: [assignedTo], references: [id])
  companies               companies                        @relation(fields: [companyId], references: [id], onDelete: Cascade)
  customers               customers                        @relation(fields: [customerId], references: [id], onDelete: Cascade)
  orders                  orders                           @relation(fields: [orderId], references: [id], onDelete: Cascade)
  return_reasons          return_reasons                   @relation(fields: [reasonId], references: [id])

  @@index([assignedTo])
  @@index([companyId])
  @@index([customerId])
  @@index([orderId])
  @@index([reasonId])
  @@index([status])
}

model return_settings {
  id                 String    @id
  companyId          String    @unique
  excellentThreshold Int       @default(90)
  goodThreshold      Int       @default(70)
  minOrdersForRating Int       @default(3)
  autoApproveScore   Int       @default(95)
  enableAutoApproval Boolean   @default(false)
  createdAt          DateTime  @default(now())
  updatedAt          DateTime
  companies          companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
}

model search_analytics {
  id            String   @id
  companyId     String
  customerId    String?
  query         String   @db.Text
  intent        String?
  resultsCount  Int      @default(0)
  wasSuccessful Boolean  @default(true)
  responseTime  Int?
  metadata      String?  @db.Text
  createdAt     DateTime @default(now())

  @@index([companyId, createdAt])
  @@index([companyId])
  @@index([intent])
  @@index([wasSuccessful])
}

model sent_message_stats {
  id                    String    @id
  companyId             String
  facebookPageId        String?
  recipientFacebookId   String
  recipientCustomerId   String?
  messageId             String    @unique
  messageContent        String?   @db.Text
  messageType           String?
  messageStatus         String
  ignoredReason         String?
  conversationId        String?
  conversationStatus    String?
  sentAt                DateTime  @default(now())
  savedAt               DateTime?
  conversationCreatedAt DateTime?
  createdAt             DateTime  @default(now())
  updatedAt             DateTime
  companies             companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([companyId, sentAt])
  @@index([conversationStatus])
  @@index([messageStatus])
  @@index([recipientFacebookId])
  @@index([sentAt])
}

model shipping_methods {
  id             String         @id
  zoneId         String
  type           String         @default("flat_rate")
  title          String
  isEnabled      Boolean        @default(true)
  settings       String?        @db.LongText
  sortOrder      Int            @default(0)
  createdAt      DateTime       @default(now())
  updatedAt      DateTime
  shipping_zones shipping_zones @relation(fields: [zoneId], references: [id], onDelete: Cascade)

  @@index([isEnabled])
  @@index([zoneId])
}

model shipping_zones {
  id                    String             @id
  governorates          String             @db.LongText
  price                 Decimal            @default(0.00) @db.Decimal(10, 2)
  deliveryTime          String
  isActive              Boolean            @default(true)
  companyId             String
  createdAt             DateTime           @default(now())
  updatedAt             DateTime
  deliveryTimeType      String             @default("custom")
  freeShippingThreshold Decimal?           @db.Decimal(10, 2)
  name                  String             @default("")
  pricingTiers          String?            @db.LongText
  pricingType           String             @default("flat")
  shipping_methods      shipping_methods[]
  companies             companies          @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([isActive])
  @@index([pricingType])
}

model skipped_facebook_pages {
  id                   String    @id
  pageId               String
  pageName             String
  reason               String
  attemptedCompanyId   String
  connectedToCompanyId String?
  isResolved           Boolean   @default(false)
  resolvedAt           DateTime?
  createdAt            DateTime  @default(now())
  updatedAt            DateTime

  @@index([attemptedCompanyId])
  @@index([createdAt])
  @@index([isResolved])
}

model stock_alerts {
  id              String                @id
  type            stock_alerts_type
  priority        stock_alerts_priority
  productId       String
  productName     String
  warehouseId     String
  warehouseName   String
  message         String
  currentStock    Int?
  reorderPoint    Int?
  reorderQuantity Int?
  isRead          Boolean               @default(false)
  createdAt       DateTime              @default(now())
  products        products              @relation(fields: [productId], references: [id], onDelete: Cascade)
  warehouses      warehouses            @relation(fields: [warehouseId], references: [id], onDelete: Cascade)

  @@index([isRead])
  @@index([priority])
  @@index([productId])
  @@index([warehouseId])
}

model stock_movements {
  id          String                 @id
  productId   String
  warehouseId String
  type        stock_movements_type
  reason      stock_movements_reason
  quantity    Int
  cost        Decimal?               @db.Decimal(10, 2)
  reference   String?
  notes       String?
  userId      String?
  userName    String?
  createdAt   DateTime               @default(now())
  approvedAt  DateTime?
  approvedBy  String?
  batchNumber String?
  expiryDate  DateTime?
  isApproved  Boolean                @default(true)
  products    products               @relation(fields: [productId], references: [id], onDelete: Cascade)
  warehouses  warehouses             @relation(fields: [warehouseId], references: [id], onDelete: Cascade)

  @@index([createdAt])
  @@index([productId])
  @@index([warehouseId])
}

model store_pages {
  id              String               @id
  companyId       String
  title           String
  slug            String
  content         String               @db.Text
  pageType        store_pages_pageType @default(CUSTOM)
  isActive        Boolean              @default(true)
  showInFooter    Boolean              @default(true)
  showInMenu      Boolean              @default(false)
  order           Int                  @default(0)
  metaTitle       String?
  metaDescription String?              @db.Text
  createdAt       DateTime             @default(now())
  updatedAt       DateTime
  companies       companies            @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, slug])
  @@index([companyId])
  @@index([isActive])
  @@index([slug])
}

model store_promotion_settings {
  id                    String    @id
  companyId             String    @unique
  freeShippingEnabled   Boolean   @default(false)
  freeShippingThreshold Decimal   @default(0.00) @db.Decimal(10, 2)
  freeShippingMessage   String?   @db.Text
  createdAt             DateTime  @default(now())
  updatedAt             DateTime
  companies             companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
}

model store_visits {
  id          String    @id
  companyId   String
  sessionId   String
  ipAddress   String?
  userAgent   String?   @db.Text
  referrer    String?   @db.Text
  landingPage String?   @db.Text
  visitedAt   DateTime  @default(now())
  duration    Int?
  pagesViewed Int       @default(1)
  companies   companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId, visitedAt])
  @@index([sessionId, companyId])
}

model storefront_settings {
  id                               String                   @id
  companyId                        String                   @unique
  quickViewEnabled                 Boolean                  @default(true)
  quickViewShowAddToCart           Boolean                  @default(true)
  quickViewShowWishlist            Boolean                  @default(true)
  comparisonEnabled                Boolean                  @default(true)
  maxComparisonProducts            Int                      @default(4)
  comparisonShowPrice              Boolean                  @default(true)
  comparisonShowSpecs              Boolean                  @default(true)
  wishlistEnabled                  Boolean                  @default(true)
  wishlistRequireLogin             Boolean                  @default(false)
  wishlistMaxItems                 Int                      @default(100)
  advancedFiltersEnabled           Boolean                  @default(true)
  filterByPrice                    Boolean                  @default(true)
  filterByRating                   Boolean                  @default(true)
  filterByBrand                    Boolean                  @default(false)
  filterByAttributes               Boolean                  @default(true)
  reviewsEnabled                   Boolean                  @default(true)
  reviewsRequirePurchase           Boolean                  @default(false)
  reviewsModerationEnabled         Boolean                  @default(true)
  reviewsShowRating                Boolean                  @default(true)
  minRatingToDisplay               Int                      @default(1)
  countdownEnabled                 Boolean                  @default(true)
  countdownShowOnProduct           Boolean                  @default(true)
  countdownShowOnListing           Boolean                  @default(false)
  backInStockEnabled               Boolean                  @default(true)
  backInStockNotifyEmail           Boolean                  @default(true)
  backInStockNotifySMS             Boolean                  @default(false)
  recentlyViewedEnabled            Boolean                  @default(true)
  recentlyViewedCount              Int                      @default(8)
  recentlyViewedDays               Int                      @default(30)
  imageZoomEnabled                 Boolean                  @default(true)
  imageZoomType                    String                   @default("hover")
  productVideosEnabled             Boolean                  @default(true)
  videoAutoplay                    Boolean                  @default(false)
  videoShowControls                Boolean                  @default(true)
  sizeGuideEnabled                 Boolean                  @default(true)
  sizeGuideShowOnProduct           Boolean                  @default(true)
  socialSharingEnabled             Boolean                  @default(true)
  shareFacebook                    Boolean                  @default(true)
  shareTwitter                     Boolean                  @default(true)
  shareWhatsApp                    Boolean                  @default(true)
  shareTelegram                    Boolean                  @default(true)
  badgesEnabled                    Boolean                  @default(true)
  badgeNew                         Boolean                  @default(true)
  badgeBestSeller                  Boolean                  @default(true)
  badgeOnSale                      Boolean                  @default(true)
  badgeOutOfStock                  Boolean                  @default(true)
  tabsEnabled                      Boolean                  @default(true)
  tabDescription                   Boolean                  @default(true)
  tabSpecifications                Boolean                  @default(true)
  tabReviews                       Boolean                  @default(true)
  tabShipping                      Boolean                  @default(true)
  stickyAddToCartEnabled           Boolean                  @default(true)
  stickyShowOnMobile               Boolean                  @default(true)
  stickyShowOnDesktop              Boolean                  @default(true)
  seoEnabled                       Boolean                  @default(true)
  seoMetaDescription               Boolean                  @default(true)
  seoStructuredData                Boolean                  @default(true)
  seoSitemap                       Boolean                  @default(true)
  seoOpenGraph                     Boolean                  @default(true)
  multiLanguageEnabled             Boolean                  @default(false)
  defaultLanguage                  String                   @default("ar")
  supportedLanguages               String                   @db.LongText
  createdAt                        DateTime                 @default(now())
  updatedAt                        DateTime
  capiStatus                       String?                  @default("not_configured")
  capiTrackAddToCart               Boolean                  @default(true)
  capiTrackInitiateCheckout        Boolean                  @default(true)
  capiTrackPageView                Boolean                  @default(true)
  capiTrackPurchase                Boolean                  @default(true)
  capiTrackSearch                  Boolean                  @default(true)
  capiTrackViewContent             Boolean                  @default(true)
  eventDeduplicationEnabled        Boolean                  @default(true)
  eventMatchQualityTarget          Int                      @default(8)
  facebookConvApiEnabled           Boolean                  @default(false)
  facebookConvApiTestCode          String?
  facebookConvApiToken             String?                  @db.Text
  facebookPixelEnabled             Boolean                  @default(false)
  facebookPixelId                  String?
  gdprCompliant                    Boolean                  @default(true)
  hashUserData                     Boolean                  @default(true)
  lastCapiTest                     DateTime?
  lastPixelTest                    DateTime?
  pixelStatus                      String?                  @default("not_configured")
  pixelTrackAddToCart              Boolean                  @default(true)
  pixelTrackAddToWishlist          Boolean                  @default(false)
  pixelTrackInitiateCheckout       Boolean                  @default(true)
  pixelTrackPageView               Boolean                  @default(true)
  pixelTrackPurchase               Boolean                  @default(true)
  pixelTrackSearch                 Boolean                  @default(true)
  pixelTrackViewContent            Boolean                  @default(true)
  stickyAutoScrollToCheckout       Boolean                  @default(false)
  stickyScrollThreshold            Int                      @default(300)
  stickyShowBuyNow                 Boolean                  @default(true)
  stickyTrackAnalytics             Boolean                  @default(true)
  stickyShowAddToCartButton        Boolean                  @default(true)
  stickyShowProductImage           Boolean                  @default(true)
  stickyShowProductName            Boolean                  @default(true)
  stickyShowQuantity               Boolean                  @default(true)
  badgeBuyerProtection             Boolean                  @default(true)
  badgeCashOnDelivery              Boolean                  @default(true)
  badgeCustom1                     Boolean                  @default(false)
  badgeCustom1Text                 String?
  badgeCustom2                     Boolean                  @default(false)
  badgeCustom2Text                 String?
  badgeFreeShipping                Boolean                  @default(true)
  badgeHighRating                  Boolean                  @default(true)
  badgeLayout                      String                   @default("horizontal")
  badgeQualityGuarantee            Boolean                  @default(true)
  badgeSecurePayment               Boolean                  @default(true)
  keyboardShortcuts                Boolean                  @default(true)
  navigationEnabled                Boolean                  @default(false)
  navigationType                   String                   @default("sameCategory")
  onlineVisitorsEnabled            Boolean                  @default(false)
  onlineVisitorsMax                Int                      @default(50)
  onlineVisitorsMin                Int                      @default(5)
  onlineVisitorsText               String                   @default("{count} شخص يشاهدون هذا المنتج الآن")
  onlineVisitorsType               String                   @default("fake")
  onlineVisitorsUpdateInterval     Int                      @default(30)
  reasonsToPurchaseEnabled         Boolean                  @default(false)
  reasonsToPurchaseList            String?                  @db.Text
  reasonsToPurchaseMaxItems        Int                      @default(4)
  reasonsToPurchaseStyle           String                   @default("list")
  reasonsToPurchaseType            String                   @default("global")
  securityBadgesEnabled            Boolean                  @default(false)
  showNavigationButtons            Boolean                  @default(true)
  soldNumberEnabled                Boolean                  @default(false)
  soldNumberMax                    Int                      @default(500)
  soldNumberMin                    Int                      @default(10)
  soldNumberText                   String                   @default("تم بيع {count} قطعة")
  soldNumberType                   String                   @default("real")
  stockProgressEnabled             Boolean                  @default(false)
  stockProgressHighColor           String                   @default("#10b981")
  stockProgressLowColor            String                   @default("#ef4444")
  stockProgressMediumColor         String                   @default("#f59e0b")
  stockProgressThreshold           Int                      @default(10)
  stockProgressType                String                   @default("percentage")
  variantColorShowName             Boolean                  @default(true)
  variantColorSize                 String                   @default("medium")
  variantColorStyle                String                   @default("buttons")
  variantSizeShowGuide             Boolean                  @default(false)
  variantSizeShowStock             Boolean                  @default(true)
  variantSizeStyle                 String                   @default("buttons")
  estimatedDeliveryDefaultText     String                   @default("التوصيل خلال {time}")
  estimatedDeliveryEnabled         Boolean                  @default(false)
  estimatedDeliveryShowOnProduct   Boolean                  @default(true)
  fomoDelay                        Int                      @default(30)
  fomoEnabled                      Boolean                  @default(false)
  fomoMessage                      String?                  @db.Text
  fomoShowOncePerSession           Boolean                  @default(true)
  fomoTrigger                      String                   @default("time")
  fomoType                         String                   @default("soldCount")
  productPageLayoutEnabled         Boolean                  @default(false)
  productPageOrder                 String?                  @db.Text
  productPageShowActions           Boolean                  @default(true)
  productPageShowBackInStock       Boolean                  @default(true)
  productPageShowBadges            Boolean                  @default(true)
  productPageShowCategory          Boolean                  @default(true)
  productPageShowCheckoutForm      Boolean                  @default(true)
  productPageShowCountdown         Boolean                  @default(true)
  productPageShowDescription       Boolean                  @default(true)
  productPageShowEstimatedDelivery Boolean                  @default(true)
  productPageShowFreeShipping      Boolean                  @default(true)
  productPageShowOnlineVisitors    Boolean                  @default(true)
  productPageShowPreOrder          Boolean                  @default(true)
  productPageShowPrice             Boolean                  @default(true)
  productPageShowQuantity          Boolean                  @default(true)
  productPageShowReasonsToPurchase Boolean                  @default(true)
  productPageShowSKU               Boolean                  @default(true)
  productPageShowSecurityBadges    Boolean                  @default(true)
  productPageShowSizeGuide         Boolean                  @default(true)
  productPageShowSocialSharing     Boolean                  @default(true)
  productPageShowSoldNumber        Boolean                  @default(true)
  productPageShowStockProgress     Boolean                  @default(true)
  productPageShowStockStatus       Boolean                  @default(true)
  productPageShowTabs              Boolean                  @default(true)
  productPageShowTitle             Boolean                  @default(true)
  productPageShowVariants          Boolean                  @default(true)
  productPageShowVolumeDiscounts   Boolean                  @default(true)
  galleryLayout                    String                   @default("bottom")
  galleryStyle                     String                   @default("slider")
  imageBorderRadius                Int                      @default(8)
  imageHoverEffect                 String                   @default("zoom")
  imageLoadingEffect               String                   @default("skeleton")
  imagePlaceholder                 String                   @default("?")
  imageShadow                      Boolean                  @default(true)
  lightboxBackgroundColor          String                   @default("rgba(0,0,0,0.9)")
  lightboxCloseOnOverlay           Boolean                  @default(true)
  lightboxEnabled                  Boolean                  @default(true)
  lightboxKeyboardNav              Boolean                  @default(true)
  lightboxShowArrows               Boolean                  @default(true)
  lightboxShowCounter              Boolean                  @default(true)
  lightboxShowThumbnails           Boolean                  @default(true)
  lightboxZoomEnabled              Boolean                  @default(true)
  mainImageAspectRatio             String                   @default("1:1")
  mobileFullscreenOnTap            Boolean                  @default(true)
  mobileGalleryLayout              String                   @default("slider")
  mobilePinchZoom                  Boolean                  @default(true)
  mobileShowThumbnails             Boolean                  @default(false)
  mobileSwipeEnabled               Boolean                  @default(true)
  mouseWheelZoom                   Boolean                  @default(false)
  sliderAutoplay                   Boolean                  @default(false)
  sliderAutoplaySpeed              Int                      @default(3000)
  sliderEnabled                    Boolean                  @default(true)
  sliderInfiniteLoop               Boolean                  @default(true)
  sliderShowArrows                 Boolean                  @default(true)
  sliderShowDots                   Boolean                  @default(false)
  sliderTransitionEffect           String                   @default("slide")
  sliderTransitionSpeed            Int                      @default(300)
  thumbnailBorderRadius            Int                      @default(8)
  thumbnailSize                    String                   @default("medium")
  thumbnailSpacing                 Int                      @default(8)
  thumbnailsPerRow                 Int                      @default(4)
  variationImagesAnimation         String                   @default("fade")
  variationImagesBehavior          String                   @default("replace")
  variationImagesEnabled           Boolean                  @default(true)
  videoMuted                       Boolean                  @default(true)
  videoPlayMode                    String                   @default("inline")
  videoPosition                    String                   @default("end")
  videoSources                     String                   @default("[\"youtube\", \"vimeo\", \"self-hosted\"]")
  videoThumbnailIcon               Boolean                  @default(true)
  view360AutoRotate                Boolean                  @default(true)
  view360Enabled                   Boolean                  @default(false)
  view360RotateSpeed               Int                      @default(5)
  view360ShowControls              Boolean                  @default(true)
  zoomLensShape                    String                   @default("square")
  zoomLensSize                     Int                      @default(150)
  zoomLevel                        Float                    @default(2.5)
  zoomStyle                        String                   @default("side")
  zoomWindowPosition               String                   @default("right")
  zoomWindowSize                   Int                      @default(400)
  mobileBottomNavbarEnabled        Boolean                  @default(true)
  mobileBottomNavbarShowAccount    Boolean                  @default(true)
  mobileBottomNavbarShowCart       Boolean                  @default(false)
  mobileBottomNavbarShowCompare    Boolean                  @default(true)
  mobileBottomNavbarShowHome       Boolean                  @default(true)
  mobileBottomNavbarShowSearch     Boolean                  @default(false)
  mobileBottomNavbarShowShop       Boolean                  @default(true)
  mobileBottomNavbarShowWishlist   Boolean                  @default(true)
  facebook_pixel_configs           facebook_pixel_configs[]
  companies                        companies                @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([facebookConvApiEnabled])
  @@index([facebookPixelEnabled])
}

model subscriptions {
  id              String                 @id
  companyId       String
  planType        subscriptions_planType
  status          subscriptions_status   @default(ACTIVE)
  startDate       DateTime               @default(now())
  endDate         DateTime?
  nextBillingDate DateTime?
  billingCycle    String                 @default("monthly")
  price           Float
  currency        String                 @default("EGP")
  autoRenew       Boolean                @default(true)
  trialEndDate    DateTime?
  cancelledAt     DateTime?
  cancelReason    String?
  metadata        String?                @db.LongText
  createdAt       DateTime               @default(now())
  updatedAt       DateTime
  invoices        invoices[]
  payments        payments[]
  companies       companies              @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
}

model supplier_payments {
  id                String                          @id
  companyId         String
  supplierId        String
  purchaseInvoiceId String?
  paymentNumber     String                          @unique
  paymentDate       DateTime                        @default(now())
  amount            Decimal                         @db.Decimal(12, 2)
  paymentMethod     supplier_payments_paymentMethod
  referenceNumber   String?
  bankName          String?
  checkNumber       String?
  checkDate         DateTime?
  notes             String?                         @db.Text
  attachments       String?                         @db.Text
  createdBy         String
  createdAt         DateTime                        @default(now())
  updatedAt         DateTime
  companies         companies                       @relation(fields: [companyId], references: [id], onDelete: Cascade)
  purchase_invoices purchase_invoices?              @relation(fields: [purchaseInvoiceId], references: [id])
  suppliers         suppliers                       @relation(fields: [supplierId], references: [id])

  @@index([companyId])
  @@index([paymentDate])
  @@index([purchaseInvoiceId])
  @@index([supplierId])
}

model suppliers {
  id                 String              @id
  companyId          String
  name               String
  contactPerson      String?
  email              String?
  phone              String?
  mobile             String?
  address            String?             @db.Text
  city               String?
  country            String?             @default("Egypt")
  taxNumber          String?
  commercialRegister String?
  paymentTerms       String?             @db.Text
  creditLimit        Decimal?            @db.Decimal(12, 2)
  currentBalance     Decimal             @default(0.00) @db.Decimal(12, 2)
  rating             Int?                @default(0)
  notes              String?             @db.Text
  isActive           Boolean             @default(true)
  createdAt          DateTime            @default(now())
  updatedAt          DateTime
  createdBy          String?
  purchase_invoices  purchase_invoices[]
  purchase_orders    purchase_orders[]
  supplier_payments  supplier_payments[]
  companies          companies           @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([isActive])
}

model system_prompts {
  id        String     @id
  name      String
  content   String     @db.Text
  category  String     @default("general")
  isActive  Boolean    @default(false)
  createdAt DateTime   @default(now())
  updatedAt DateTime
  companyId String?
  companies companies? @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
}

model system_settings {
  id               String    @id
  systemName       String    @unique
  displayName      String
  description      String?
  category         String    @default("general")
  isEnabled        Boolean   @default(true)
  config           String?   @db.LongText
  resourceUsage    String?   @db.LongText
  lastStatusChange DateTime?
  createdAt        DateTime  @default(now())
  updatedAt        DateTime  @default(now())
}

model task_activities {
  id          String    @id
  taskId      String
  userId      String
  action      String
  field       String?
  oldValue    String?   @db.Text
  newValue    String?   @db.Text
  description String?   @db.Text
  companyId   String
  createdAt   DateTime  @default(now())
  companies   companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  Task        Task      @relation(fields: [taskId], references: [id], onDelete: Cascade)
  users       users     @relation(fields: [userId], references: [id])

  @@index([companyId])
  @@index([createdAt])
  @@index([taskId])
  @@index([userId])
}

model task_attachments {
  id            String    @id
  taskId        String
  userId        String
  fileName      String
  originalName  String
  fileSize      Int
  fileType      String
  filePath      String
  downloadCount Int       @default(0)
  companyId     String
  createdAt     DateTime  @default(now())
  companies     companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  Task          Task      @relation(fields: [taskId], references: [id], onDelete: Cascade)
  users         users     @relation(fields: [userId], references: [id])

  @@index([companyId])
  @@index([taskId])
  @@index([userId])
}

model task_categories {
  id          String    @id
  name        String
  description String?
  color       String    @default("#6366f1")
  icon        String?
  order       Int       @default(0)
  isActive    Boolean   @default(true)
  companyId   String
  createdAt   DateTime  @default(now())
  updatedAt   DateTime
  Task        Task[]
  companies   companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, name])
  @@index([companyId])
  @@index([isActive])
}

model task_checklist_items {
  id              String          @id
  checklistId     String
  content         String
  isCompleted     Boolean         @default(false)
  completedAt     DateTime?
  completedBy     String?
  position        Int             @default(0)
  createdAt       DateTime        @default(now())
  updatedAt       DateTime
  task_checklists task_checklists @relation(fields: [checklistId], references: [id], onDelete: Cascade)
  users           users?          @relation(fields: [completedBy], references: [id])

  @@index([checklistId])
  @@index([completedBy])
}

model task_checklists {
  id                   String                 @id
  taskId               String
  title                String
  position             Int                    @default(0)
  companyId            String
  createdAt            DateTime               @default(now())
  updatedAt            DateTime
  task_checklist_items task_checklist_items[]
  companies            companies              @relation(fields: [companyId], references: [id], onDelete: Cascade)
  Task                 Task                   @relation(fields: [taskId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([taskId])
}

model task_comments {
  id                  String          @id
  taskId              String
  userId              String
  content             String          @db.Text
  parentCommentId     String?
  mentions            String?         @db.LongText
  isEdited            Boolean         @default(false)
  editedAt            DateTime?
  companyId           String
  createdAt           DateTime        @default(now())
  updatedAt           DateTime
  companies           companies       @relation(fields: [companyId], references: [id], onDelete: Cascade)
  task_comments       task_comments?  @relation("task_commentsTotask_comments", fields: [parentCommentId], references: [id])
  other_task_comments task_comments[] @relation("task_commentsTotask_comments")
  Task                Task            @relation(fields: [taskId], references: [id], onDelete: Cascade)
  users               users           @relation(fields: [userId], references: [id])

  @@index([companyId])
  @@index([parentCommentId])
  @@index([taskId])
  @@index([userId])
}

model task_dependencies {
  id                                       String    @id
  taskId                                   String
  dependsOnId                              String
  type                                     String    @default("blocked_by")
  companyId                                String
  createdAt                                DateTime  @default(now())
  companies                                companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  Task_task_dependencies_dependsOnIdToTask Task      @relation("task_dependencies_dependsOnIdToTask", fields: [dependsOnId], references: [id], onDelete: Cascade)
  Task_task_dependencies_taskIdToTask      Task      @relation("task_dependencies_taskIdToTask", fields: [taskId], references: [id], onDelete: Cascade)

  @@unique([taskId, dependsOnId])
  @@index([companyId])
  @@index([dependsOnId])
  @@index([taskId])
}

model task_notifications {
  id        String    @id
  userId    String
  taskId    String?
  projectId String?
  type      String
  title     String
  message   String    @db.Text
  isRead    Boolean   @default(false)
  readAt    DateTime?
  link      String?
  companyId String
  createdAt DateTime  @default(now())
  companies companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  users     users     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([createdAt])
  @@index([isRead])
  @@index([userId])
}

model task_templates {
  id              String                         @id
  name            String
  description     String?                        @db.Text
  defaultStatus   task_templates_defaultStatus   @default(PENDING)
  defaultPriority task_templates_defaultPriority @default(MEDIUM)
  type            String                         @default("general")
  estimatedHours  Int                            @default(0)
  tags            String?                        @db.LongText
  checklist       String?                        @db.LongText
  isPublic        Boolean                        @default(false)
  createdBy       String
  companyId       String
  createdAt       DateTime                       @default(now())
  updatedAt       DateTime
  companies       companies                      @relation(fields: [companyId], references: [id], onDelete: Cascade)
  users           users                          @relation(fields: [createdBy], references: [id])

  @@index([companyId])
  @@index([createdBy])
}

model task_watchers {
  id        String    @id
  taskId    String
  userId    String
  companyId String
  createdAt DateTime  @default(now())
  companies companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  Task      Task      @relation(fields: [taskId], references: [id], onDelete: Cascade)
  users     users     @relation(fields: [userId], references: [id])

  @@unique([taskId, userId])
  @@index([companyId])
  @@index([taskId])
  @@index([userId])
}

model telegram_auto_reply_rules {
  id               String   @id
  userbotConfigId  String
  isActive         Boolean  @default(true)
  priority         Int      @default(0)
  response         String   @db.Text
  triggerType      String
  triggerValue     String   @db.Text
  workingHoursOnly Boolean  @default(false)
  startTime        String?
  endTime          String?
  daysOfWeek       String?  @db.LongText
  maxUsesPerUser   Int?
  cooldownMinutes  Int      @default(0)
  createdAt        DateTime @default(now())
  updatedAt        DateTime

  @@index([userbotConfigId])
}

model telegram_auto_reply_usages {
  id     String   @id
  ruleId String
  userId String
  usedAt DateTime @default(now())

  @@index([ruleId])
  @@index([userId])
}

model telegram_bulk_message_logs {
  id            String   @id
  bulkMessageId String
  recipient     String
  status        String
  error         String?  @db.Text
  sentAt        DateTime @default(now())

  @@index([bulkMessageId])
}

model telegram_bulk_messages {
  id                   String    @id
  status               String    @default("PENDING")
  recipients           String    @db.LongText
  message              String    @db.Text
  delayBetweenMessages Int       @default(1000)
  sentCount            Int       @default(0)
  failedCount          Int       @default(0)
  startedAt            DateTime?
  completedAt          DateTime?
  createdAt            DateTime  @default(now())
  updatedAt            DateTime
}

model telegram_configs {
  id            String    @id
  companyId     String
  botToken      String?   @db.Text
  botName       String?
  botUsername   String?
  apiId         String?   @db.Text
  apiHash       String?   @db.Text
  isActive      Boolean   @default(false)
  clientSession String?   @db.Text
  clientPhone   String?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime
  label         String    @default("Official Bot")
  sessionString String?   @db.Text
  type          String    @default("BOT")
  companies     companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, type])
  @@index([companyId])
  @@index([type])
}

model telegram_contacts {
  id              String   @id
  userbotConfigId String
  companyId       String
  telegramId      String
  firstName       String?
  lastName        String?
  username        String?
  phone           String?
  isBot           Boolean  @default(false)
  isPremium       Boolean  @default(false)
  source          String?
  sourceGroupId   String?
  createdAt       DateTime @default(now())
  updatedAt       DateTime

  @@unique([telegramId, companyId])
  @@index([companyId])
}

model telegram_forward_rules {
  id               String   @id
  isActive         Boolean  @default(true)
  sourceChats      String   @db.LongText
  targetChat       String
  filterKeywords   String?  @db.LongText
  filterMediaTypes String?  @db.LongText
  forwardCount     Int      @default(0)
  createdAt        DateTime @default(now())
  updatedAt        DateTime
}

model telegram_groups {
  id              String   @id
  userbotConfigId String
  companyId       String
  telegramId      String
  title           String
  type            String
  description     String?  @db.Text
  isPublic        Boolean  @default(false)
  managedByUs     Boolean  @default(false)
  createdAt       DateTime @default(now())
  updatedAt       DateTime

  @@index([companyId])
}

model telegram_scheduled_messages {
  id               String    @id
  userbotConfigId  String
  companyId        String
  chatId           String
  message          String    @db.Text
  mediaUrl         String?
  mediaType        String?
  scheduledTime    DateTime
  status           String    @default("PENDING")
  sentAt           DateTime?
  error            String?   @db.Text
  recurring        Boolean   @default(false)
  recurringPattern String?
  createdBy        String?
  createdAt        DateTime  @default(now())
  updatedAt        DateTime

  @@index([companyId])
  @@index([userbotConfigId])
}

model text_gallery {
  id        String    @id
  userId    String
  companyId String
  title     String?
  content   String    @db.Text
  imageUrls String?   @db.LongText
  createdAt DateTime  @default(now())
  updatedAt DateTime
  isPinned  Boolean   @default(false)
  companies companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  users     users     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([createdAt])
  @@index([userId])
}

model transactions {
  id              String          @id
  walletId        String
  amount          Decimal         @db.Decimal(10, 2)
  type            String
  status          String          @default("COMPLETED")
  description     String?
  referenceId     String?
  createdAt       DateTime        @default(now())
  company_wallets company_wallets @relation(fields: [walletId], references: [id], onDelete: Cascade)

  @@index([walletId])
}

model user_companies {
  id        String              @id
  userId    String
  companyId String
  role      user_companies_role @default(AGENT)
  isActive  Boolean             @default(true)
  isDefault Boolean             @default(false)
  joinedAt  DateTime            @default(now())
  createdAt DateTime            @default(now())
  updatedAt DateTime
  companies companies           @relation(fields: [companyId], references: [id], onDelete: Cascade)
  users     users               @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, companyId])
  @@index([companyId])
  @@index([userId])
}

model user_invitations {
  id         String                  @id
  email      String
  firstName  String
  lastName   String
  role       String                  @default("AGENT")
  token      String                  @unique
  status     user_invitations_status @default(PENDING)
  invitedBy  String
  companyId  String
  expiresAt  DateTime
  acceptedAt DateTime?
  createdAt  DateTime                @default(now())
  updatedAt  DateTime
  companies  companies               @relation(fields: [companyId], references: [id], onDelete: Cascade)
  users      users                   @relation(fields: [invitedBy], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([invitedBy])
  @@index([token])
}

model users {
  id                                                String                       @id
  email                                             String                       @unique
  password                                          String
  firstName                                         String
  lastName                                          String
  avatar                                            String?
  phone                                             String?
  role                                              String?
  isActive                                          Boolean                      @default(true)
  isEmailVerified                                   Boolean                      @default(false)
  emailVerifiedAt                                   DateTime?
  lastLoginAt                                       DateTime?
  passwordChangedAt                                 DateTime?
  companyId                                         String?
  createdAt                                         DateTime                     @default(now())
  updatedAt                                         DateTime
  resetPasswordExpires                              DateTime?
  resetPasswordToken                                String?
  availability                                      String?                      @default("available")
  department                                        String?
  skills                                            String?                      @db.Text
  baseSalary                                        Decimal?                     @db.Decimal(12, 2)
  contractType                                      users_contractType?
  departmentId                                      String?
  employeeNumber                                    String?
  hireDate                                          DateTime?
  positionId                                        String?
  timezone                                          String                       @default("Asia/Riyadh")
  enableAutoDeduction                               Boolean                      @default(true)
  lateDeductionRate                                 Decimal?                     @db.Decimal(10, 2)
  maxDailyLateMinutes                               Int?                         @default(10)
  monthlyGraceMinutes                               Int?                         @default(60)
  Project                                           Project[]
  SupportMessage                                    SupportMessage[]
  SupportTicket_SupportTicket_assignedUserIdTousers SupportTicket[]              @relation("SupportTicket_assignedUserIdTousers")
  SupportTicket_SupportTicket_userIdTousers         SupportTicket[]              @relation("SupportTicket_userIdTousers")
  Task_Task_assignedToTousers                       Task[]                       @relation("Task_assignedToTousers")
  Task_Task_createdByTousers                        Task[]                       @relation("Task_createdByTousers")
  TimeEntry                                         TimeEntry[]
  activities                                        activities[]
  activity_logs                                     activity_logs[]
  affiliates                                        affiliates?
  app_reviews                                       app_reviews[]
  call_attempt_logs                                 call_attempt_logs[]
  conversations                                     conversations[]
  customer_notes                                    customer_notes[]
  dev_team_members                                  dev_team_members?
  guest_orders                                      guest_orders[]
  hr_attendances                                    hr_attendances[]
  hr_audit_logs                                     hr_audit_logs[]
  hr_clearance_checklists                           hr_clearance_checklists[]
  hr_employees                                      hr_employees?
  hr_kudos_hr_kudos_fromUserIdTousers               hr_kudos[]                   @relation("hr_kudos_fromUserIdTousers")
  hr_kudos_hr_kudos_toUserIdTousers                 hr_kudos[]                   @relation("hr_kudos_toUserIdTousers")
  hr_reward_eligibility_logs                        hr_reward_eligibility_logs[]
  hr_reward_records                                 hr_reward_records[]
  hr_shift_assignments                              hr_shift_assignments[]
  image_gallery                                     image_gallery[]
  image_studio_history                              image_studio_history[]
  lateness_allowances                               lateness_allowances[]
  lateness_deductions                               lateness_deductions[]
  lateness_monthly_summaries                        lateness_monthly_summaries[]
  lateness_records                                  lateness_records[]
  messages                                          messages[]
  notifications                                     notifications[]
  order_notes                                       order_notes[]
  orders_orders_createdByTousers                    orders[]                     @relation("orders_createdByTousers")
  orders_orders_userRelIdTousers                    orders[]                     @relation("orders_userRelIdTousers")
  return_activity_logs                              return_activity_logs[]
  return_contact_attempts                           return_contact_attempts[]
  return_requests                                   return_requests[]
  task_activities                                   task_activities[]
  task_attachments                                  task_attachments[]
  task_checklist_items                              task_checklist_items[]
  task_comments                                     task_comments[]
  task_notifications                                task_notifications[]
  task_templates                                    task_templates[]
  task_watchers                                     task_watchers[]
  text_gallery                                      text_gallery[]
  user_companies                                    user_companies[]
  user_invitations                                  user_invitations[]
  companies                                         companies?                   @relation(fields: [companyId], references: [id], onDelete: Cascade)
  hr_departments                                    hr_departments?              @relation(fields: [departmentId], references: [id])
  hr_positions                                      hr_positions?                @relation(fields: [positionId], references: [id])
  whatsapp_messages                                 whatsapp_messages[]

  @@index([companyId])
  @@index([departmentId])
  @@index([positionId])
}

model wallet_numbers {
  id               String             @id
  name             String
  number           String
  isActive         Boolean            @default(true)
  icon             String
  color            String
  createdAt        DateTime           @default(now())
  updatedAt        DateTime
  payment_receipts payment_receipts[]
}

model wallet_transactions {
  id               String                   @id
  walletId         String
  type             wallet_transactions_type
  amount           Float
  balanceBefore    Float
  balanceAfter     Float
  orderId          String?
  description      String
  metadata         String?                  @db.Text
  createdAt        DateTime                 @default(now())
  orders           orders?                  @relation(fields: [orderId], references: [id])
  customer_wallets customer_wallets         @relation(fields: [walletId], references: [id], onDelete: Cascade)

  @@index([createdAt])
  @@index([orderId], map: "wallet_transactions_orderId_fkey")
  @@index([type])
  @@index([walletId])
}

model warehouses {
  id              String            @id
  name            String
  location        String?
  type            String            @default("main")
  capacity        Int?
  isActive        Boolean           @default(true)
  companyId       String
  createdAt       DateTime          @default(now())
  updatedAt       DateTime
  inventory       inventory[]
  stock_alerts    stock_alerts[]
  stock_movements stock_movements[]
  companies       companies         @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
}

model whatsapp_contacts {
  id                String            @id
  sessionId         String
  jid               String
  phoneNumber       String
  name              String?
  pushName          String?
  profilePicUrl     String?           @db.Text
  isGroup           Boolean           @default(false)
  isBlocked         Boolean           @default(false)
  customerId        String?
  category          String?           @default("LEAD")
  tags              String?           @db.Text
  notes             String?           @db.Text
  lastMessageAt     DateTime?
  unreadCount       Int               @default(0)
  totalMessages     Int               @default(0)
  isArchived        Boolean           @default(false)
  isPinned          Boolean           @default(false)
  isMuted           Boolean           @default(false)
  createdAt         DateTime          @default(now())
  updatedAt         DateTime
  customers         customers?        @relation(fields: [customerId], references: [id])
  whatsapp_sessions whatsapp_sessions @relation(fields: [sessionId], references: [id], onDelete: Cascade)

  @@unique([sessionId, jid])
  @@index([category])
  @@index([customerId])
  @@index([lastMessageAt])
  @@index([phoneNumber])
  @@index([sessionId])
}

model whatsapp_event_logs {
  id        String   @id
  sessionId String
  companyId String
  eventType String
  eventData String?  @db.Text
  level     String   @default("info")
  createdAt DateTime @default(now())

  @@index([companyId])
  @@index([createdAt])
  @@index([eventType])
  @@index([sessionId])
}

model whatsapp_messages {
  id                String                        @id
  sessionId         String
  remoteJid         String
  messageId         String                        @unique
  fromMe            Boolean
  messageType       whatsapp_messages_messageType @default(TEXT)
  content           String?                       @db.Text
  mediaUrl          String?                       @db.Text
  mediaType         String?
  mediaMimeType     String?
  mediaSize         Int?
  mediaFileName     String?
  quotedMessageId   String?
  quotedContent     String?                       @db.Text
  status            whatsapp_messages_status      @default(SENT)
  timestamp         DateTime
  isAIResponse      Boolean                       @default(false)
  aiConfidence      Float?
  interactiveData   String?                       @db.Text
  metadata          String?                       @db.Text
  createdAt         DateTime                      @default(now())
  updatedAt         DateTime
  senderId          String?
  participant       String?
  users             users?                        @relation(fields: [senderId], references: [id])
  whatsapp_sessions whatsapp_sessions             @relation(fields: [sessionId], references: [id], onDelete: Cascade)

  @@index([createdAt])
  @@index([remoteJid])
  @@index([senderId])
  @@index([sessionId])
  @@index([sessionId, remoteJid])
  @@index([sessionId, timestamp])
  @@index([timestamp])
}

model whatsapp_notification_logs {
  id                              String                                   @id
  companyId                       String
  templateId                      String?
  sessionId                       String
  recipientPhone                  String
  recipientName                   String?
  recipientType                   whatsapp_notification_logs_recipientType @default(CUSTOMER)
  category                        whatsapp_notification_logs_category
  eventType                       whatsapp_notification_logs_eventType
  content                         String                                   @db.Text
  orderId                         String?
  customerId                      String?
  productId                       String?
  employeeId                      String?
  cartId                          String?
  status                          whatsapp_notification_logs_status        @default(PENDING)
  sentAt                          DateTime?
  deliveredAt                     DateTime?
  readAt                          DateTime?
  failedAt                        DateTime?
  failureReason                   String?
  clicked                         Boolean                                  @default(false)
  clickedAt                       DateTime?
  responded                       Boolean                                  @default(false)
  respondedAt                     DateTime?
  whatsappMessageId               String?
  cost                            Decimal                                  @default(0.0000) @db.Decimal(10, 4)
  createdAt                       DateTime                                 @default(now())
  updatedAt                       DateTime
  companies                       companies                                @relation(fields: [companyId], references: [id], onDelete: Cascade)
  customers                       customers?                               @relation(fields: [customerId], references: [id])
  orders                          orders?                                  @relation(fields: [orderId], references: [id])
  products                        products?                                @relation(fields: [productId], references: [id])
  whatsapp_notification_templates whatsapp_notification_templates?         @relation(fields: [templateId], references: [id])

  @@index([companyId, category, createdAt])
  @@index([companyId, eventType, createdAt])
  @@index([companyId, status, createdAt])
  @@index([customerId])
  @@index([orderId])
  @@index([productId])
  @@index([recipientPhone, companyId])
  @@index([templateId])
}

model whatsapp_notification_queue {
  id             String                                    @id
  companyId      String
  templateId     String?
  sessionId      String
  recipientPhone String
  recipientName  String?
  recipientType  whatsapp_notification_queue_recipientType @default(CUSTOMER)
  category       whatsapp_notification_queue_category
  eventType      whatsapp_notification_queue_eventType
  content        String                                    @db.Text
  mediaUrl       String?
  buttons        String?                                   @db.Text
  orderId        String?
  customerId     String?
  productId      String?
  employeeId     String?
  cartId         String?
  scheduledAt    DateTime
  priority       Int                                       @default(5)
  retryCount     Int                                       @default(0)
  maxRetries     Int                                       @default(3)
  status         whatsapp_notification_queue_status        @default(PENDING)
  processedAt    DateTime?
  createdAt      DateTime                                  @default(now())
  companies      companies                                 @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId, status])
  @@index([status, scheduledAt, priority])
}

model whatsapp_notification_settings {
  id                            String    @id
  companyId                     String    @unique
  isEnabled                     Boolean   @default(true)
  defaultSessionId              String?
  orderNotificationsEnabled     Boolean   @default(true)
  orderCreatedEnabled           Boolean   @default(true)
  orderConfirmedEnabled         Boolean   @default(true)
  orderProcessingEnabled        Boolean   @default(true)
  orderShippedEnabled           Boolean   @default(true)
  orderDeliveredEnabled         Boolean   @default(true)
  orderCancelledEnabled         Boolean   @default(true)
  paymentReminderEnabled        Boolean   @default(true)
  paymentReminderHours          Int       @default(24)
  productNotificationsEnabled   Boolean   @default(true)
  backInStockEnabled            Boolean   @default(true)
  priceDropEnabled              Boolean   @default(true)
  newProductEnabled             Boolean   @default(false)
  abandonedCartEnabled          Boolean   @default(true)
  abandonedCartFirstReminder    Int       @default(1)
  abandonedCartSecondReminder   Int       @default(24)
  abandonedCartThirdReminder    Int       @default(72)
  abandonedCartDiscountEnabled  Boolean   @default(false)
  abandonedCartDiscountPercent  Int       @default(10)
  marketingNotificationsEnabled Boolean   @default(false)
  promotionalEnabled            Boolean   @default(false)
  couponEnabled                 Boolean   @default(false)
  birthdayEnabled               Boolean   @default(false)
  loyaltyEnabled                Boolean   @default(false)
  hrNotificationsEnabled        Boolean   @default(false)
  attendanceReminderEnabled     Boolean   @default(false)
  leaveApprovalEnabled          Boolean   @default(false)
  payrollEnabled                Boolean   @default(false)
  birthdayWishEnabled           Boolean   @default(false)
  warningNotificationEnabled    Boolean   @default(false)
  rateLimitPerMinute            Int       @default(30)
  quietHoursEnabled             Boolean   @default(true)
  quietHoursStart               String    @default("22:00")
  quietHoursEnd                 String    @default("08:00")
  createdAt                     DateTime  @default(now())
  updatedAt                     DateTime
  companies                     companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
}

model whatsapp_notification_templates {
  id                         String                                    @id
  companyId                  String
  name                       String
  category                   whatsapp_notification_templates_category
  eventType                  whatsapp_notification_templates_eventType
  content                    String                                    @db.Text
  contentWithMedia           Boolean                                   @default(false)
  mediaUrl                   String?
  mediaType                  String?
  hasButtons                 Boolean                                   @default(false)
  buttons                    String?                                   @db.Text
  hasList                    Boolean                                   @default(false)
  listData                   String?                                   @db.Text
  variables                  String?                                   @db.Text
  isActive                   Boolean                                   @default(true)
  isDefault                  Boolean                                   @default(false)
  sentCount                  Int                                       @default(0)
  deliveredCount             Int                                       @default(0)
  readCount                  Int                                       @default(0)
  clickCount                 Int                                       @default(0)
  createdAt                  DateTime                                  @default(now())
  updatedAt                  DateTime
  whatsapp_notification_logs whatsapp_notification_logs[]
  companies                  companies                                 @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, eventType, isDefault])
  @@index([companyId, category])
  @@index([companyId, eventType])
}

model whatsapp_quick_replies {
  id         String    @id
  companyId  String
  title      String
  shortcut   String?
  content    String    @db.Text
  category   String    @default("general")
  variables  String?   @db.Text
  mediaUrl   String?   @db.Text
  mediaType  String?
  usageCount Int       @default(0)
  lastUsedAt DateTime?
  isActive   Boolean   @default(true)
  sortOrder  Int       @default(0)
  createdAt  DateTime  @default(now())
  updatedAt  DateTime
  companies  companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, shortcut])
  @@index([category])
  @@index([companyId])
  @@index([isActive])
}

model whatsapp_sessions {
  id                  String                   @id
  companyId           String
  name                String
  phoneNumber         String?
  status              whatsapp_sessions_status @default(DISCONNECTED)
  lastConnectedAt     DateTime?
  lastDisconnectedAt  DateTime?
  authState           String?                  @db.LongText
  isDefault           Boolean                  @default(false)
  aiEnabled           Boolean                  @default(true)
  autoReply           Boolean                  @default(false)
  aiMode              String                   @default("suggest")
  welcomeMessage      String?                  @db.Text
  awayMessage         String?                  @db.Text
  workingHoursEnabled Boolean                  @default(false)
  workingHours        String?                  @db.Text
  metadata            String?                  @db.Text
  createdAt           DateTime                 @default(now())
  updatedAt           DateTime
  profileName         String?
  profilePictureUrl   String?                  @db.Text
  profileStatus       String?
  whatsapp_contacts   whatsapp_contacts[]
  whatsapp_messages   whatsapp_messages[]
  companies           companies                @relation(fields: [companyId], references: [id], onDelete: Cascade)
  whatsapp_statuses   whatsapp_statuses[]

  @@index([companyId])
  @@index([phoneNumber])
  @@index([status])
}

model whatsapp_settings {
  id                   String    @id
  companyId            String    @unique
  isEnabled            Boolean   @default(true)
  maxSessions          Int       @default(3)
  notificationSound    Boolean   @default(true)
  browserNotifications Boolean   @default(true)
  defaultAIMode        String    @default("suggest")
  aiWelcomeEnabled     Boolean   @default(false)
  aiAwayEnabled        Boolean   @default(false)
  maxImageSize         Int       @default(16)
  maxVideoSize         Int       @default(64)
  maxDocumentSize      Int       @default(100)
  autoCompressImages   Boolean   @default(true)
  autoArchiveDays      Int?
  metadata             String?   @db.Text
  createdAt            DateTime  @default(now())
  updatedAt            DateTime
  companies            companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
}

model whatsapp_statuses {
  id                String                 @id
  sessionId         String
  remoteJid         String
  messageId         String                 @unique
  type              whatsapp_statuses_type @default(TEXT)
  content           String?                @db.Text
  mediaUrl          String?                @db.Text
  mediaType         String?
  mediaMimeType     String?
  timestamp         DateTime
  expiresAt         DateTime
  isViewed          Boolean                @default(false)
  viewedAt          DateTime?
  metadata          String?                @db.Text
  createdAt         DateTime               @default(now())
  updatedAt         DateTime
  whatsapp_sessions whatsapp_sessions      @relation(fields: [sessionId], references: [id], onDelete: Cascade)

  @@index([expiresAt])
  @@index([remoteJid])
  @@index([sessionId])
  @@index([timestamp])
}

model wishlists {
  id         String    @id
  sessionId  String
  customerId String?
  productId  String
  variantId  String?
  companyId  String
  createdAt  DateTime  @default(now())
  updatedAt  DateTime
  companies  companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
  products   products  @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@unique([sessionId, productId, variantId, companyId])
  @@index([companyId])
  @@index([customerId])
  @@index([productId])
  @@index([sessionId])
}

model woocommerce_settings {
  id                  String    @id
  companyId           String    @unique
  storeUrl            String
  consumerKey         String    @db.Text
  consumerSecret      String    @db.Text
  syncEnabled         Boolean   @default(false)
  syncDirection       String    @default("both")
  syncInterval        Int       @default(15)
  webhookSecret       String?   @db.Text
  webhookEnabled      Boolean   @default(false)
  webhookOrderCreated String?
  webhookOrderUpdated String?
  statusMapping       String?   @db.Text
  lastSyncAt          DateTime?
  lastSyncStatus      String?   @default("never")
  lastSyncMessage     String?   @db.Text
  isActive            Boolean   @default(true)
  createdAt           DateTime  @default(now())
  updatedAt           DateTime
  companies           companies @relation(fields: [companyId], references: [id], onDelete: Cascade)
}

model woocommerce_sync_logs {
  id            String    @id
  companyId     String
  syncType      String
  syncDirection String
  status        String
  totalItems    Int       @default(0)
  successCount  Int       @default(0)
  failedCount   Int       @default(0)
  skippedCount  Int       @default(0)
  errorMessage  String?   @db.Text
  errorDetails  String?   @db.Text
  startedAt     DateTime  @default(now())
  completedAt   DateTime?
  duration      Int?
  triggeredBy   String?
  metadata      String?   @db.Text
  companies     companies @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@index([startedAt])
  @@index([status])
  @@index([syncType])
}

enum global_ai_configs_defaultProvider {
  GOOGLE
  DEEPSEEK
  OPENAI
  ANTHROPIC
  HUGGINGFACE
  OLLAMA
}

enum stock_alerts_type {
  LOW_STOCK
  OUT_OF_STOCK
  OVERSTOCK
  EXPIRY_WARNING
}

enum hr_employee_warnings_type {
  VERBAL
  WRITTEN
  FINAL
  TERMINATION
}

enum ai_keys_provider {
  GOOGLE
  DEEPSEEK
  OPENAI
  ANTHROPIC
  HUGGINGFACE
  OLLAMA
}

enum subscriptions_planType {
  BASIC
  PRO
  ENTERPRISE
}

enum return_reason_categories_defaultRole {
  CUSTOMER
  STORE
  SHIPPING
  OTHER
}

enum stock_alerts_priority {
  LOW
  MEDIUM
  HIGH
  CRITICAL
}

enum wallet_transactions_type {
  CREDIT
  DEBIT
  CASHBACK
  REFUND
  REFERRAL_BONUS
  REWARD
  ADMIN_ADJUSTMENT
}

enum hr_leave_requests_type {
  ANNUAL
  SICK
  UNPAID
  MATERNITY
  PATERNITY
  BEREAVEMENT
  MARRIAGE
  HAJJ
  STUDY
  EMERGENCY
  OTHER
}

enum Project_status {
  PLANNING
  ACTIVE
  COMPLETED
  ON_HOLD
}

enum whatsapp_notification_templates_category {
  ORDERS
  PRODUCTS
  MARKETING
  ABANDONED_CART
  HR
  SYSTEM
}

enum dev_tasks_type {
  BUG
  FEATURE
  ENHANCEMENT
  DOCUMENTATION
  SECURITY
  PERFORMANCE
  TESTING
  REFACTOR
  MAINTENANCE
  HOTFIX
}

enum stock_movements_type {
  IN
  OUT
  ADJUSTMENT
  TRANSFER
  RETURN
}

enum task_templates_defaultStatus {
  PENDING
  IN_PROGRESS
  COMPLETED
  CANCELLED
}

enum messages_type {
  TEXT
  IMAGE
  VIDEO
  AUDIO
  FILE
  LOCATION
  STICKER
  EMOJI
  TEMPLATE
}

enum subscriptions_status {
  ACTIVE
  INACTIVE
  CANCELLED
  EXPIRED
  TRIAL
  SUSPENDED
}

enum hr_manual_deductions_type {
  PENALTY
  VIOLATION
  DAMAGE
  INSURANCE
  LOAN_REPAYMENT
  ADVANCE_REPAYMENT
  TAX
  SOCIAL_INSURANCE
  ABSENCE
  LATE
  EARLY_LEAVE
  OTHER
}

enum conversations_channel {
  FACEBOOK
  WHATSAPP
  TELEGRAM
  EMAIL
  SMS
  PHONE
  WEBSITE
  TEST
}

enum dev_projects_status {
  PLANNING
  ACTIVE
  ON_HOLD
  COMPLETED
  CANCELLED
}

enum user_companies_role {
  OWNER
  SUPER_ADMIN
  COMPANY_ADMIN
  MANAGER
  AGENT
  AFFILIATE
}

enum Project_priority {
  LOW
  MEDIUM
  HIGH
  URGENT
}

enum whatsapp_notification_templates_eventType {
  ORDER_CREATED
  ORDER_CONFIRMED
  ORDER_PROCESSING
  ORDER_SHIPPED
  ORDER_OUT_FOR_DELIVERY
  ORDER_DELIVERED
  ORDER_CANCELLED
  ORDER_REFUNDED
  PAYMENT_REMINDER
  PAYMENT_RECEIVED
  BACK_IN_STOCK
  PRICE_DROP
  NEW_PRODUCT
  LOW_STOCK_ALERT
  CART_ABANDONED_1H
  CART_ABANDONED_24H
  CART_ABANDONED_72H
  CART_ABANDONED_WITH_DISCOUNT
  PROMOTIONAL
  COUPON_SENT
  BIRTHDAY_WISH
  LOYALTY_POINTS
  LOYALTY_REWARD
  REVIEW_REQUEST
  ATTENDANCE_REMINDER
  ATTENDANCE_CONFIRMED
  ATTENDANCE_LATE
  ATTENDANCE_LATE_WITH_DEDUCTION
  CHECKOUT_CONFIRMED
  LEAVE_APPROVED
  LEAVE_REJECTED
  PAYROLL_READY
  BIRTHDAY_EMPLOYEE
  WARNING_ISSUED
  CONTRACT_EXPIRY
  TRAINING_REMINDER
  ANNOUNCEMENT
}

enum dev_tasks_status {
  BACKLOG
  TODO
  IN_PROGRESS
  IN_REVIEW
  TESTING
  DONE
  CANCELLED
}

enum stock_movements_reason {
  PURCHASE
  SALE
  DAMAGE
  EXPIRED
  LOST
  FOUND
  TRANSFER
  RETURN
  ADJUSTMENT
}

enum invoices_status {
  DRAFT
  SENT
  PAID
  OVERDUE
  CANCELLED
  REFUNDED
}

enum merchant_orders_status {
  PENDING
  SENT
  CONFIRMED
  FULFILLED
  CANCELLED
  FAILED
}

enum affiliates_commissionType {
  PERCENTAGE
  MARKUP
}

enum task_templates_defaultPriority {
  LOW
  MEDIUM
  HIGH
  URGENT
}

enum SupportTicket_category {
  INQUIRY
  TECHNICAL
  BILLING
  OTHER
}

enum dev_releases_status {
  PLANNING
  IN_PROGRESS
  READY
  RELEASED
  CANCELLED
}

enum orders_status {
  PENDING
  CONFIRMED
  PROCESSING
  SHIPPED
  DELIVERED
  CANCELLED
  REFUNDED
}

enum whatsapp_sessions_status {
  CONNECTED
  DISCONNECTED
  QR_PENDING
  CONNECTING
  LOGGED_OUT
}

enum conversations_status {
  ACTIVE
  PENDING
  RESOLVED
  CLOSED
}

enum dev_projects_priority {
  CRITICAL
  HIGH
  MEDIUM
  LOW
}

enum whatsapp_statuses_type {
  TEXT
  IMAGE
  VIDEO
  AUDIO
  DOCUMENT
  STICKER
  LOCATION
  CONTACT
  POLL
  PRODUCT
  ORDER
  CATALOG
  INTERACTIVE
  BUTTON_REPLY
  LIST_REPLY
  TEMPLATE
}

enum affiliate_payouts_status {
  PENDING
  PROCESSED
  FAILED
  CANCELLED
}

enum Task_status {
  PENDING
  IN_PROGRESS
  COMPLETED
  CANCELLED
}

enum commissions_type {
  SALE
  RECURRING
  BONUS
}

enum hr_reward_types_category {
  FINANCIAL
  NON_FINANCIAL
}

enum return_requests_status {
  PENDING
  APPROVED
  REJECTED
  COMPLETED
}

enum dev_tasks_priority {
  LOW
  MEDIUM
  HIGH
  URGENT
}

enum customer_loyalty_programs_type {
  POINTS
  TIERS
  CASHBACK
}

enum hr_reward_records_rewardCategory {
  PERFORMANCE
  ATTENDANCE
  SERVICE_ANNIVERSARY
  OTHER
}

enum invoices_type {
  SUBSCRIPTION
  ONE_TIME
}

enum store_pages_pageType {
  HOME
  ABOUT
  CONTACT
  CUSTOM
}

enum SupportTicket_status {
  OPEN
  IN_PROGRESS
  RESOLVED
  CLOSED
}

enum whatsapp_messages_messageType {
  TEXT
  IMAGE
  VIDEO
  DOCUMENT
  AUDIO
  LOCATION
}

enum coupons_type {
  PERCENTAGE
  FIXED_AMOUNT
  FREE_SHIPPING
}

enum affiliate_payouts_paymentMethod {
  TRANSFERS
  WALLET
  CASH
}

enum Task_priority {
  LOW
  MEDIUM
  HIGH
  URGENT
}

enum commissions_calculationType {
  PERCENTAGE
  FIXED
}

enum hr_reward_types_calculationMethod {
  FIXED
  PERCENTAGE
}

enum customer_loyalty_programs_status {
  DRAFT
  ACTIVE
  INACTIVE
}

enum user_invitations_status {
  PENDING
  ACCEPTED
  EXPIRED
}

enum affiliates_status {
  PENDING
  ACTIVE
  INACTIVE
  SUSPENDED
}

enum purchase_orders_status {
  DRAFT
  PENDING
  ORDERED
  RECEIVED
  CANCELLED
}

enum whatsapp_notification_queue_recipientType {
  CUSTOMER
  EMPLOYEE
  ADMIN
}

enum asset_assignments_returnCondition {
  NEW
  GOOD
  FAIR
  POOR
  DAMAGED
}

enum orders_paymentStatus {
  PENDING
  COMPLETED
  FAILED
  REFUNDED
}

enum whatsapp_notification_logs_recipientType {
  CUSTOMER
  EMPLOYEE
  ADMIN
}

enum payments_status {
  PENDING
  COMPLETED
  FAILED
  REFUNDED
}

enum ai_keys_keyType {
  COMPANY
  CENTRAL
}

enum whatsapp_notification_queue_category {
  ORDER
  MARKETING
  HR
  SYSTEM
}

enum purchase_invoices_status {
  PENDING
  PAID
  CANCELLED
}

enum orders_paymentMethod {
  CASH
  CREDIT_CARD
  BANK_TRANSFER
  PAYPAL
  STRIPE
}

enum whatsapp_notification_logs_category {
  ORDER
  MARKETING
  HR
  SYSTEM
}

enum supplier_payments_paymentMethod {
  CASH
  BANK_TRANSFER
  CHEQUE
}

enum asset_custody_history_returnCondition {
  NEW
  GOOD
  FAIR
  POOR
  DAMAGED
}

enum companies_plan {
  BASIC
  PRO
  ENTERPRISE
}

enum payments_method {
  BANK_TRANSFER
  CASH
  ONLINE
  WALLET
}

enum asset_requests_status {
  PENDING
  APPROVED
  REJECTED
  FULFILLED
  CANCELLED
}

enum whatsapp_notification_queue_eventType {
  ORDER_CREATED
  ORDER_CONFIRMED
  ORDER_SHIPPED
  ORDER_DELIVERED
  ORDER_CANCELLED
  PAYMENT_REMINDER
  BACK_IN_STOCK
  PROMOTIONAL
  OTP
}

enum whatsapp_notification_logs_eventType {
  ORDER_CREATED
  ORDER_CONFIRMED
  ORDER_SHIPPED
  ORDER_DELIVERED
  ORDER_CANCELLED
  PAYMENT_REMINDER
  BACK_IN_STOCK
  PROMOTIONAL
  OTP
}

enum customer_loyalty_records_status {
  ACTIVE
  EXPIRED
  CANCELLED
}

enum asset_audits_assetCondition {
  NEW
  GOOD
  FAIR
  POOR
  DAMAGED
}

enum customers_status {
  LEAD
  ACTIVE
  INACTIVE
  BLOCKED
}

enum assets_status {
  AVAILABLE
  IN_USE
  MAINTENANCE
  RETIRED
  LOST
  RESERVED
}

enum hr_reward_types_triggerType {
  MANUAL
  AUTOMATIC
}

enum assets_condition {
  NEW
  GOOD
  FAIR
  POOR
  DAMAGED
}

enum commissions_status {
  PENDING
  CONFIRMED
  PAID
  CANCELLED
}

enum hr_leave_requests_status {
  PENDING
  APPROVED
  REJECTED
  CANCELLED
}

enum hr_reward_types_frequency {
  ONCE
  MONTHLY
  QUARTERLY
  YEARLY
}

enum hr_manual_deductions_status {
  PENDING
  APPROVED
  REJECTED
}

enum hr_employee_training_status {
  PLANNED
  ONGOING
  COMPLETED
  CANCELLED
}

enum hr_promotions_status {
  PENDING
  APPROVED
  REJECTED
}

enum affiliates_paymentMethod {
  TRANSFERS
  WALLET
  CASH
}

enum hr_employees_gender {
  MALE
  FEMALE
}

enum hr_reward_records_status {
  PENDING
  APPROVED
  GIVEN
  CANCELLED
}

enum SupportTicket_priority {
  LOW
  MEDIUM
  HIGH
  URGENT
}

enum whatsapp_messages_status {
  PENDING
  SENT
  DELIVERED
  READ
  FAILED
}

enum hr_attendances_status {
  PRESENT
  ABSENT
  LATE
  EARLY_LEAVE
}

enum return_requests_responsibleParty {
  CUSTOMER
  STORE
  SHIPPING
  OTHER
}

enum hr_performance_reviews_status {
  DRAFT
  SUBMITTED
  REVIEWED
  COMPLETED
}

enum whatsapp_notification_logs_status {
  PENDING
  SENT
  DELIVERED
  READ
  FAILED
}

enum customers_customerRating {
  EXCELLENT
  GOOD
  AVERAGE
  POOR
  UNKNOWN
}

enum hr_employees_maritalStatus {
  SINGLE
  MARRIED
  DIVORCED
  WIDOWED
}

enum whatsapp_notification_queue_status {
  PENDING
  PROCESSING
  SENT
  FAILED
  CANCELLED
}

enum users_contractType {
  FULL_TIME
  PART_TIME
  CONTRACTOR
  INTERN
}

enum hr_payrolls_status {
  DRAFT
  PENDING
  PROCESSED
  PAID
}

enum hr_employees_contractType {
  FULL_TIME
  PART_TIME
  CONTRACT
  TEMPORARY
  INTERNSHIP
  FREELANCE
}

enum hr_employees_status {
  ACTIVE
  ON_HOLD
  COMPLETED
  CANCELLED
  ON_LEAVE
  SUSPENDED
  TERMINATED
  RESIGNED
}

enum orders_orderSource {
  REGULAR
  AFFILIATE_REFERRAL
  AFFILIATE_DIRECT
}


